"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/feedback/route";
exports.ids = ["app/api/feedback/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ffeedback%2Froute&page=%2Fapi%2Ffeedback%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ffeedback%2Froute.ts&appDir=C%3A%5CUsers%5Cpriya%5COneDrive%5CDesktop%5CTourism-Jharkhand%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cpriya%5COneDrive%5CDesktop%5CTourism-Jharkhand&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ffeedback%2Froute&page=%2Fapi%2Ffeedback%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ffeedback%2Froute.ts&appDir=C%3A%5CUsers%5Cpriya%5COneDrive%5CDesktop%5CTourism-Jharkhand%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cpriya%5COneDrive%5CDesktop%5CTourism-Jharkhand&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_priya_OneDrive_Desktop_Tourism_Jharkhand_app_api_feedback_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/feedback/route.ts */ \"(rsc)/./app/api/feedback/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/feedback/route\",\n        pathname: \"/api/feedback\",\n        filename: \"route\",\n        bundlePath: \"app/api/feedback/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\priya\\\\OneDrive\\\\Desktop\\\\Tourism-Jharkhand\\\\app\\\\api\\\\feedback\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_priya_OneDrive_Desktop_Tourism_Jharkhand_app_api_feedback_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/feedback/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZmZWVkYmFjayUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGZmVlZGJhY2slMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZmZWVkYmFjayUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNwcml5YSU1Q09uZURyaXZlJTVDRGVza3RvcCU1Q1RvdXJpc20tSmhhcmtoYW5kJTVDYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj1DJTNBJTVDVXNlcnMlNUNwcml5YSU1Q09uZURyaXZlJTVDRGVza3RvcCU1Q1RvdXJpc20tSmhhcmtoYW5kJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNvQztBQUNqSDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL215LXYwLXByb2plY3QvPzc0NmYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiQzpcXFxcVXNlcnNcXFxccHJpeWFcXFxcT25lRHJpdmVcXFxcRGVza3RvcFxcXFxUb3VyaXNtLUpoYXJraGFuZFxcXFxhcHBcXFxcYXBpXFxcXGZlZWRiYWNrXFxcXHJvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9mZWVkYmFjay9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2ZlZWRiYWNrXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9mZWVkYmFjay9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkM6XFxcXFVzZXJzXFxcXHByaXlhXFxcXE9uZURyaXZlXFxcXERlc2t0b3BcXFxcVG91cmlzbS1KaGFya2hhbmRcXFxcYXBwXFxcXGFwaVxcXFxmZWVkYmFja1xcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvZmVlZGJhY2svcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ffeedback%2Froute&page=%2Fapi%2Ffeedback%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ffeedback%2Froute.ts&appDir=C%3A%5CUsers%5Cpriya%5COneDrive%5CDesktop%5CTourism-Jharkhand%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cpriya%5COneDrive%5CDesktop%5CTourism-Jharkhand&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/feedback/route.ts":
/*!***********************************!*\
  !*** ./app/api/feedback/route.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   PUT: () => (/* binding */ PUT)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_ai_services__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/ai-services */ \"(rsc)/./lib/ai-services.ts\");\n\n\n// Real-time alert system\nclass AlertSystem {\n    static async triggerAlert(feedback) {\n        if (feedback.urgencyLevel === \"critical\" || feedback.urgencyLevel === \"high\") {\n            // In production, this would send real notifications\n            console.log(`ðŸš¨ CRITICAL ALERT: ${feedback.location} - ${feedback.category}`);\n            console.log(`Issue: ${feedback.aiAnalysis.actionableInsights?.join(\", \")}`);\n            // Auto-generate response for critical issues\n            feedback.autoResponseGenerated = await this.generateAutoResponse(feedback);\n            feedback.escalated = true;\n        }\n    }\n    static async generateAutoResponse(feedback) {\n        const insights = feedback.aiAnalysis.actionableInsights || [];\n        if (insights.some((i)=>i.includes(\"URGENT\") || i.includes(\"Safety\"))) {\n            return `Thank you for bringing this safety concern to our attention. We have immediately escalated this issue to our safety team and will address it within 24 hours. Your safety is our top priority.`;\n        }\n        if (feedback.aiAnalysis.sentiment === \"negative\" && feedback.aiAnalysis.confidence > 0.8) {\n            return `We sincerely apologize for your disappointing experience. We have forwarded your feedback to the relevant team for immediate action. We will contact you within 48 hours with an update on the improvements being made.`;\n        }\n        return `Thank you for your valuable feedback. We appreciate you taking the time to share your experience with us.`;\n    }\n}\n// Advanced AI-powered feedback analysis\nasync function analyzeAdvancedFeedback(textFeedback, voiceBlob, imageBlob, language = \"auto\") {\n    try {\n        const results = {};\n        // Analyze text if provided\n        if (textFeedback) {\n            results.aiAnalysis = await _lib_ai_services__WEBPACK_IMPORTED_MODULE_1__.aiService.analyzeText(textFeedback, language);\n        }\n        // Analyze voice if provided\n        if (voiceBlob) {\n            results.voiceAnalysis = await _lib_ai_services__WEBPACK_IMPORTED_MODULE_1__.aiService.analyzeVoice(voiceBlob);\n            // If no text feedback, use voice transcription for text analysis\n            if (!textFeedback && results.voiceAnalysis.transcription) {\n                results.aiAnalysis = await _lib_ai_services__WEBPACK_IMPORTED_MODULE_1__.aiService.analyzeText(results.voiceAnalysis.transcription, language);\n            }\n        }\n        // Analyze image if provided\n        if (imageBlob) {\n            results.imageAnalysis = await _lib_ai_services__WEBPACK_IMPORTED_MODULE_1__.aiService.analyzeImage(imageBlob);\n        }\n        return results;\n    } catch (error) {\n        console.error(\"Advanced feedback analysis failed:\", error);\n        // Fallback analysis\n        if (textFeedback) {\n            return {\n                aiAnalysis: await _lib_ai_services__WEBPACK_IMPORTED_MODULE_1__.aiService.analyzeText(textFeedback, language)\n            };\n        }\n        throw error;\n    }\n}\n// Real-time sentiment monitoring\nclass SentimentMonitor {\n    static{\n        this.sentimentHistory = [];\n    }\n    static addSentiment(feedback) {\n        this.sentimentHistory.push({\n            timestamp: feedback.timestamp,\n            sentiment: feedback.aiAnalysis.sentiment,\n            confidence: feedback.aiAnalysis.confidence,\n            location: feedback.location,\n            category: feedback.category\n        });\n        // Keep only last 1000 entries\n        if (this.sentimentHistory.length > 1000) {\n            this.sentimentHistory = this.sentimentHistory.slice(-1000);\n        }\n        // Check for sentiment trends\n        this.checkSentimentTrends(feedback.location, feedback.category);\n    }\n    static checkSentimentTrends(location, category) {\n        const recentFeedbacks = this.sentimentHistory.filter((s)=>s.location === location && s.category === category).slice(-10) // Last 10 feedbacks for this location/category\n        ;\n        if (recentFeedbacks.length >= 5) {\n            const negativeFeedbacks = recentFeedbacks.filter((s)=>s.sentiment === \"negative\");\n            if (negativeFeedbacks.length >= 3) {\n                console.log(`âš ï¸ TREND ALERT: Increasing negative sentiment detected for ${location} - ${category}`);\n            // In production, this would trigger notifications to tourism officials\n            }\n        }\n    }\n    static getSentimentTrends(location, category) {\n        let filtered = this.sentimentHistory;\n        if (location) {\n            filtered = filtered.filter((s)=>s.location === location);\n        }\n        if (category) {\n            filtered = filtered.filter((s)=>s.category === category);\n        }\n        return filtered.slice(-30) // Last 30 entries\n        ;\n    }\n}\n// AI-powered chatbot for instant responses\nclass FeedbackChatbot {\n    static async generateResponse(feedback) {\n        const { aiAnalysis, location, category } = feedback;\n        // Generate contextual response based on AI analysis\n        if (aiAnalysis.urgency === \"critical\") {\n            return `Thank you for this critical feedback about ${location}. We are immediately addressing the ${aiAnalysis.categories?.join(\", \")} issues you've mentioned. A senior official will contact you within 2 hours.`;\n        }\n        if (aiAnalysis.sentiment === \"positive\") {\n            return `We're delighted to hear about your positive experience at ${location}! Thank you for highlighting ${aiAnalysis.keywords.slice(0, 3).join(\", \")}. We'll share your feedback with our team.`;\n        }\n        if (aiAnalysis.sentiment === \"negative\") {\n            const issues = aiAnalysis.actionableInsights?.slice(0, 2).join(\" and \") || \"the issues you mentioned\";\n            return `We sincerely apologize for your experience at ${location}. We're taking immediate action on ${issues}. You can expect an update within 24-48 hours.`;\n        }\n        return `Thank you for your feedback about ${location}. Your insights about ${category.toLowerCase()} are valuable for improving our tourism services.`;\n    }\n    static async generateFollowUpQuestions(feedback) {\n        const questions = [];\n        if (feedback.aiAnalysis.sentiment === \"negative\") {\n            questions.push(\"What specific steps would you like to see implemented to improve this experience?\");\n            questions.push(\"Would you be willing to revisit this location if improvements were made?\");\n        }\n        if (feedback.aiAnalysis.categories?.includes(\"service quality\")) {\n            questions.push(\"Can you provide more details about the staff interaction?\");\n        }\n        if (feedback.aiAnalysis.categories?.includes(\"cleanliness\")) {\n            questions.push(\"Which specific areas need attention regarding cleanliness?\");\n        }\n        return questions.slice(0, 3);\n    }\n}\n// Fallback rule-based sentiment analysis\nfunction fallbackSentimentAnalysis(text, language) {\n    const positiveWords = [\n        \"good\",\n        \"great\",\n        \"excellent\",\n        \"amazing\",\n        \"wonderful\",\n        \"beautiful\",\n        \"love\",\n        \"perfect\",\n        \"awesome\",\n        \"fantastic\"\n    ];\n    const negativeWords = [\n        \"bad\",\n        \"terrible\",\n        \"awful\",\n        \"horrible\",\n        \"hate\",\n        \"worst\",\n        \"disappointing\",\n        \"poor\",\n        \"dirty\",\n        \"unsafe\"\n    ];\n    // Hindi positive/negative words\n    const hindiPositive = [\n        \"à¤…à¤šà¥à¤›à¤¾\",\n        \"à¤¬à¤¹à¥à¤¤\",\n        \"à¤¸à¥à¤‚à¤¦à¤°\",\n        \"à¤–à¥à¤¶\",\n        \"à¤ªà¥à¤°à¤¸à¤¨à¥à¤¨\",\n        \"à¤‰à¤¤à¥à¤•à¥ƒà¤·à¥à¤Ÿ\"\n    ];\n    const hindiNegative = [\n        \"à¤¬à¥à¤°à¤¾\",\n        \"à¤—à¤‚à¤¦à¤¾\",\n        \"à¤–à¤°à¤¾à¤¬\",\n        \"à¤¦à¥à¤–à¥€\",\n        \"à¤¨à¤¿à¤°à¤¾à¤¶\"\n    ];\n    const words = text.toLowerCase().split(/\\s+/);\n    let positiveCount = 0;\n    let negativeCount = 0;\n    let keywords = [];\n    words.forEach((word)=>{\n        if (positiveWords.includes(word) || hindiPositive.includes(word)) {\n            positiveCount++;\n            keywords.push(word);\n        }\n        if (negativeWords.includes(word) || hindiNegative.includes(word)) {\n            negativeCount++;\n            keywords.push(word);\n        }\n    });\n    let sentiment = \"neutral\";\n    let confidence = 0.5;\n    if (positiveCount > negativeCount) {\n        sentiment = \"positive\";\n        confidence = Math.min(0.9, 0.5 + (positiveCount - negativeCount) * 0.1);\n    } else if (negativeCount > positiveCount) {\n        sentiment = \"negative\";\n        confidence = Math.min(0.9, 0.5 + (negativeCount - positiveCount) * 0.1);\n    }\n    const emotions = {\n        joy: sentiment === \"positive\" ? confidence * 0.8 : 0.1,\n        anger: sentiment === \"negative\" ? confidence * 0.6 : 0.1,\n        sadness: sentiment === \"negative\" ? confidence * 0.4 : 0.1,\n        surprise: 0.2,\n        fear: sentiment === \"negative\" ? confidence * 0.3 : 0.05,\n        disgust: sentiment === \"negative\" ? confidence * 0.2 : 0.05\n    };\n    return {\n        sentiment,\n        confidence,\n        emotions,\n        keywords: keywords.slice(0, 5)\n    };\n}\n// Enhanced analysis functions\nfunction enhanceAnalysisWithRatings(aiAnalysis, starRating, emojiRating) {\n    // Prioritize AI text analysis, use ratings as enhancement/validation\n    let enhancedSentiment = aiAnalysis.sentiment;\n    let enhancedConfidence = aiAnalysis.confidence;\n    let enhancedUrgency = aiAnalysis.urgency || \"low\";\n    console.log(\"\\uD83D\\uDD0D Original AI Analysis:\", {\n        sentiment: aiAnalysis.sentiment,\n        confidence: aiAnalysis.confidence,\n        starRating,\n        emojiRating\n    });\n    // If AI analysis has high confidence, trust it more than ratings\n    if (aiAnalysis.confidence > 0.7) {\n        console.log(\"âœ… High confidence AI analysis - using text sentiment as primary\");\n        // Only adjust urgency based on star rating if text analysis suggests negative sentiment\n        if (aiAnalysis.sentiment === \"negative\") {\n            if (starRating <= 2) {\n                enhancedUrgency = starRating === 1 ? \"high\" : \"medium\";\n            }\n        }\n        // Emoji can reinforce the text analysis\n        if (emojiRating) {\n            const emojiSentimentMap = {\n                \"\\uD83D\\uDE0D\": {\n                    sentiment: \"positive\",\n                    urgency: \"low\"\n                },\n                \"\\uD83D\\uDE0A\": {\n                    sentiment: \"positive\",\n                    urgency: \"low\"\n                },\n                \"\\uD83D\\uDE10\": {\n                    sentiment: \"neutral\",\n                    urgency: \"low\"\n                },\n                \"\\uD83D\\uDE1E\": {\n                    sentiment: \"negative\",\n                    urgency: \"medium\"\n                },\n                \"\\uD83D\\uDE21\": {\n                    sentiment: \"negative\",\n                    urgency: \"high\"\n                }\n            };\n            const emojiData = emojiSentimentMap[emojiRating];\n            if (emojiData && emojiData.sentiment === aiAnalysis.sentiment) {\n                // Emoji reinforces text analysis - increase confidence\n                enhancedConfidence = Math.min(0.95, enhancedConfidence + 0.1);\n                console.log(\"\\uD83C\\uDFAF Emoji reinforces text analysis - confidence boosted\");\n            } else if (emojiData && emojiData.sentiment !== aiAnalysis.sentiment) {\n                // Emoji conflicts with text - average them out\n                console.log(\"âš–ï¸ Emoji conflicts with text analysis - balancing\");\n                enhancedConfidence = Math.max(0.6, enhancedConfidence - 0.1);\n            }\n        }\n    } else {\n        // Low confidence AI analysis - use ratings to help determine sentiment\n        console.log(\"âš ï¸ Low confidence AI analysis - using ratings to enhance\");\n        // Create weighted sentiment based on text + stars + emoji\n        let textWeight = aiAnalysis.confidence // 0.0 to 1.0\n        ;\n        let starWeight = 0.4 // Fixed weight for star rating\n        ;\n        let emojiWeight = emojiRating ? 0.3 : 0;\n        // Normalize weights\n        let totalWeight = textWeight + starWeight + emojiWeight;\n        textWeight = textWeight / totalWeight;\n        starWeight = starWeight / totalWeight;\n        emojiWeight = emojiWeight / totalWeight;\n        console.log(\"\\uD83D\\uDCCA Sentiment weights:\", {\n            textWeight,\n            starWeight,\n            emojiWeight\n        });\n        // Calculate sentiment scores\n        let positiveScore = 0;\n        let negativeScore = 0;\n        let neutralScore = 0;\n        // Text contribution\n        if (aiAnalysis.sentiment === \"positive\") positiveScore += textWeight;\n        else if (aiAnalysis.sentiment === \"negative\") negativeScore += textWeight;\n        else neutralScore += textWeight;\n        // Star rating contribution\n        if (starRating >= 4) positiveScore += starWeight;\n        else if (starRating <= 2) negativeScore += starWeight;\n        else neutralScore += starWeight;\n        // Emoji contribution\n        if (emojiRating) {\n            if (emojiRating === \"\\uD83D\\uDE0D\" || emojiRating === \"\\uD83D\\uDE0A\") positiveScore += emojiWeight;\n            else if (emojiRating === \"\\uD83D\\uDE1E\" || emojiRating === \"\\uD83D\\uDE21\") negativeScore += emojiWeight;\n            else neutralScore += emojiWeight;\n        }\n        // Determine final sentiment\n        if (positiveScore > negativeScore && positiveScore > neutralScore) {\n            enhancedSentiment = \"positive\";\n            enhancedConfidence = 0.6 + positiveScore * 0.3;\n            enhancedUrgency = \"low\";\n        } else if (negativeScore > positiveScore && negativeScore > neutralScore) {\n            enhancedSentiment = \"negative\";\n            enhancedConfidence = 0.6 + negativeScore * 0.3;\n            enhancedUrgency = starRating <= 2 ? starRating === 1 ? \"high\" : \"medium\" : \"medium\";\n        } else {\n            enhancedSentiment = \"neutral\";\n            enhancedConfidence = 0.6 + neutralScore * 0.2;\n            enhancedUrgency = \"low\";\n        }\n        console.log(\"\\uD83D\\uDCC8 Sentiment scores:\", {\n            positiveScore,\n            negativeScore,\n            neutralScore\n        });\n    }\n    console.log(\"âœ… Final enhanced analysis:\", {\n        sentiment: enhancedSentiment,\n        confidence: enhancedConfidence,\n        urgency: enhancedUrgency\n    });\n    return {\n        ...aiAnalysis,\n        sentiment: enhancedSentiment,\n        confidence: enhancedConfidence,\n        urgency: enhancedUrgency\n    };\n}\nfunction createFallbackAnalysis(text, starRating, emojiRating, language) {\n    console.log(\"\\uD83D\\uDD04 Creating fallback analysis for:\", {\n        text: text.substring(0, 50) + \"...\",\n        starRating,\n        emojiRating\n    });\n    // Enhanced text analysis\n    let textSentiment = \"neutral\";\n    let textConfidence = 0.5;\n    if (text && text.trim().length > 0) {\n        // Enhanced word lists for better accuracy\n        const positiveWords = [\n            \"good\",\n            \"great\",\n            \"excellent\",\n            \"amazing\",\n            \"wonderful\",\n            \"beautiful\",\n            \"love\",\n            \"perfect\",\n            \"awesome\",\n            \"fantastic\",\n            \"outstanding\",\n            \"superb\",\n            \"brilliant\",\n            \"magnificent\",\n            \"marvelous\",\n            \"delightful\",\n            \"pleasant\",\n            \"enjoyable\",\n            \"satisfying\",\n            \"impressive\",\n            \"remarkable\",\n            \"splendid\",\n            \"clean\",\n            \"friendly\",\n            \"helpful\",\n            \"comfortable\",\n            \"peaceful\",\n            \"relaxing\",\n            \"refreshing\",\n            \"nice\",\n            \"lovely\",\n            \"charming\",\n            \"stunning\",\n            \"breathtaking\",\n            \"incredible\",\n            \"fabulous\",\n            // Hindi positive words\n            \"à¤…à¤šà¥à¤›à¤¾\",\n            \"à¤¬à¤¹à¥à¤¤\",\n            \"à¤¸à¥à¤‚à¤¦à¤°\",\n            \"à¤–à¥à¤¶\",\n            \"à¤ªà¥à¤°à¤¸à¤¨à¥à¤¨\",\n            \"à¤‰à¤¤à¥à¤•à¥ƒà¤·à¥à¤Ÿ\",\n            \"à¤¶à¤¾à¤¨à¤¦à¤¾à¤°\",\n            \"à¤¬à¥‡à¤¹à¤¤à¤°à¥€à¤¨\",\n            \"à¤®à¤œà¥‡à¤¦à¤¾à¤°\"\n        ];\n        const negativeWords = [\n            \"bad\",\n            \"terrible\",\n            \"awful\",\n            \"horrible\",\n            \"hate\",\n            \"worst\",\n            \"disappointing\",\n            \"poor\",\n            \"disgusting\",\n            \"pathetic\",\n            \"useless\",\n            \"worthless\",\n            \"annoying\",\n            \"frustrating\",\n            \"boring\",\n            \"unpleasant\",\n            \"uncomfortable\",\n            \"dirty\",\n            \"smelly\",\n            \"noisy\",\n            \"crowded\",\n            \"expensive\",\n            \"overpriced\",\n            \"rude\",\n            \"unfriendly\",\n            \"unhelpful\",\n            \"slow\",\n            \"delayed\",\n            \"cancelled\",\n            \"broken\",\n            \"damaged\",\n            \"unsafe\",\n            \"dangerous\",\n            \"scary\",\n            \"unsatisfactory\",\n            \"disappointing\",\n            // Hindi negative words\n            \"à¤¬à¥à¤°à¤¾\",\n            \"à¤—à¤‚à¤¦à¤¾\",\n            \"à¤–à¤°à¤¾à¤¬\",\n            \"à¤¦à¥à¤–à¥€\",\n            \"à¤¨à¤¿à¤°à¤¾à¤¶\",\n            \"à¤­à¤¯à¤¾à¤¨à¤•\",\n            \"à¤˜à¤Ÿà¤¿à¤¯à¤¾\",\n            \"à¤¬à¥‡à¤•à¤¾à¤°\",\n            \"à¤®à¤¹à¤‚à¤—à¤¾\"\n        ];\n        const words = text.toLowerCase().split(/\\s+/);\n        let positiveCount = 0;\n        let negativeCount = 0;\n        words.forEach((word)=>{\n            if (positiveWords.includes(word)) positiveCount++;\n            if (negativeWords.includes(word)) negativeCount++;\n        });\n        // Determine text sentiment\n        if (positiveCount > negativeCount) {\n            textSentiment = \"positive\";\n            textConfidence = Math.min(0.85, 0.6 + (positiveCount - negativeCount) * 0.1);\n        } else if (negativeCount > positiveCount) {\n            textSentiment = \"negative\";\n            textConfidence = Math.min(0.85, 0.6 + (negativeCount - positiveCount) * 0.1);\n        } else if (positiveCount === negativeCount && positiveCount > 0) {\n            textSentiment = \"neutral\";\n            textConfidence = 0.7;\n        }\n        console.log(\"\\uD83D\\uDCDD Text analysis:\", {\n            textSentiment,\n            textConfidence,\n            positiveCount,\n            negativeCount\n        });\n    }\n    // Combine text analysis with ratings using weighted approach\n    let finalSentiment = \"neutral\";\n    let finalConfidence = 0.5;\n    let urgency = \"low\";\n    // Weight distribution: Text (50%), Stars (30%), Emoji (20%)\n    let textWeight = text && text.trim().length > 0 ? 0.5 : 0;\n    let starWeight = 0.3 + (textWeight === 0 ? 0.5 : 0 // Increase star weight if no text\n    );\n    let emojiWeight = emojiRating ? 0.2 : 0;\n    // Normalize weights\n    let totalWeight = textWeight + starWeight + emojiWeight;\n    if (totalWeight > 0) {\n        textWeight = textWeight / totalWeight;\n        starWeight = starWeight / totalWeight;\n        emojiWeight = emojiWeight / totalWeight;\n    }\n    console.log(\"âš–ï¸ Analysis weights:\", {\n        textWeight,\n        starWeight,\n        emojiWeight\n    });\n    // Calculate sentiment scores\n    let positiveScore = 0;\n    let negativeScore = 0;\n    let neutralScore = 0;\n    // Text contribution\n    if (textSentiment === \"positive\") positiveScore += textWeight * textConfidence;\n    else if (textSentiment === \"negative\") negativeScore += textWeight * textConfidence;\n    else neutralScore += textWeight * (textConfidence || 0.5);\n    // Star rating contribution\n    if (starRating >= 4) positiveScore += starWeight;\n    else if (starRating <= 2) negativeScore += starWeight;\n    else neutralScore += starWeight;\n    // Emoji contribution\n    if (emojiRating) {\n        if (emojiRating === \"\\uD83D\\uDE0D\" || emojiRating === \"\\uD83D\\uDE0A\") positiveScore += emojiWeight;\n        else if (emojiRating === \"\\uD83D\\uDE1E\" || emojiRating === \"\\uD83D\\uDE21\") negativeScore += emojiWeight;\n        else neutralScore += emojiWeight;\n    }\n    // Determine final sentiment\n    if (positiveScore > negativeScore && positiveScore > neutralScore) {\n        finalSentiment = \"positive\";\n        finalConfidence = Math.min(0.9, 0.6 + positiveScore * 0.4);\n        urgency = \"low\";\n    } else if (negativeScore > positiveScore && negativeScore > neutralScore) {\n        finalSentiment = \"negative\";\n        finalConfidence = Math.min(0.9, 0.6 + negativeScore * 0.4);\n        urgency = starRating <= 2 ? starRating === 1 ? \"high\" : \"medium\" : \"medium\";\n        if (emojiRating === \"\\uD83D\\uDE21\") urgency = \"high\";\n    } else {\n        finalSentiment = \"neutral\";\n        finalConfidence = Math.min(0.8, 0.6 + neutralScore * 0.3);\n        urgency = \"low\";\n    }\n    // Extract keywords and categories\n    const keywords = [];\n    const categories = [];\n    const actionableInsights = [];\n    if (text) {\n        const lowercaseText = text.toLowerCase();\n        // Extract meaningful keywords\n        const words = text.split(/\\s+/).filter((word)=>word.length > 3 && ![\n                \"this\",\n                \"that\",\n                \"with\",\n                \"have\",\n                \"been\",\n                \"were\",\n                \"they\",\n                \"there\"\n            ].includes(word.toLowerCase()));\n        keywords.push(...words.slice(0, 5));\n        // Categorize based on content\n        if (lowercaseText.includes(\"room\") || lowercaseText.includes(\"stay\") || lowercaseText.includes(\"hotel\") || lowercaseText.includes(\"accommodation\")) categories.push(\"accommodation\");\n        if (lowercaseText.includes(\"food\") || lowercaseText.includes(\"meal\") || lowercaseText.includes(\"restaurant\") || lowercaseText.includes(\"eat\")) categories.push(\"food\");\n        if (lowercaseText.includes(\"staff\") || lowercaseText.includes(\"service\") || lowercaseText.includes(\"help\") || lowercaseText.includes(\"support\")) categories.push(\"service quality\");\n        if (lowercaseText.includes(\"clean\") || lowercaseText.includes(\"dirty\") || lowercaseText.includes(\"hygiene\") || lowercaseText.includes(\"maintenance\")) categories.push(\"cleanliness\");\n        if (lowercaseText.includes(\"price\") || lowercaseText.includes(\"cost\") || lowercaseText.includes(\"expensive\") || lowercaseText.includes(\"cheap\") || lowercaseText.includes(\"money\")) categories.push(\"pricing\");\n        if (lowercaseText.includes(\"location\") || lowercaseText.includes(\"place\") || lowercaseText.includes(\"area\") || lowercaseText.includes(\"destination\")) categories.push(\"location\");\n        // Generate actionable insights based on sentiment and content\n        if (finalSentiment === \"negative\") {\n            actionableInsights.push(\"Immediate attention required for customer satisfaction\");\n            if (starRating === 1) actionableInsights.push(\"Critical service improvement needed\");\n            if (categories.includes(\"cleanliness\")) actionableInsights.push(\"Focus on hygiene and cleanliness standards\");\n            if (categories.includes(\"service quality\")) actionableInsights.push(\"Staff training and customer service improvement required\");\n            if (categories.includes(\"pricing\")) actionableInsights.push(\"Review pricing strategy and value proposition\");\n        } else if (finalSentiment === \"positive\") {\n            actionableInsights.push(\"Leverage positive feedback for marketing and testimonials\");\n            if (categories.includes(\"service quality\")) actionableInsights.push(\"Recognize and reward excellent staff performance\");\n        }\n    }\n    console.log(`âœ… Enhanced fallback analysis: ${finalSentiment} (${finalConfidence.toFixed(2)} confidence) - Scores: P:${positiveScore.toFixed(2)} N:${negativeScore.toFixed(2)} Neu:${neutralScore.toFixed(2)}`);\n    return {\n        sentiment: finalSentiment,\n        confidence: finalConfidence,\n        emotions: {\n            joy: finalSentiment === \"positive\" ? finalConfidence * 0.8 : 0.1,\n            anger: finalSentiment === \"negative\" ? finalConfidence * 0.7 : 0.1,\n            sadness: finalSentiment === \"negative\" ? finalConfidence * 0.5 : 0.1,\n            surprise: 0.2,\n            fear: urgency === \"high\" ? 0.6 : 0.1,\n            disgust: finalSentiment === \"negative\" ? finalConfidence * 0.4 : 0.1\n        },\n        keywords,\n        language: language || \"en\",\n        toxicity: urgency === \"high\" ? 0.6 : 0,\n        urgency,\n        categories,\n        actionableInsights\n    };\n}\n// Enhanced feedback database with AI analysis\nlet feedbacks = [];\nasync function GET(request) {\n    try {\n        const { searchParams } = new URL(request.url);\n        const location = searchParams.get(\"location\");\n        const category = searchParams.get(\"category\");\n        const sentiment = searchParams.get(\"sentiment\");\n        const flagged = searchParams.get(\"flagged\");\n        const limit = parseInt(searchParams.get(\"limit\") || \"50\");\n        const offset = parseInt(searchParams.get(\"offset\") || \"0\");\n        let filteredFeedbacks = [\n            ...feedbacks\n        ];\n        if (location && location !== \"All\") {\n            filteredFeedbacks = filteredFeedbacks.filter((f)=>f.location === location);\n        }\n        if (category && category !== \"All\") {\n            filteredFeedbacks = filteredFeedbacks.filter((f)=>f.category === category);\n        }\n        if (sentiment && sentiment !== \"All\") {\n            filteredFeedbacks = filteredFeedbacks.filter((f)=>f.aiAnalysis.sentiment === sentiment);\n        }\n        if (flagged === \"true\") {\n            filteredFeedbacks = filteredFeedbacks.filter((f)=>f.flagged);\n        }\n        // Sort by timestamp (newest first)\n        filteredFeedbacks.sort((a, b)=>new Date(b.timestamp).getTime() - new Date(a.timestamp).getTime());\n        const paginatedFeedbacks = filteredFeedbacks.slice(offset, offset + limit);\n        // Calculate sentiment statistics (simplified - no urgency levels)\n        const sentimentStats = {\n            positive: filteredFeedbacks.filter((f)=>f.aiAnalysis.sentiment === \"positive\").length,\n            negative: filteredFeedbacks.filter((f)=>f.aiAnalysis.sentiment === \"negative\").length,\n            neutral: filteredFeedbacks.filter((f)=>f.aiAnalysis.sentiment === \"neutral\").length,\n            total: filteredFeedbacks.length\n        };\n        // Get sentiment trends\n        const sentimentTrends = SentimentMonitor.getSentimentTrends(location || undefined, category || undefined);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            feedbacks: paginatedFeedbacks,\n            total: filteredFeedbacks.length,\n            sentimentStats,\n            sentimentTrends,\n            hasMore: offset + limit < filteredFeedbacks.length\n        });\n    } catch (error) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to fetch feedback\"\n        }, {\n            status: 500\n        });\n    }\n}\nasync function POST(request) {\n    try {\n        const body = await request.json();\n        const { userId, userName, location, category, rating, textFeedback, language = \"auto\", voiceData, imageData, emojiRating } = body;\n        // Enhanced AI analysis with star rating and emoji integration\n        let aiAnalysis;\n        let voiceAnalysis;\n        let imageAnalysis;\n        try {\n            // Convert base64 data to blobs if provided\n            const voiceBlob = voiceData ? new Blob([\n                Buffer.from(voiceData, \"base64\")\n            ], {\n                type: \"audio/wav\"\n            }) : undefined;\n            const imageBlob = imageData ? new Blob([\n                Buffer.from(imageData, \"base64\")\n            ], {\n                type: \"image/jpeg\"\n            }) : undefined;\n            const analysisResults = await analyzeAdvancedFeedback(textFeedback, voiceBlob, imageBlob, language);\n            aiAnalysis = analysisResults.aiAnalysis;\n            voiceAnalysis = analysisResults.voiceAnalysis;\n            imageAnalysis = analysisResults.imageAnalysis;\n            // Enhance analysis with star rating and emoji data\n            aiAnalysis = enhanceAnalysisWithRatings(aiAnalysis, rating, emojiRating);\n            console.log(\"âœ… Enhanced AI analysis complete:\", {\n                sentiment: aiAnalysis.sentiment,\n                confidence: aiAnalysis.confidence,\n                urgency: aiAnalysis.urgency,\n                starRating: rating,\n                emoji: emojiRating\n            });\n        } catch (error) {\n            console.error(\"AI analysis failed, using enhanced fallback:\", error);\n            // Enhanced fallback analysis with star rating and emoji\n            aiAnalysis = createFallbackAnalysis(textFeedback || \"\", rating, emojiRating, language);\n        }\n        // Determine urgency level\n        const urgencyLevel = aiAnalysis.urgency || \"low\";\n        // Check for flagging conditions\n        const flagged = aiAnalysis.sentiment === \"negative\" && aiAnalysis.confidence > 0.7 || aiAnalysis.toxicity && aiAnalysis.toxicity > 0.5 || urgencyLevel === \"critical\" || urgencyLevel === \"high\";\n        const newFeedback = {\n            id: feedbacks.length + 1,\n            userId,\n            userName,\n            location,\n            category,\n            rating,\n            textFeedback,\n            language: aiAnalysis.language,\n            voiceData,\n            imageData,\n            emojiRating,\n            aiAnalysis,\n            voiceAnalysis,\n            imageAnalysis,\n            timestamp: new Date().toISOString(),\n            isVerified: false,\n            responseFromVendor: undefined,\n            flagged,\n            urgencyLevel\n        };\n        // Generate auto-response using AI chatbot\n        try {\n            newFeedback.autoResponseGenerated = await FeedbackChatbot.generateResponse(newFeedback);\n        } catch (error) {\n            console.error(\"Auto-response generation failed:\", error);\n        }\n        feedbacks.push(newFeedback);\n        // Add to sentiment monitoring\n        SentimentMonitor.addSentiment(newFeedback);\n        // Trigger alerts for critical issues\n        await AlertSystem.triggerAlert(newFeedback);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            ...newFeedback,\n            followUpQuestions: await FeedbackChatbot.generateFollowUpQuestions(newFeedback)\n        }, {\n            status: 201\n        });\n    } catch (error) {\n        console.error(\"Failed to submit feedback:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to submit feedback\"\n        }, {\n            status: 500\n        });\n    }\n}\nasync function PUT(request) {\n    try {\n        const body = await request.json();\n        const { feedbackId, responseFromVendor, flagged } = body;\n        const feedbackIndex = feedbacks.findIndex((f)=>f.id === feedbackId);\n        if (feedbackIndex === -1) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Feedback not found\"\n            }, {\n                status: 404\n            });\n        }\n        feedbacks[feedbackIndex] = {\n            ...feedbacks[feedbackIndex],\n            ...responseFromVendor && {\n                responseFromVendor\n            },\n            ...typeof flagged === \"boolean\" && {\n                flagged\n            },\n            updatedAt: new Date().toISOString()\n        };\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(feedbacks[feedbackIndex]);\n    } catch (error) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to update feedback\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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akY7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL215LXYwLXByb2plY3QvLi9hcHAvYXBpL2ZlZWRiYWNrL3JvdXRlLnRzPzgxMzciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJ1xyXG5pbXBvcnQgeyBhaVNlcnZpY2UsIEFJQW5hbHlzaXNSZXN1bHQsIFZvaWNlQW5hbHlzaXNSZXN1bHQsIEltYWdlQW5hbHlzaXNSZXN1bHQgfSBmcm9tICdAL2xpYi9haS1zZXJ2aWNlcydcclxuXHJcbi8vIEVuaGFuY2VkIGZlZWRiYWNrIGludGVyZmFjZVxyXG5pbnRlcmZhY2UgRW5oYW5jZWRGZWVkYmFjayB7XHJcbiAgaWQ6IG51bWJlclxyXG4gIHVzZXJJZDogc3RyaW5nXHJcbiAgdXNlck5hbWU6IHN0cmluZ1xyXG4gIGxvY2F0aW9uOiBzdHJpbmdcclxuICBjYXRlZ29yeTogc3RyaW5nXHJcbiAgcmF0aW5nOiBudW1iZXJcclxuICB0ZXh0RmVlZGJhY2s/OiBzdHJpbmdcclxuICBsYW5ndWFnZTogc3RyaW5nXHJcbiAgdm9pY2VEYXRhPzogc3RyaW5nXHJcbiAgaW1hZ2VEYXRhPzogc3RyaW5nXHJcbiAgZW1vamlSYXRpbmc/OiBzdHJpbmdcclxuICBhaUFuYWx5c2lzOiBBSUFuYWx5c2lzUmVzdWx0XHJcbiAgdm9pY2VBbmFseXNpcz86IFZvaWNlQW5hbHlzaXNSZXN1bHRcclxuICBpbWFnZUFuYWx5c2lzPzogSW1hZ2VBbmFseXNpc1Jlc3VsdFxyXG4gIHRpbWVzdGFtcDogc3RyaW5nXHJcbiAgaXNWZXJpZmllZDogYm9vbGVhblxyXG4gIHJlc3BvbnNlRnJvbVZlbmRvcj86IHN0cmluZ1xyXG4gIGZsYWdnZWQ6IGJvb2xlYW5cclxuICB1cmdlbmN5TGV2ZWw6ICdsb3cnIHwgJ21lZGl1bScgfCAnaGlnaCcgfCAnY3JpdGljYWwnXHJcbiAgYXV0b1Jlc3BvbnNlR2VuZXJhdGVkPzogc3RyaW5nXHJcbiAgZXNjYWxhdGVkPzogYm9vbGVhblxyXG4gIHJlc29sdmVkQXQ/OiBzdHJpbmdcclxuICBzYXRpc2ZhY3Rpb25Gb2xsb3dVcD86IG51bWJlclxyXG59XHJcblxyXG4vLyBSZWFsLXRpbWUgYWxlcnQgc3lzdGVtXHJcbmNsYXNzIEFsZXJ0U3lzdGVtIHtcclxuICBzdGF0aWMgYXN5bmMgdHJpZ2dlckFsZXJ0KGZlZWRiYWNrOiBFbmhhbmNlZEZlZWRiYWNrKSB7XHJcbiAgICBpZiAoZmVlZGJhY2sudXJnZW5jeUxldmVsID09PSAnY3JpdGljYWwnIHx8IGZlZWRiYWNrLnVyZ2VuY3lMZXZlbCA9PT0gJ2hpZ2gnKSB7XHJcbiAgICAgIC8vIEluIHByb2R1Y3Rpb24sIHRoaXMgd291bGQgc2VuZCByZWFsIG5vdGlmaWNhdGlvbnNcclxuICAgICAgY29uc29sZS5sb2coYPCfmqggQ1JJVElDQUwgQUxFUlQ6ICR7ZmVlZGJhY2subG9jYXRpb259IC0gJHtmZWVkYmFjay5jYXRlZ29yeX1gKTtcclxuICAgICAgY29uc29sZS5sb2coYElzc3VlOiAke2ZlZWRiYWNrLmFpQW5hbHlzaXMuYWN0aW9uYWJsZUluc2lnaHRzPy5qb2luKCcsICcpfWApO1xyXG4gICAgICBcclxuICAgICAgLy8gQXV0by1nZW5lcmF0ZSByZXNwb25zZSBmb3IgY3JpdGljYWwgaXNzdWVzXHJcbiAgICAgIGZlZWRiYWNrLmF1dG9SZXNwb25zZUdlbmVyYXRlZCA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVBdXRvUmVzcG9uc2UoZmVlZGJhY2spO1xyXG4gICAgICBmZWVkYmFjay5lc2NhbGF0ZWQgPSB0cnVlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc3RhdGljIGFzeW5jIGdlbmVyYXRlQXV0b1Jlc3BvbnNlKGZlZWRiYWNrOiBFbmhhbmNlZEZlZWRiYWNrKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICAgIGNvbnN0IGluc2lnaHRzID0gZmVlZGJhY2suYWlBbmFseXNpcy5hY3Rpb25hYmxlSW5zaWdodHMgfHwgW107XHJcbiAgICBcclxuICAgIGlmIChpbnNpZ2h0cy5zb21lKGkgPT4gaS5pbmNsdWRlcygnVVJHRU5UJykgfHwgaS5pbmNsdWRlcygnU2FmZXR5JykpKSB7XHJcbiAgICAgIHJldHVybiBgVGhhbmsgeW91IGZvciBicmluZ2luZyB0aGlzIHNhZmV0eSBjb25jZXJuIHRvIG91ciBhdHRlbnRpb24uIFdlIGhhdmUgaW1tZWRpYXRlbHkgZXNjYWxhdGVkIHRoaXMgaXNzdWUgdG8gb3VyIHNhZmV0eSB0ZWFtIGFuZCB3aWxsIGFkZHJlc3MgaXQgd2l0aGluIDI0IGhvdXJzLiBZb3VyIHNhZmV0eSBpcyBvdXIgdG9wIHByaW9yaXR5LmA7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmIChmZWVkYmFjay5haUFuYWx5c2lzLnNlbnRpbWVudCA9PT0gJ25lZ2F0aXZlJyAmJiBmZWVkYmFjay5haUFuYWx5c2lzLmNvbmZpZGVuY2UgPiAwLjgpIHtcclxuICAgICAgcmV0dXJuIGBXZSBzaW5jZXJlbHkgYXBvbG9naXplIGZvciB5b3VyIGRpc2FwcG9pbnRpbmcgZXhwZXJpZW5jZS4gV2UgaGF2ZSBmb3J3YXJkZWQgeW91ciBmZWVkYmFjayB0byB0aGUgcmVsZXZhbnQgdGVhbSBmb3IgaW1tZWRpYXRlIGFjdGlvbi4gV2Ugd2lsbCBjb250YWN0IHlvdSB3aXRoaW4gNDggaG91cnMgd2l0aCBhbiB1cGRhdGUgb24gdGhlIGltcHJvdmVtZW50cyBiZWluZyBtYWRlLmA7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiBgVGhhbmsgeW91IGZvciB5b3VyIHZhbHVhYmxlIGZlZWRiYWNrLiBXZSBhcHByZWNpYXRlIHlvdSB0YWtpbmcgdGhlIHRpbWUgdG8gc2hhcmUgeW91ciBleHBlcmllbmNlIHdpdGggdXMuYDtcclxuICB9XHJcbn1cclxuXHJcbi8vIEFkdmFuY2VkIEFJLXBvd2VyZWQgZmVlZGJhY2sgYW5hbHlzaXNcclxuYXN5bmMgZnVuY3Rpb24gYW5hbHl6ZUFkdmFuY2VkRmVlZGJhY2soXHJcbiAgdGV4dEZlZWRiYWNrPzogc3RyaW5nLFxyXG4gIHZvaWNlQmxvYj86IEJsb2IsXHJcbiAgaW1hZ2VCbG9iPzogQmxvYixcclxuICBsYW5ndWFnZTogc3RyaW5nID0gJ2F1dG8nXHJcbik6IFByb21pc2U8e1xyXG4gIGFpQW5hbHlzaXM/OiBBSUFuYWx5c2lzUmVzdWx0XHJcbiAgdm9pY2VBbmFseXNpcz86IFZvaWNlQW5hbHlzaXNSZXN1bHRcclxuICBpbWFnZUFuYWx5c2lzPzogSW1hZ2VBbmFseXNpc1Jlc3VsdFxyXG59PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHJlc3VsdHM6IGFueSA9IHt9XHJcblxyXG4gICAgLy8gQW5hbHl6ZSB0ZXh0IGlmIHByb3ZpZGVkXHJcbiAgICBpZiAodGV4dEZlZWRiYWNrKSB7XHJcbiAgICAgIHJlc3VsdHMuYWlBbmFseXNpcyA9IGF3YWl0IGFpU2VydmljZS5hbmFseXplVGV4dCh0ZXh0RmVlZGJhY2ssIGxhbmd1YWdlKVxyXG4gICAgfVxyXG5cclxuICAgIC8vIEFuYWx5emUgdm9pY2UgaWYgcHJvdmlkZWRcclxuICAgIGlmICh2b2ljZUJsb2IpIHtcclxuICAgICAgcmVzdWx0cy52b2ljZUFuYWx5c2lzID0gYXdhaXQgYWlTZXJ2aWNlLmFuYWx5emVWb2ljZSh2b2ljZUJsb2IpXHJcbiAgICAgIFxyXG4gICAgICAvLyBJZiBubyB0ZXh0IGZlZWRiYWNrLCB1c2Ugdm9pY2UgdHJhbnNjcmlwdGlvbiBmb3IgdGV4dCBhbmFseXNpc1xyXG4gICAgICBpZiAoIXRleHRGZWVkYmFjayAmJiByZXN1bHRzLnZvaWNlQW5hbHlzaXMudHJhbnNjcmlwdGlvbikge1xyXG4gICAgICAgIHJlc3VsdHMuYWlBbmFseXNpcyA9IGF3YWl0IGFpU2VydmljZS5hbmFseXplVGV4dChyZXN1bHRzLnZvaWNlQW5hbHlzaXMudHJhbnNjcmlwdGlvbiwgbGFuZ3VhZ2UpXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBBbmFseXplIGltYWdlIGlmIHByb3ZpZGVkXHJcbiAgICBpZiAoaW1hZ2VCbG9iKSB7XHJcbiAgICAgIHJlc3VsdHMuaW1hZ2VBbmFseXNpcyA9IGF3YWl0IGFpU2VydmljZS5hbmFseXplSW1hZ2UoaW1hZ2VCbG9iKVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiByZXN1bHRzXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0FkdmFuY2VkIGZlZWRiYWNrIGFuYWx5c2lzIGZhaWxlZDonLCBlcnJvcilcclxuICAgIFxyXG4gICAgLy8gRmFsbGJhY2sgYW5hbHlzaXNcclxuICAgIGlmICh0ZXh0RmVlZGJhY2spIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBhaUFuYWx5c2lzOiBhd2FpdCBhaVNlcnZpY2UuYW5hbHl6ZVRleHQodGV4dEZlZWRiYWNrLCBsYW5ndWFnZSlcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICB0aHJvdyBlcnJvclxyXG4gIH1cclxufVxyXG5cclxuLy8gUmVhbC10aW1lIHNlbnRpbWVudCBtb25pdG9yaW5nXHJcbmNsYXNzIFNlbnRpbWVudE1vbml0b3Ige1xyXG4gIHByaXZhdGUgc3RhdGljIHNlbnRpbWVudEhpc3Rvcnk6IEFycmF5PHtcclxuICAgIHRpbWVzdGFtcDogc3RyaW5nXHJcbiAgICBzZW50aW1lbnQ6IHN0cmluZ1xyXG4gICAgY29uZmlkZW5jZTogbnVtYmVyXHJcbiAgICBsb2NhdGlvbjogc3RyaW5nXHJcbiAgICBjYXRlZ29yeTogc3RyaW5nXHJcbiAgfT4gPSBbXVxyXG5cclxuICBzdGF0aWMgYWRkU2VudGltZW50KGZlZWRiYWNrOiBFbmhhbmNlZEZlZWRiYWNrKSB7XHJcbiAgICB0aGlzLnNlbnRpbWVudEhpc3RvcnkucHVzaCh7XHJcbiAgICAgIHRpbWVzdGFtcDogZmVlZGJhY2sudGltZXN0YW1wLFxyXG4gICAgICBzZW50aW1lbnQ6IGZlZWRiYWNrLmFpQW5hbHlzaXMuc2VudGltZW50LFxyXG4gICAgICBjb25maWRlbmNlOiBmZWVkYmFjay5haUFuYWx5c2lzLmNvbmZpZGVuY2UsXHJcbiAgICAgIGxvY2F0aW9uOiBmZWVkYmFjay5sb2NhdGlvbixcclxuICAgICAgY2F0ZWdvcnk6IGZlZWRiYWNrLmNhdGVnb3J5XHJcbiAgICB9KVxyXG5cclxuICAgIC8vIEtlZXAgb25seSBsYXN0IDEwMDAgZW50cmllc1xyXG4gICAgaWYgKHRoaXMuc2VudGltZW50SGlzdG9yeS5sZW5ndGggPiAxMDAwKSB7XHJcbiAgICAgIHRoaXMuc2VudGltZW50SGlzdG9yeSA9IHRoaXMuc2VudGltZW50SGlzdG9yeS5zbGljZSgtMTAwMClcclxuICAgIH1cclxuXHJcbiAgICAvLyBDaGVjayBmb3Igc2VudGltZW50IHRyZW5kc1xyXG4gICAgdGhpcy5jaGVja1NlbnRpbWVudFRyZW5kcyhmZWVkYmFjay5sb2NhdGlvbiwgZmVlZGJhY2suY2F0ZWdvcnkpXHJcbiAgfVxyXG5cclxuICBzdGF0aWMgY2hlY2tTZW50aW1lbnRUcmVuZHMobG9jYXRpb246IHN0cmluZywgY2F0ZWdvcnk6IHN0cmluZykge1xyXG4gICAgY29uc3QgcmVjZW50RmVlZGJhY2tzID0gdGhpcy5zZW50aW1lbnRIaXN0b3J5XHJcbiAgICAgIC5maWx0ZXIocyA9PiBzLmxvY2F0aW9uID09PSBsb2NhdGlvbiAmJiBzLmNhdGVnb3J5ID09PSBjYXRlZ29yeSlcclxuICAgICAgLnNsaWNlKC0xMCkgLy8gTGFzdCAxMCBmZWVkYmFja3MgZm9yIHRoaXMgbG9jYXRpb24vY2F0ZWdvcnlcclxuXHJcbiAgICBpZiAocmVjZW50RmVlZGJhY2tzLmxlbmd0aCA+PSA1KSB7XHJcbiAgICAgIGNvbnN0IG5lZ2F0aXZlRmVlZGJhY2tzID0gcmVjZW50RmVlZGJhY2tzLmZpbHRlcihzID0+IHMuc2VudGltZW50ID09PSAnbmVnYXRpdmUnKVxyXG4gICAgICBcclxuICAgICAgaWYgKG5lZ2F0aXZlRmVlZGJhY2tzLmxlbmd0aCA+PSAzKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coYOKaoO+4jyBUUkVORCBBTEVSVDogSW5jcmVhc2luZyBuZWdhdGl2ZSBzZW50aW1lbnQgZGV0ZWN0ZWQgZm9yICR7bG9jYXRpb259IC0gJHtjYXRlZ29yeX1gKVxyXG4gICAgICAgIC8vIEluIHByb2R1Y3Rpb24sIHRoaXMgd291bGQgdHJpZ2dlciBub3RpZmljYXRpb25zIHRvIHRvdXJpc20gb2ZmaWNpYWxzXHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHN0YXRpYyBnZXRTZW50aW1lbnRUcmVuZHMobG9jYXRpb24/OiBzdHJpbmcsIGNhdGVnb3J5Pzogc3RyaW5nKSB7XHJcbiAgICBsZXQgZmlsdGVyZWQgPSB0aGlzLnNlbnRpbWVudEhpc3RvcnlcclxuICAgIFxyXG4gICAgaWYgKGxvY2F0aW9uKSB7XHJcbiAgICAgIGZpbHRlcmVkID0gZmlsdGVyZWQuZmlsdGVyKHMgPT4gcy5sb2NhdGlvbiA9PT0gbG9jYXRpb24pXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmIChjYXRlZ29yeSkge1xyXG4gICAgICBmaWx0ZXJlZCA9IGZpbHRlcmVkLmZpbHRlcihzID0+IHMuY2F0ZWdvcnkgPT09IGNhdGVnb3J5KVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gZmlsdGVyZWQuc2xpY2UoLTMwKSAvLyBMYXN0IDMwIGVudHJpZXNcclxuICB9XHJcbn1cclxuXHJcbi8vIEFJLXBvd2VyZWQgY2hhdGJvdCBmb3IgaW5zdGFudCByZXNwb25zZXNcclxuY2xhc3MgRmVlZGJhY2tDaGF0Ym90IHtcclxuICBzdGF0aWMgYXN5bmMgZ2VuZXJhdGVSZXNwb25zZShmZWVkYmFjazogRW5oYW5jZWRGZWVkYmFjayk6IFByb21pc2U8c3RyaW5nPiB7XHJcbiAgICBjb25zdCB7IGFpQW5hbHlzaXMsIGxvY2F0aW9uLCBjYXRlZ29yeSB9ID0gZmVlZGJhY2tcclxuICAgIFxyXG4gICAgLy8gR2VuZXJhdGUgY29udGV4dHVhbCByZXNwb25zZSBiYXNlZCBvbiBBSSBhbmFseXNpc1xyXG4gICAgaWYgKGFpQW5hbHlzaXMudXJnZW5jeSA9PT0gJ2NyaXRpY2FsJykge1xyXG4gICAgICByZXR1cm4gYFRoYW5rIHlvdSBmb3IgdGhpcyBjcml0aWNhbCBmZWVkYmFjayBhYm91dCAke2xvY2F0aW9ufS4gV2UgYXJlIGltbWVkaWF0ZWx5IGFkZHJlc3NpbmcgdGhlICR7YWlBbmFseXNpcy5jYXRlZ29yaWVzPy5qb2luKCcsICcpfSBpc3N1ZXMgeW91J3ZlIG1lbnRpb25lZC4gQSBzZW5pb3Igb2ZmaWNpYWwgd2lsbCBjb250YWN0IHlvdSB3aXRoaW4gMiBob3Vycy5gXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmIChhaUFuYWx5c2lzLnNlbnRpbWVudCA9PT0gJ3Bvc2l0aXZlJykge1xyXG4gICAgICByZXR1cm4gYFdlJ3JlIGRlbGlnaHRlZCB0byBoZWFyIGFib3V0IHlvdXIgcG9zaXRpdmUgZXhwZXJpZW5jZSBhdCAke2xvY2F0aW9ufSEgVGhhbmsgeW91IGZvciBoaWdobGlnaHRpbmcgJHthaUFuYWx5c2lzLmtleXdvcmRzLnNsaWNlKDAsIDMpLmpvaW4oJywgJyl9LiBXZSdsbCBzaGFyZSB5b3VyIGZlZWRiYWNrIHdpdGggb3VyIHRlYW0uYFxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZiAoYWlBbmFseXNpcy5zZW50aW1lbnQgPT09ICduZWdhdGl2ZScpIHtcclxuICAgICAgY29uc3QgaXNzdWVzID0gYWlBbmFseXNpcy5hY3Rpb25hYmxlSW5zaWdodHM/LnNsaWNlKDAsIDIpLmpvaW4oJyBhbmQgJykgfHwgJ3RoZSBpc3N1ZXMgeW91IG1lbnRpb25lZCdcclxuICAgICAgcmV0dXJuIGBXZSBzaW5jZXJlbHkgYXBvbG9naXplIGZvciB5b3VyIGV4cGVyaWVuY2UgYXQgJHtsb2NhdGlvbn0uIFdlJ3JlIHRha2luZyBpbW1lZGlhdGUgYWN0aW9uIG9uICR7aXNzdWVzfS4gWW91IGNhbiBleHBlY3QgYW4gdXBkYXRlIHdpdGhpbiAyNC00OCBob3Vycy5gXHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiBgVGhhbmsgeW91IGZvciB5b3VyIGZlZWRiYWNrIGFib3V0ICR7bG9jYXRpb259LiBZb3VyIGluc2lnaHRzIGFib3V0ICR7Y2F0ZWdvcnkudG9Mb3dlckNhc2UoKX0gYXJlIHZhbHVhYmxlIGZvciBpbXByb3Zpbmcgb3VyIHRvdXJpc20gc2VydmljZXMuYFxyXG4gIH1cclxuICBcclxuICBzdGF0aWMgYXN5bmMgZ2VuZXJhdGVGb2xsb3dVcFF1ZXN0aW9ucyhmZWVkYmFjazogRW5oYW5jZWRGZWVkYmFjayk6IFByb21pc2U8c3RyaW5nW10+IHtcclxuICAgIGNvbnN0IHF1ZXN0aW9uczogc3RyaW5nW10gPSBbXVxyXG4gICAgXHJcbiAgICBpZiAoZmVlZGJhY2suYWlBbmFseXNpcy5zZW50aW1lbnQgPT09ICduZWdhdGl2ZScpIHtcclxuICAgICAgcXVlc3Rpb25zLnB1c2goJ1doYXQgc3BlY2lmaWMgc3RlcHMgd291bGQgeW91IGxpa2UgdG8gc2VlIGltcGxlbWVudGVkIHRvIGltcHJvdmUgdGhpcyBleHBlcmllbmNlPycpXHJcbiAgICAgIHF1ZXN0aW9ucy5wdXNoKCdXb3VsZCB5b3UgYmUgd2lsbGluZyB0byByZXZpc2l0IHRoaXMgbG9jYXRpb24gaWYgaW1wcm92ZW1lbnRzIHdlcmUgbWFkZT8nKVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZiAoZmVlZGJhY2suYWlBbmFseXNpcy5jYXRlZ29yaWVzPy5pbmNsdWRlcygnc2VydmljZSBxdWFsaXR5JykpIHtcclxuICAgICAgcXVlc3Rpb25zLnB1c2goJ0NhbiB5b3UgcHJvdmlkZSBtb3JlIGRldGFpbHMgYWJvdXQgdGhlIHN0YWZmIGludGVyYWN0aW9uPycpXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmIChmZWVkYmFjay5haUFuYWx5c2lzLmNhdGVnb3JpZXM/LmluY2x1ZGVzKCdjbGVhbmxpbmVzcycpKSB7XHJcbiAgICAgIHF1ZXN0aW9ucy5wdXNoKCdXaGljaCBzcGVjaWZpYyBhcmVhcyBuZWVkIGF0dGVudGlvbiByZWdhcmRpbmcgY2xlYW5saW5lc3M/JylcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIHF1ZXN0aW9ucy5zbGljZSgwLCAzKVxyXG4gIH1cclxufVxyXG5cclxuLy8gRmFsbGJhY2sgcnVsZS1iYXNlZCBzZW50aW1lbnQgYW5hbHlzaXNcclxuZnVuY3Rpb24gZmFsbGJhY2tTZW50aW1lbnRBbmFseXNpcyh0ZXh0OiBzdHJpbmcsIGxhbmd1YWdlOiBzdHJpbmcpOiB7XHJcbiAgc2VudGltZW50OiAncG9zaXRpdmUnIHwgJ25lZ2F0aXZlJyB8ICduZXV0cmFsJ1xyXG4gIGNvbmZpZGVuY2U6IG51bWJlclxyXG4gIGVtb3Rpb25zOiB7IFtrZXk6IHN0cmluZ106IG51bWJlciB9XHJcbiAga2V5d29yZHM6IHN0cmluZ1tdXHJcbn0ge1xyXG4gIGNvbnN0IHBvc2l0aXZlV29yZHMgPSBbJ2dvb2QnLCAnZ3JlYXQnLCAnZXhjZWxsZW50JywgJ2FtYXppbmcnLCAnd29uZGVyZnVsJywgJ2JlYXV0aWZ1bCcsICdsb3ZlJywgJ3BlcmZlY3QnLCAnYXdlc29tZScsICdmYW50YXN0aWMnXVxyXG4gIGNvbnN0IG5lZ2F0aXZlV29yZHMgPSBbJ2JhZCcsICd0ZXJyaWJsZScsICdhd2Z1bCcsICdob3JyaWJsZScsICdoYXRlJywgJ3dvcnN0JywgJ2Rpc2FwcG9pbnRpbmcnLCAncG9vcicsICdkaXJ0eScsICd1bnNhZmUnXVxyXG4gIFxyXG4gIC8vIEhpbmRpIHBvc2l0aXZlL25lZ2F0aXZlIHdvcmRzXHJcbiAgY29uc3QgaGluZGlQb3NpdGl2ZSA9IFsn4KSF4KSa4KWN4KSb4KS+JywgJ+CkrOCkueClgeCkpCcsICfgpLjgpYHgpILgpKbgpLAnLCAn4KSW4KWB4KS2JywgJ+CkquCljeCksOCkuOCkqOCljeCkqCcsICfgpIngpKTgpY3gpJXgpYPgpLfgpY3gpJ8nXVxyXG4gIGNvbnN0IGhpbmRpTmVnYXRpdmUgPSBbJ+CkrOClgeCksOCkvicsICfgpJfgpILgpKbgpL4nLCAn4KSW4KSw4KS+4KSsJywgJ+CkpuClgeCkluClgCcsICfgpKjgpL/gpLDgpL7gpLYnXVxyXG5cclxuICBjb25zdCB3b3JkcyA9IHRleHQudG9Mb3dlckNhc2UoKS5zcGxpdCgvXFxzKy8pXHJcbiAgbGV0IHBvc2l0aXZlQ291bnQgPSAwXHJcbiAgbGV0IG5lZ2F0aXZlQ291bnQgPSAwXHJcbiAgbGV0IGtleXdvcmRzOiBzdHJpbmdbXSA9IFtdXHJcblxyXG4gIHdvcmRzLmZvckVhY2god29yZCA9PiB7XHJcbiAgICBpZiAocG9zaXRpdmVXb3Jkcy5pbmNsdWRlcyh3b3JkKSB8fCBoaW5kaVBvc2l0aXZlLmluY2x1ZGVzKHdvcmQpKSB7XHJcbiAgICAgIHBvc2l0aXZlQ291bnQrK1xyXG4gICAgICBrZXl3b3Jkcy5wdXNoKHdvcmQpXHJcbiAgICB9XHJcbiAgICBpZiAobmVnYXRpdmVXb3Jkcy5pbmNsdWRlcyh3b3JkKSB8fCBoaW5kaU5lZ2F0aXZlLmluY2x1ZGVzKHdvcmQpKSB7XHJcbiAgICAgIG5lZ2F0aXZlQ291bnQrK1xyXG4gICAgICBrZXl3b3Jkcy5wdXNoKHdvcmQpXHJcbiAgICB9XHJcbiAgfSlcclxuXHJcbiAgbGV0IHNlbnRpbWVudDogJ3Bvc2l0aXZlJyB8ICduZWdhdGl2ZScgfCAnbmV1dHJhbCcgPSAnbmV1dHJhbCdcclxuICBsZXQgY29uZmlkZW5jZSA9IDAuNVxyXG5cclxuICBpZiAocG9zaXRpdmVDb3VudCA+IG5lZ2F0aXZlQ291bnQpIHtcclxuICAgIHNlbnRpbWVudCA9ICdwb3NpdGl2ZSdcclxuICAgIGNvbmZpZGVuY2UgPSBNYXRoLm1pbigwLjksIDAuNSArIChwb3NpdGl2ZUNvdW50IC0gbmVnYXRpdmVDb3VudCkgKiAwLjEpXHJcbiAgfSBlbHNlIGlmIChuZWdhdGl2ZUNvdW50ID4gcG9zaXRpdmVDb3VudCkge1xyXG4gICAgc2VudGltZW50ID0gJ25lZ2F0aXZlJ1xyXG4gICAgY29uZmlkZW5jZSA9IE1hdGgubWluKDAuOSwgMC41ICsgKG5lZ2F0aXZlQ291bnQgLSBwb3NpdGl2ZUNvdW50KSAqIDAuMSlcclxuICB9XHJcblxyXG4gIGNvbnN0IGVtb3Rpb25zID0ge1xyXG4gICAgam95OiBzZW50aW1lbnQgPT09ICdwb3NpdGl2ZScgPyBjb25maWRlbmNlICogMC44IDogMC4xLFxyXG4gICAgYW5nZXI6IHNlbnRpbWVudCA9PT0gJ25lZ2F0aXZlJyA/IGNvbmZpZGVuY2UgKiAwLjYgOiAwLjEsXHJcbiAgICBzYWRuZXNzOiBzZW50aW1lbnQgPT09ICduZWdhdGl2ZScgPyBjb25maWRlbmNlICogMC40IDogMC4xLFxyXG4gICAgc3VycHJpc2U6IDAuMixcclxuICAgIGZlYXI6IHNlbnRpbWVudCA9PT0gJ25lZ2F0aXZlJyA/IGNvbmZpZGVuY2UgKiAwLjMgOiAwLjA1LFxyXG4gICAgZGlzZ3VzdDogc2VudGltZW50ID09PSAnbmVnYXRpdmUnID8gY29uZmlkZW5jZSAqIDAuMiA6IDAuMDVcclxuICB9XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBzZW50aW1lbnQsXHJcbiAgICBjb25maWRlbmNlLFxyXG4gICAgZW1vdGlvbnMsXHJcbiAgICBrZXl3b3Jkczoga2V5d29yZHMuc2xpY2UoMCwgNSlcclxuICB9XHJcbn1cclxuXHJcbi8vIEVuaGFuY2VkIGFuYWx5c2lzIGZ1bmN0aW9uc1xyXG5mdW5jdGlvbiBlbmhhbmNlQW5hbHlzaXNXaXRoUmF0aW5ncyhhaUFuYWx5c2lzOiBBSUFuYWx5c2lzUmVzdWx0LCBzdGFyUmF0aW5nOiBudW1iZXIsIGVtb2ppUmF0aW5nPzogc3RyaW5nKTogQUlBbmFseXNpc1Jlc3VsdCB7XHJcbiAgLy8gUHJpb3JpdGl6ZSBBSSB0ZXh0IGFuYWx5c2lzLCB1c2UgcmF0aW5ncyBhcyBlbmhhbmNlbWVudC92YWxpZGF0aW9uXHJcbiAgbGV0IGVuaGFuY2VkU2VudGltZW50ID0gYWlBbmFseXNpcy5zZW50aW1lbnRcclxuICBsZXQgZW5oYW5jZWRDb25maWRlbmNlID0gYWlBbmFseXNpcy5jb25maWRlbmNlXHJcbiAgbGV0IGVuaGFuY2VkVXJnZW5jeSA9IGFpQW5hbHlzaXMudXJnZW5jeSB8fCAnbG93J1xyXG5cclxuICBjb25zb2xlLmxvZygn8J+UjSBPcmlnaW5hbCBBSSBBbmFseXNpczonLCB7XHJcbiAgICBzZW50aW1lbnQ6IGFpQW5hbHlzaXMuc2VudGltZW50LFxyXG4gICAgY29uZmlkZW5jZTogYWlBbmFseXNpcy5jb25maWRlbmNlLFxyXG4gICAgc3RhclJhdGluZyxcclxuICAgIGVtb2ppUmF0aW5nXHJcbiAgfSlcclxuXHJcbiAgLy8gSWYgQUkgYW5hbHlzaXMgaGFzIGhpZ2ggY29uZmlkZW5jZSwgdHJ1c3QgaXQgbW9yZSB0aGFuIHJhdGluZ3NcclxuICBpZiAoYWlBbmFseXNpcy5jb25maWRlbmNlID4gMC43KSB7XHJcbiAgICBjb25zb2xlLmxvZygn4pyFIEhpZ2ggY29uZmlkZW5jZSBBSSBhbmFseXNpcyAtIHVzaW5nIHRleHQgc2VudGltZW50IGFzIHByaW1hcnknKVxyXG4gICAgXHJcbiAgICAvLyBPbmx5IGFkanVzdCB1cmdlbmN5IGJhc2VkIG9uIHN0YXIgcmF0aW5nIGlmIHRleHQgYW5hbHlzaXMgc3VnZ2VzdHMgbmVnYXRpdmUgc2VudGltZW50XHJcbiAgICBpZiAoYWlBbmFseXNpcy5zZW50aW1lbnQgPT09ICduZWdhdGl2ZScpIHtcclxuICAgICAgaWYgKHN0YXJSYXRpbmcgPD0gMikge1xyXG4gICAgICAgIGVuaGFuY2VkVXJnZW5jeSA9IHN0YXJSYXRpbmcgPT09IDEgPyAnaGlnaCcgOiAnbWVkaXVtJ1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIEVtb2ppIGNhbiByZWluZm9yY2UgdGhlIHRleHQgYW5hbHlzaXNcclxuICAgIGlmIChlbW9qaVJhdGluZykge1xyXG4gICAgICBjb25zdCBlbW9qaVNlbnRpbWVudE1hcDogeyBba2V5OiBzdHJpbmddOiB7IHNlbnRpbWVudDogJ3Bvc2l0aXZlJyB8ICduZWdhdGl2ZScgfCAnbmV1dHJhbCcsIHVyZ2VuY3k6ICdsb3cnIHwgJ21lZGl1bScgfCAnaGlnaCcgfCAnY3JpdGljYWwnIH0gfSA9IHtcclxuICAgICAgICAn8J+YjSc6IHsgc2VudGltZW50OiAncG9zaXRpdmUnLCB1cmdlbmN5OiAnbG93JyB9LFxyXG4gICAgICAgICfwn5iKJzogeyBzZW50aW1lbnQ6ICdwb3NpdGl2ZScsIHVyZ2VuY3k6ICdsb3cnIH0sXHJcbiAgICAgICAgJ/CfmJAnOiB7IHNlbnRpbWVudDogJ25ldXRyYWwnLCB1cmdlbmN5OiAnbG93JyB9LFxyXG4gICAgICAgICfwn5ieJzogeyBzZW50aW1lbnQ6ICduZWdhdGl2ZScsIHVyZ2VuY3k6ICdtZWRpdW0nIH0sXHJcbiAgICAgICAgJ/CfmKEnOiB7IHNlbnRpbWVudDogJ25lZ2F0aXZlJywgdXJnZW5jeTogJ2hpZ2gnIH1cclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgY29uc3QgZW1vamlEYXRhID0gZW1vamlTZW50aW1lbnRNYXBbZW1vamlSYXRpbmddXHJcbiAgICAgIGlmIChlbW9qaURhdGEgJiYgZW1vamlEYXRhLnNlbnRpbWVudCA9PT0gYWlBbmFseXNpcy5zZW50aW1lbnQpIHtcclxuICAgICAgICAvLyBFbW9qaSByZWluZm9yY2VzIHRleHQgYW5hbHlzaXMgLSBpbmNyZWFzZSBjb25maWRlbmNlXHJcbiAgICAgICAgZW5oYW5jZWRDb25maWRlbmNlID0gTWF0aC5taW4oMC45NSwgZW5oYW5jZWRDb25maWRlbmNlICsgMC4xKVxyXG4gICAgICAgIGNvbnNvbGUubG9nKCfwn46vIEVtb2ppIHJlaW5mb3JjZXMgdGV4dCBhbmFseXNpcyAtIGNvbmZpZGVuY2UgYm9vc3RlZCcpXHJcbiAgICAgIH0gZWxzZSBpZiAoZW1vamlEYXRhICYmIGVtb2ppRGF0YS5zZW50aW1lbnQgIT09IGFpQW5hbHlzaXMuc2VudGltZW50KSB7XHJcbiAgICAgICAgLy8gRW1vamkgY29uZmxpY3RzIHdpdGggdGV4dCAtIGF2ZXJhZ2UgdGhlbSBvdXRcclxuICAgICAgICBjb25zb2xlLmxvZygn4pqW77iPIEVtb2ppIGNvbmZsaWN0cyB3aXRoIHRleHQgYW5hbHlzaXMgLSBiYWxhbmNpbmcnKVxyXG4gICAgICAgIGVuaGFuY2VkQ29uZmlkZW5jZSA9IE1hdGgubWF4KDAuNiwgZW5oYW5jZWRDb25maWRlbmNlIC0gMC4xKVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSBlbHNlIHtcclxuICAgIC8vIExvdyBjb25maWRlbmNlIEFJIGFuYWx5c2lzIC0gdXNlIHJhdGluZ3MgdG8gaGVscCBkZXRlcm1pbmUgc2VudGltZW50XHJcbiAgICBjb25zb2xlLmxvZygn4pqg77iPIExvdyBjb25maWRlbmNlIEFJIGFuYWx5c2lzIC0gdXNpbmcgcmF0aW5ncyB0byBlbmhhbmNlJylcclxuICAgIFxyXG4gICAgLy8gQ3JlYXRlIHdlaWdodGVkIHNlbnRpbWVudCBiYXNlZCBvbiB0ZXh0ICsgc3RhcnMgKyBlbW9qaVxyXG4gICAgbGV0IHRleHRXZWlnaHQgPSBhaUFuYWx5c2lzLmNvbmZpZGVuY2UgLy8gMC4wIHRvIDEuMFxyXG4gICAgbGV0IHN0YXJXZWlnaHQgPSAwLjQgLy8gRml4ZWQgd2VpZ2h0IGZvciBzdGFyIHJhdGluZ1xyXG4gICAgbGV0IGVtb2ppV2VpZ2h0ID0gZW1vamlSYXRpbmcgPyAwLjMgOiAwXHJcbiAgICBcclxuICAgIC8vIE5vcm1hbGl6ZSB3ZWlnaHRzXHJcbiAgICBsZXQgdG90YWxXZWlnaHQgPSB0ZXh0V2VpZ2h0ICsgc3RhcldlaWdodCArIGVtb2ppV2VpZ2h0XHJcbiAgICB0ZXh0V2VpZ2h0ID0gdGV4dFdlaWdodCAvIHRvdGFsV2VpZ2h0XHJcbiAgICBzdGFyV2VpZ2h0ID0gc3RhcldlaWdodCAvIHRvdGFsV2VpZ2h0XHJcbiAgICBlbW9qaVdlaWdodCA9IGVtb2ppV2VpZ2h0IC8gdG90YWxXZWlnaHRcclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coJ/Cfk4ogU2VudGltZW50IHdlaWdodHM6JywgeyB0ZXh0V2VpZ2h0LCBzdGFyV2VpZ2h0LCBlbW9qaVdlaWdodCB9KVxyXG4gICAgXHJcbiAgICAvLyBDYWxjdWxhdGUgc2VudGltZW50IHNjb3Jlc1xyXG4gICAgbGV0IHBvc2l0aXZlU2NvcmUgPSAwXHJcbiAgICBsZXQgbmVnYXRpdmVTY29yZSA9IDBcclxuICAgIGxldCBuZXV0cmFsU2NvcmUgPSAwXHJcbiAgICBcclxuICAgIC8vIFRleHQgY29udHJpYnV0aW9uXHJcbiAgICBpZiAoYWlBbmFseXNpcy5zZW50aW1lbnQgPT09ICdwb3NpdGl2ZScpIHBvc2l0aXZlU2NvcmUgKz0gdGV4dFdlaWdodFxyXG4gICAgZWxzZSBpZiAoYWlBbmFseXNpcy5zZW50aW1lbnQgPT09ICduZWdhdGl2ZScpIG5lZ2F0aXZlU2NvcmUgKz0gdGV4dFdlaWdodFxyXG4gICAgZWxzZSBuZXV0cmFsU2NvcmUgKz0gdGV4dFdlaWdodFxyXG4gICAgXHJcbiAgICAvLyBTdGFyIHJhdGluZyBjb250cmlidXRpb25cclxuICAgIGlmIChzdGFyUmF0aW5nID49IDQpIHBvc2l0aXZlU2NvcmUgKz0gc3RhcldlaWdodFxyXG4gICAgZWxzZSBpZiAoc3RhclJhdGluZyA8PSAyKSBuZWdhdGl2ZVNjb3JlICs9IHN0YXJXZWlnaHRcclxuICAgIGVsc2UgbmV1dHJhbFNjb3JlICs9IHN0YXJXZWlnaHRcclxuICAgIFxyXG4gICAgLy8gRW1vamkgY29udHJpYnV0aW9uXHJcbiAgICBpZiAoZW1vamlSYXRpbmcpIHtcclxuICAgICAgaWYgKGVtb2ppUmF0aW5nID09PSAn8J+YjScgfHwgZW1vamlSYXRpbmcgPT09ICfwn5iKJykgcG9zaXRpdmVTY29yZSArPSBlbW9qaVdlaWdodFxyXG4gICAgICBlbHNlIGlmIChlbW9qaVJhdGluZyA9PT0gJ/CfmJ4nIHx8IGVtb2ppUmF0aW5nID09PSAn8J+YoScpIG5lZ2F0aXZlU2NvcmUgKz0gZW1vamlXZWlnaHRcclxuICAgICAgZWxzZSBuZXV0cmFsU2NvcmUgKz0gZW1vamlXZWlnaHRcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gRGV0ZXJtaW5lIGZpbmFsIHNlbnRpbWVudFxyXG4gICAgaWYgKHBvc2l0aXZlU2NvcmUgPiBuZWdhdGl2ZVNjb3JlICYmIHBvc2l0aXZlU2NvcmUgPiBuZXV0cmFsU2NvcmUpIHtcclxuICAgICAgZW5oYW5jZWRTZW50aW1lbnQgPSAncG9zaXRpdmUnXHJcbiAgICAgIGVuaGFuY2VkQ29uZmlkZW5jZSA9IDAuNiArIChwb3NpdGl2ZVNjb3JlICogMC4zKVxyXG4gICAgICBlbmhhbmNlZFVyZ2VuY3kgPSAnbG93J1xyXG4gICAgfSBlbHNlIGlmIChuZWdhdGl2ZVNjb3JlID4gcG9zaXRpdmVTY29yZSAmJiBuZWdhdGl2ZVNjb3JlID4gbmV1dHJhbFNjb3JlKSB7XHJcbiAgICAgIGVuaGFuY2VkU2VudGltZW50ID0gJ25lZ2F0aXZlJ1xyXG4gICAgICBlbmhhbmNlZENvbmZpZGVuY2UgPSAwLjYgKyAobmVnYXRpdmVTY29yZSAqIDAuMylcclxuICAgICAgZW5oYW5jZWRVcmdlbmN5ID0gc3RhclJhdGluZyA8PSAyID8gKHN0YXJSYXRpbmcgPT09IDEgPyAnaGlnaCcgOiAnbWVkaXVtJykgOiAnbWVkaXVtJ1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZW5oYW5jZWRTZW50aW1lbnQgPSAnbmV1dHJhbCdcclxuICAgICAgZW5oYW5jZWRDb25maWRlbmNlID0gMC42ICsgKG5ldXRyYWxTY29yZSAqIDAuMilcclxuICAgICAgZW5oYW5jZWRVcmdlbmN5ID0gJ2xvdydcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coJ/Cfk4ggU2VudGltZW50IHNjb3JlczonLCB7IHBvc2l0aXZlU2NvcmUsIG5lZ2F0aXZlU2NvcmUsIG5ldXRyYWxTY29yZSB9KVxyXG4gIH1cclxuXHJcbiAgY29uc29sZS5sb2coJ+KchSBGaW5hbCBlbmhhbmNlZCBhbmFseXNpczonLCB7XHJcbiAgICBzZW50aW1lbnQ6IGVuaGFuY2VkU2VudGltZW50LFxyXG4gICAgY29uZmlkZW5jZTogZW5oYW5jZWRDb25maWRlbmNlLFxyXG4gICAgdXJnZW5jeTogZW5oYW5jZWRVcmdlbmN5XHJcbiAgfSlcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIC4uLmFpQW5hbHlzaXMsXHJcbiAgICBzZW50aW1lbnQ6IGVuaGFuY2VkU2VudGltZW50LFxyXG4gICAgY29uZmlkZW5jZTogZW5oYW5jZWRDb25maWRlbmNlLFxyXG4gICAgdXJnZW5jeTogZW5oYW5jZWRVcmdlbmN5XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVGYWxsYmFja0FuYWx5c2lzKHRleHQ6IHN0cmluZywgc3RhclJhdGluZzogbnVtYmVyLCBlbW9qaVJhdGluZz86IHN0cmluZywgbGFuZ3VhZ2U/OiBzdHJpbmcpOiBBSUFuYWx5c2lzUmVzdWx0IHtcclxuICBjb25zb2xlLmxvZygn8J+UhCBDcmVhdGluZyBmYWxsYmFjayBhbmFseXNpcyBmb3I6JywgeyB0ZXh0OiB0ZXh0LnN1YnN0cmluZygwLCA1MCkgKyAnLi4uJywgc3RhclJhdGluZywgZW1vamlSYXRpbmcgfSlcclxuICBcclxuICAvLyBFbmhhbmNlZCB0ZXh0IGFuYWx5c2lzXHJcbiAgbGV0IHRleHRTZW50aW1lbnQ6ICdwb3NpdGl2ZScgfCAnbmVnYXRpdmUnIHwgJ25ldXRyYWwnID0gJ25ldXRyYWwnXHJcbiAgbGV0IHRleHRDb25maWRlbmNlID0gMC41XHJcbiAgXHJcbiAgaWYgKHRleHQgJiYgdGV4dC50cmltKCkubGVuZ3RoID4gMCkge1xyXG4gICAgLy8gRW5oYW5jZWQgd29yZCBsaXN0cyBmb3IgYmV0dGVyIGFjY3VyYWN5XHJcbiAgICBjb25zdCBwb3NpdGl2ZVdvcmRzID0gW1xyXG4gICAgICAnZ29vZCcsICdncmVhdCcsICdleGNlbGxlbnQnLCAnYW1hemluZycsICd3b25kZXJmdWwnLCAnYmVhdXRpZnVsJywgJ2xvdmUnLCAncGVyZmVjdCcsIFxyXG4gICAgICAnYXdlc29tZScsICdmYW50YXN0aWMnLCAnb3V0c3RhbmRpbmcnLCAnc3VwZXJiJywgJ2JyaWxsaWFudCcsICdtYWduaWZpY2VudCcsICdtYXJ2ZWxvdXMnLFxyXG4gICAgICAnZGVsaWdodGZ1bCcsICdwbGVhc2FudCcsICdlbmpveWFibGUnLCAnc2F0aXNmeWluZycsICdpbXByZXNzaXZlJywgJ3JlbWFya2FibGUnLCAnc3BsZW5kaWQnLFxyXG4gICAgICAnY2xlYW4nLCAnZnJpZW5kbHknLCAnaGVscGZ1bCcsICdjb21mb3J0YWJsZScsICdwZWFjZWZ1bCcsICdyZWxheGluZycsICdyZWZyZXNoaW5nJyxcclxuICAgICAgJ25pY2UnLCAnbG92ZWx5JywgJ2NoYXJtaW5nJywgJ3N0dW5uaW5nJywgJ2JyZWF0aHRha2luZycsICdpbmNyZWRpYmxlJywgJ2ZhYnVsb3VzJyxcclxuICAgICAgLy8gSGluZGkgcG9zaXRpdmUgd29yZHNcclxuICAgICAgJ+CkheCkmuCljeCkm+CkvicsICfgpKzgpLngpYHgpKQnLCAn4KS44KWB4KSC4KSm4KSwJywgJ+CkluClgeCkticsICfgpKrgpY3gpLDgpLjgpKjgpY3gpKgnLCAn4KSJ4KSk4KWN4KSV4KWD4KS34KWN4KSfJywgJ+CktuCkvuCkqOCkpuCkvuCksCcsICfgpKzgpYfgpLngpKTgpLDgpYDgpKgnLCAn4KSu4KSc4KWH4KSm4KS+4KSwJ1xyXG4gICAgXVxyXG4gICAgXHJcbiAgICBjb25zdCBuZWdhdGl2ZVdvcmRzID0gW1xyXG4gICAgICAnYmFkJywgJ3RlcnJpYmxlJywgJ2F3ZnVsJywgJ2hvcnJpYmxlJywgJ2hhdGUnLCAnd29yc3QnLCAnZGlzYXBwb2ludGluZycsICdwb29yJyxcclxuICAgICAgJ2Rpc2d1c3RpbmcnLCAncGF0aGV0aWMnLCAndXNlbGVzcycsICd3b3J0aGxlc3MnLCAnYW5ub3lpbmcnLCAnZnJ1c3RyYXRpbmcnLCAnYm9yaW5nJyxcclxuICAgICAgJ3VucGxlYXNhbnQnLCAndW5jb21mb3J0YWJsZScsICdkaXJ0eScsICdzbWVsbHknLCAnbm9pc3knLCAnY3Jvd2RlZCcsICdleHBlbnNpdmUnLFxyXG4gICAgICAnb3ZlcnByaWNlZCcsICdydWRlJywgJ3VuZnJpZW5kbHknLCAndW5oZWxwZnVsJywgJ3Nsb3cnLCAnZGVsYXllZCcsICdjYW5jZWxsZWQnLFxyXG4gICAgICAnYnJva2VuJywgJ2RhbWFnZWQnLCAndW5zYWZlJywgJ2Rhbmdlcm91cycsICdzY2FyeScsICd1bnNhdGlzZmFjdG9yeScsICdkaXNhcHBvaW50aW5nJyxcclxuICAgICAgLy8gSGluZGkgbmVnYXRpdmUgd29yZHNcclxuICAgICAgJ+CkrOClgeCksOCkvicsICfgpJfgpILgpKbgpL4nLCAn4KSW4KSw4KS+4KSsJywgJ+CkpuClgeCkluClgCcsICfgpKjgpL/gpLDgpL7gpLYnLCAn4KSt4KSv4KS+4KSo4KSVJywgJ+CkmOCkn+Ckv+Ckr+CkvicsICfgpKzgpYfgpJXgpL7gpLAnLCAn4KSu4KS54KSC4KSX4KS+J1xyXG4gICAgXVxyXG4gICAgXHJcbiAgICBjb25zdCB3b3JkcyA9IHRleHQudG9Mb3dlckNhc2UoKS5zcGxpdCgvXFxzKy8pXHJcbiAgICBsZXQgcG9zaXRpdmVDb3VudCA9IDBcclxuICAgIGxldCBuZWdhdGl2ZUNvdW50ID0gMFxyXG4gICAgXHJcbiAgICB3b3Jkcy5mb3JFYWNoKHdvcmQgPT4ge1xyXG4gICAgICBpZiAocG9zaXRpdmVXb3Jkcy5pbmNsdWRlcyh3b3JkKSkgcG9zaXRpdmVDb3VudCsrXHJcbiAgICAgIGlmIChuZWdhdGl2ZVdvcmRzLmluY2x1ZGVzKHdvcmQpKSBuZWdhdGl2ZUNvdW50KytcclxuICAgIH0pXHJcbiAgICBcclxuICAgIC8vIERldGVybWluZSB0ZXh0IHNlbnRpbWVudFxyXG4gICAgaWYgKHBvc2l0aXZlQ291bnQgPiBuZWdhdGl2ZUNvdW50KSB7XHJcbiAgICAgIHRleHRTZW50aW1lbnQgPSAncG9zaXRpdmUnXHJcbiAgICAgIHRleHRDb25maWRlbmNlID0gTWF0aC5taW4oMC44NSwgMC42ICsgKHBvc2l0aXZlQ291bnQgLSBuZWdhdGl2ZUNvdW50KSAqIDAuMSlcclxuICAgIH0gZWxzZSBpZiAobmVnYXRpdmVDb3VudCA+IHBvc2l0aXZlQ291bnQpIHtcclxuICAgICAgdGV4dFNlbnRpbWVudCA9ICduZWdhdGl2ZSdcclxuICAgICAgdGV4dENvbmZpZGVuY2UgPSBNYXRoLm1pbigwLjg1LCAwLjYgKyAobmVnYXRpdmVDb3VudCAtIHBvc2l0aXZlQ291bnQpICogMC4xKVxyXG4gICAgfSBlbHNlIGlmIChwb3NpdGl2ZUNvdW50ID09PSBuZWdhdGl2ZUNvdW50ICYmIHBvc2l0aXZlQ291bnQgPiAwKSB7XHJcbiAgICAgIHRleHRTZW50aW1lbnQgPSAnbmV1dHJhbCdcclxuICAgICAgdGV4dENvbmZpZGVuY2UgPSAwLjdcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coJ/Cfk50gVGV4dCBhbmFseXNpczonLCB7IHRleHRTZW50aW1lbnQsIHRleHRDb25maWRlbmNlLCBwb3NpdGl2ZUNvdW50LCBuZWdhdGl2ZUNvdW50IH0pXHJcbiAgfVxyXG4gIFxyXG4gIC8vIENvbWJpbmUgdGV4dCBhbmFseXNpcyB3aXRoIHJhdGluZ3MgdXNpbmcgd2VpZ2h0ZWQgYXBwcm9hY2hcclxuICBsZXQgZmluYWxTZW50aW1lbnQ6ICdwb3NpdGl2ZScgfCAnbmVnYXRpdmUnIHwgJ25ldXRyYWwnID0gJ25ldXRyYWwnXHJcbiAgbGV0IGZpbmFsQ29uZmlkZW5jZSA9IDAuNVxyXG4gIGxldCB1cmdlbmN5OiAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnIHwgJ2NyaXRpY2FsJyA9ICdsb3cnXHJcbiAgXHJcbiAgLy8gV2VpZ2h0IGRpc3RyaWJ1dGlvbjogVGV4dCAoNTAlKSwgU3RhcnMgKDMwJSksIEVtb2ppICgyMCUpXHJcbiAgbGV0IHRleHRXZWlnaHQgPSB0ZXh0ICYmIHRleHQudHJpbSgpLmxlbmd0aCA+IDAgPyAwLjUgOiAwXHJcbiAgbGV0IHN0YXJXZWlnaHQgPSAwLjMgKyAodGV4dFdlaWdodCA9PT0gMCA/IDAuNSA6IDApIC8vIEluY3JlYXNlIHN0YXIgd2VpZ2h0IGlmIG5vIHRleHRcclxuICBsZXQgZW1vamlXZWlnaHQgPSBlbW9qaVJhdGluZyA/IDAuMiA6IDBcclxuICBcclxuICAvLyBOb3JtYWxpemUgd2VpZ2h0c1xyXG4gIGxldCB0b3RhbFdlaWdodCA9IHRleHRXZWlnaHQgKyBzdGFyV2VpZ2h0ICsgZW1vamlXZWlnaHRcclxuICBpZiAodG90YWxXZWlnaHQgPiAwKSB7XHJcbiAgICB0ZXh0V2VpZ2h0ID0gdGV4dFdlaWdodCAvIHRvdGFsV2VpZ2h0XHJcbiAgICBzdGFyV2VpZ2h0ID0gc3RhcldlaWdodCAvIHRvdGFsV2VpZ2h0XHJcbiAgICBlbW9qaVdlaWdodCA9IGVtb2ppV2VpZ2h0IC8gdG90YWxXZWlnaHRcclxuICB9XHJcbiAgXHJcbiAgY29uc29sZS5sb2coJ+Kalu+4jyBBbmFseXNpcyB3ZWlnaHRzOicsIHsgdGV4dFdlaWdodCwgc3RhcldlaWdodCwgZW1vamlXZWlnaHQgfSlcclxuICBcclxuICAvLyBDYWxjdWxhdGUgc2VudGltZW50IHNjb3Jlc1xyXG4gIGxldCBwb3NpdGl2ZVNjb3JlID0gMFxyXG4gIGxldCBuZWdhdGl2ZVNjb3JlID0gMFxyXG4gIGxldCBuZXV0cmFsU2NvcmUgPSAwXHJcbiAgXHJcbiAgLy8gVGV4dCBjb250cmlidXRpb25cclxuICBpZiAodGV4dFNlbnRpbWVudCA9PT0gJ3Bvc2l0aXZlJykgcG9zaXRpdmVTY29yZSArPSB0ZXh0V2VpZ2h0ICogdGV4dENvbmZpZGVuY2VcclxuICBlbHNlIGlmICh0ZXh0U2VudGltZW50ID09PSAnbmVnYXRpdmUnKSBuZWdhdGl2ZVNjb3JlICs9IHRleHRXZWlnaHQgKiB0ZXh0Q29uZmlkZW5jZVxyXG4gIGVsc2UgbmV1dHJhbFNjb3JlICs9IHRleHRXZWlnaHQgKiAodGV4dENvbmZpZGVuY2UgfHwgMC41KVxyXG4gIFxyXG4gIC8vIFN0YXIgcmF0aW5nIGNvbnRyaWJ1dGlvblxyXG4gIGlmIChzdGFyUmF0aW5nID49IDQpIHBvc2l0aXZlU2NvcmUgKz0gc3RhcldlaWdodFxyXG4gIGVsc2UgaWYgKHN0YXJSYXRpbmcgPD0gMikgbmVnYXRpdmVTY29yZSArPSBzdGFyV2VpZ2h0XHJcbiAgZWxzZSBuZXV0cmFsU2NvcmUgKz0gc3RhcldlaWdodFxyXG4gIFxyXG4gIC8vIEVtb2ppIGNvbnRyaWJ1dGlvblxyXG4gIGlmIChlbW9qaVJhdGluZykge1xyXG4gICAgaWYgKGVtb2ppUmF0aW5nID09PSAn8J+YjScgfHwgZW1vamlSYXRpbmcgPT09ICfwn5iKJykgcG9zaXRpdmVTY29yZSArPSBlbW9qaVdlaWdodFxyXG4gICAgZWxzZSBpZiAoZW1vamlSYXRpbmcgPT09ICfwn5ieJyB8fCBlbW9qaVJhdGluZyA9PT0gJ/CfmKEnKSBuZWdhdGl2ZVNjb3JlICs9IGVtb2ppV2VpZ2h0XHJcbiAgICBlbHNlIG5ldXRyYWxTY29yZSArPSBlbW9qaVdlaWdodFxyXG4gIH1cclxuICBcclxuICAvLyBEZXRlcm1pbmUgZmluYWwgc2VudGltZW50XHJcbiAgaWYgKHBvc2l0aXZlU2NvcmUgPiBuZWdhdGl2ZVNjb3JlICYmIHBvc2l0aXZlU2NvcmUgPiBuZXV0cmFsU2NvcmUpIHtcclxuICAgIGZpbmFsU2VudGltZW50ID0gJ3Bvc2l0aXZlJ1xyXG4gICAgZmluYWxDb25maWRlbmNlID0gTWF0aC5taW4oMC45LCAwLjYgKyBwb3NpdGl2ZVNjb3JlICogMC40KVxyXG4gICAgdXJnZW5jeSA9ICdsb3cnXHJcbiAgfSBlbHNlIGlmIChuZWdhdGl2ZVNjb3JlID4gcG9zaXRpdmVTY29yZSAmJiBuZWdhdGl2ZVNjb3JlID4gbmV1dHJhbFNjb3JlKSB7XHJcbiAgICBmaW5hbFNlbnRpbWVudCA9ICduZWdhdGl2ZSdcclxuICAgIGZpbmFsQ29uZmlkZW5jZSA9IE1hdGgubWluKDAuOSwgMC42ICsgbmVnYXRpdmVTY29yZSAqIDAuNClcclxuICAgIHVyZ2VuY3kgPSBzdGFyUmF0aW5nIDw9IDIgPyAoc3RhclJhdGluZyA9PT0gMSA/ICdoaWdoJyA6ICdtZWRpdW0nKSA6ICdtZWRpdW0nXHJcbiAgICBpZiAoZW1vamlSYXRpbmcgPT09ICfwn5ihJykgdXJnZW5jeSA9ICdoaWdoJ1xyXG4gIH0gZWxzZSB7XHJcbiAgICBmaW5hbFNlbnRpbWVudCA9ICduZXV0cmFsJ1xyXG4gICAgZmluYWxDb25maWRlbmNlID0gTWF0aC5taW4oMC44LCAwLjYgKyBuZXV0cmFsU2NvcmUgKiAwLjMpXHJcbiAgICB1cmdlbmN5ID0gJ2xvdydcclxuICB9XHJcbiAgXHJcbiAgLy8gRXh0cmFjdCBrZXl3b3JkcyBhbmQgY2F0ZWdvcmllc1xyXG4gIGNvbnN0IGtleXdvcmRzOiBzdHJpbmdbXSA9IFtdXHJcbiAgY29uc3QgY2F0ZWdvcmllczogc3RyaW5nW10gPSBbXVxyXG4gIGNvbnN0IGFjdGlvbmFibGVJbnNpZ2h0czogc3RyaW5nW10gPSBbXVxyXG5cclxuICBpZiAodGV4dCkge1xyXG4gICAgY29uc3QgbG93ZXJjYXNlVGV4dCA9IHRleHQudG9Mb3dlckNhc2UoKVxyXG4gICAgXHJcbiAgICAvLyBFeHRyYWN0IG1lYW5pbmdmdWwga2V5d29yZHNcclxuICAgIGNvbnN0IHdvcmRzID0gdGV4dC5zcGxpdCgvXFxzKy8pLmZpbHRlcih3b3JkID0+IHdvcmQubGVuZ3RoID4gMyAmJiAhWyd0aGlzJywgJ3RoYXQnLCAnd2l0aCcsICdoYXZlJywgJ2JlZW4nLCAnd2VyZScsICd0aGV5JywgJ3RoZXJlJ10uaW5jbHVkZXMod29yZC50b0xvd2VyQ2FzZSgpKSlcclxuICAgIGtleXdvcmRzLnB1c2goLi4ud29yZHMuc2xpY2UoMCwgNSkpXHJcblxyXG4gICAgLy8gQ2F0ZWdvcml6ZSBiYXNlZCBvbiBjb250ZW50XHJcbiAgICBpZiAobG93ZXJjYXNlVGV4dC5pbmNsdWRlcygncm9vbScpIHx8IGxvd2VyY2FzZVRleHQuaW5jbHVkZXMoJ3N0YXknKSB8fCBsb3dlcmNhc2VUZXh0LmluY2x1ZGVzKCdob3RlbCcpIHx8IGxvd2VyY2FzZVRleHQuaW5jbHVkZXMoJ2FjY29tbW9kYXRpb24nKSkgY2F0ZWdvcmllcy5wdXNoKCdhY2NvbW1vZGF0aW9uJylcclxuICAgIGlmIChsb3dlcmNhc2VUZXh0LmluY2x1ZGVzKCdmb29kJykgfHwgbG93ZXJjYXNlVGV4dC5pbmNsdWRlcygnbWVhbCcpIHx8IGxvd2VyY2FzZVRleHQuaW5jbHVkZXMoJ3Jlc3RhdXJhbnQnKSB8fCBsb3dlcmNhc2VUZXh0LmluY2x1ZGVzKCdlYXQnKSkgY2F0ZWdvcmllcy5wdXNoKCdmb29kJylcclxuICAgIGlmIChsb3dlcmNhc2VUZXh0LmluY2x1ZGVzKCdzdGFmZicpIHx8IGxvd2VyY2FzZVRleHQuaW5jbHVkZXMoJ3NlcnZpY2UnKSB8fCBsb3dlcmNhc2VUZXh0LmluY2x1ZGVzKCdoZWxwJykgfHwgbG93ZXJjYXNlVGV4dC5pbmNsdWRlcygnc3VwcG9ydCcpKSBjYXRlZ29yaWVzLnB1c2goJ3NlcnZpY2UgcXVhbGl0eScpXHJcbiAgICBpZiAobG93ZXJjYXNlVGV4dC5pbmNsdWRlcygnY2xlYW4nKSB8fCBsb3dlcmNhc2VUZXh0LmluY2x1ZGVzKCdkaXJ0eScpIHx8IGxvd2VyY2FzZVRleHQuaW5jbHVkZXMoJ2h5Z2llbmUnKSB8fCBsb3dlcmNhc2VUZXh0LmluY2x1ZGVzKCdtYWludGVuYW5jZScpKSBjYXRlZ29yaWVzLnB1c2goJ2NsZWFubGluZXNzJylcclxuICAgIGlmIChsb3dlcmNhc2VUZXh0LmluY2x1ZGVzKCdwcmljZScpIHx8IGxvd2VyY2FzZVRleHQuaW5jbHVkZXMoJ2Nvc3QnKSB8fCBsb3dlcmNhc2VUZXh0LmluY2x1ZGVzKCdleHBlbnNpdmUnKSB8fCBsb3dlcmNhc2VUZXh0LmluY2x1ZGVzKCdjaGVhcCcpIHx8IGxvd2VyY2FzZVRleHQuaW5jbHVkZXMoJ21vbmV5JykpIGNhdGVnb3JpZXMucHVzaCgncHJpY2luZycpXHJcbiAgICBpZiAobG93ZXJjYXNlVGV4dC5pbmNsdWRlcygnbG9jYXRpb24nKSB8fCBsb3dlcmNhc2VUZXh0LmluY2x1ZGVzKCdwbGFjZScpIHx8IGxvd2VyY2FzZVRleHQuaW5jbHVkZXMoJ2FyZWEnKSB8fCBsb3dlcmNhc2VUZXh0LmluY2x1ZGVzKCdkZXN0aW5hdGlvbicpKSBjYXRlZ29yaWVzLnB1c2goJ2xvY2F0aW9uJylcclxuXHJcbiAgICAvLyBHZW5lcmF0ZSBhY3Rpb25hYmxlIGluc2lnaHRzIGJhc2VkIG9uIHNlbnRpbWVudCBhbmQgY29udGVudFxyXG4gICAgaWYgKGZpbmFsU2VudGltZW50ID09PSAnbmVnYXRpdmUnKSB7XHJcbiAgICAgIGFjdGlvbmFibGVJbnNpZ2h0cy5wdXNoKCdJbW1lZGlhdGUgYXR0ZW50aW9uIHJlcXVpcmVkIGZvciBjdXN0b21lciBzYXRpc2ZhY3Rpb24nKVxyXG4gICAgICBpZiAoc3RhclJhdGluZyA9PT0gMSkgYWN0aW9uYWJsZUluc2lnaHRzLnB1c2goJ0NyaXRpY2FsIHNlcnZpY2UgaW1wcm92ZW1lbnQgbmVlZGVkJylcclxuICAgICAgaWYgKGNhdGVnb3JpZXMuaW5jbHVkZXMoJ2NsZWFubGluZXNzJykpIGFjdGlvbmFibGVJbnNpZ2h0cy5wdXNoKCdGb2N1cyBvbiBoeWdpZW5lIGFuZCBjbGVhbmxpbmVzcyBzdGFuZGFyZHMnKVxyXG4gICAgICBpZiAoY2F0ZWdvcmllcy5pbmNsdWRlcygnc2VydmljZSBxdWFsaXR5JykpIGFjdGlvbmFibGVJbnNpZ2h0cy5wdXNoKCdTdGFmZiB0cmFpbmluZyBhbmQgY3VzdG9tZXIgc2VydmljZSBpbXByb3ZlbWVudCByZXF1aXJlZCcpXHJcbiAgICAgIGlmIChjYXRlZ29yaWVzLmluY2x1ZGVzKCdwcmljaW5nJykpIGFjdGlvbmFibGVJbnNpZ2h0cy5wdXNoKCdSZXZpZXcgcHJpY2luZyBzdHJhdGVneSBhbmQgdmFsdWUgcHJvcG9zaXRpb24nKVxyXG4gICAgfSBlbHNlIGlmIChmaW5hbFNlbnRpbWVudCA9PT0gJ3Bvc2l0aXZlJykge1xyXG4gICAgICBhY3Rpb25hYmxlSW5zaWdodHMucHVzaCgnTGV2ZXJhZ2UgcG9zaXRpdmUgZmVlZGJhY2sgZm9yIG1hcmtldGluZyBhbmQgdGVzdGltb25pYWxzJylcclxuICAgICAgaWYgKGNhdGVnb3JpZXMuaW5jbHVkZXMoJ3NlcnZpY2UgcXVhbGl0eScpKSBhY3Rpb25hYmxlSW5zaWdodHMucHVzaCgnUmVjb2duaXplIGFuZCByZXdhcmQgZXhjZWxsZW50IHN0YWZmIHBlcmZvcm1hbmNlJylcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGNvbnNvbGUubG9nKGDinIUgRW5oYW5jZWQgZmFsbGJhY2sgYW5hbHlzaXM6ICR7ZmluYWxTZW50aW1lbnR9ICgke2ZpbmFsQ29uZmlkZW5jZS50b0ZpeGVkKDIpfSBjb25maWRlbmNlKSAtIFNjb3JlczogUDoke3Bvc2l0aXZlU2NvcmUudG9GaXhlZCgyKX0gTjoke25lZ2F0aXZlU2NvcmUudG9GaXhlZCgyKX0gTmV1OiR7bmV1dHJhbFNjb3JlLnRvRml4ZWQoMil9YClcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIHNlbnRpbWVudDogZmluYWxTZW50aW1lbnQsXHJcbiAgICBjb25maWRlbmNlOiBmaW5hbENvbmZpZGVuY2UsXHJcbiAgICBlbW90aW9uczoge1xyXG4gICAgICBqb3k6IGZpbmFsU2VudGltZW50ID09PSAncG9zaXRpdmUnID8gZmluYWxDb25maWRlbmNlICogMC44IDogMC4xLFxyXG4gICAgICBhbmdlcjogZmluYWxTZW50aW1lbnQgPT09ICduZWdhdGl2ZScgPyBmaW5hbENvbmZpZGVuY2UgKiAwLjcgOiAwLjEsXHJcbiAgICAgIHNhZG5lc3M6IGZpbmFsU2VudGltZW50ID09PSAnbmVnYXRpdmUnID8gZmluYWxDb25maWRlbmNlICogMC41IDogMC4xLFxyXG4gICAgICBzdXJwcmlzZTogMC4yLFxyXG4gICAgICBmZWFyOiB1cmdlbmN5ID09PSAnaGlnaCcgPyAwLjYgOiAwLjEsXHJcbiAgICAgIGRpc2d1c3Q6IGZpbmFsU2VudGltZW50ID09PSAnbmVnYXRpdmUnID8gZmluYWxDb25maWRlbmNlICogMC40IDogMC4xXHJcbiAgICB9LFxyXG4gICAga2V5d29yZHMsXHJcbiAgICBsYW5ndWFnZTogbGFuZ3VhZ2UgfHwgJ2VuJyxcclxuICAgIHRveGljaXR5OiB1cmdlbmN5ID09PSAnaGlnaCcgPyAwLjYgOiAwLFxyXG4gICAgdXJnZW5jeSxcclxuICAgIGNhdGVnb3JpZXMsXHJcbiAgICBhY3Rpb25hYmxlSW5zaWdodHNcclxuICB9XHJcbn1cclxuXHJcbi8vIEVuaGFuY2VkIGZlZWRiYWNrIGRhdGFiYXNlIHdpdGggQUkgYW5hbHlzaXNcclxubGV0IGZlZWRiYWNrczogRW5oYW5jZWRGZWVkYmFja1tdID0gW11cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgeyBzZWFyY2hQYXJhbXMgfSA9IG5ldyBVUkwocmVxdWVzdC51cmwpXHJcbiAgICBjb25zdCBsb2NhdGlvbiA9IHNlYXJjaFBhcmFtcy5nZXQoJ2xvY2F0aW9uJylcclxuICAgIGNvbnN0IGNhdGVnb3J5ID0gc2VhcmNoUGFyYW1zLmdldCgnY2F0ZWdvcnknKVxyXG4gICAgY29uc3Qgc2VudGltZW50ID0gc2VhcmNoUGFyYW1zLmdldCgnc2VudGltZW50JylcclxuICAgIGNvbnN0IGZsYWdnZWQgPSBzZWFyY2hQYXJhbXMuZ2V0KCdmbGFnZ2VkJylcclxuICAgIGNvbnN0IGxpbWl0ID0gcGFyc2VJbnQoc2VhcmNoUGFyYW1zLmdldCgnbGltaXQnKSB8fCAnNTAnKVxyXG4gICAgY29uc3Qgb2Zmc2V0ID0gcGFyc2VJbnQoc2VhcmNoUGFyYW1zLmdldCgnb2Zmc2V0JykgfHwgJzAnKVxyXG5cclxuICAgIGxldCBmaWx0ZXJlZEZlZWRiYWNrcyA9IFsuLi5mZWVkYmFja3NdXHJcblxyXG4gICAgaWYgKGxvY2F0aW9uICYmIGxvY2F0aW9uICE9PSAnQWxsJykge1xyXG4gICAgICBmaWx0ZXJlZEZlZWRiYWNrcyA9IGZpbHRlcmVkRmVlZGJhY2tzLmZpbHRlcihmID0+IGYubG9jYXRpb24gPT09IGxvY2F0aW9uKVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChjYXRlZ29yeSAmJiBjYXRlZ29yeSAhPT0gJ0FsbCcpIHtcclxuICAgICAgZmlsdGVyZWRGZWVkYmFja3MgPSBmaWx0ZXJlZEZlZWRiYWNrcy5maWx0ZXIoZiA9PiBmLmNhdGVnb3J5ID09PSBjYXRlZ29yeSlcclxuICAgIH1cclxuXHJcbiAgICBpZiAoc2VudGltZW50ICYmIHNlbnRpbWVudCAhPT0gJ0FsbCcpIHtcclxuICAgICAgZmlsdGVyZWRGZWVkYmFja3MgPSBmaWx0ZXJlZEZlZWRiYWNrcy5maWx0ZXIoZiA9PiBmLmFpQW5hbHlzaXMuc2VudGltZW50ID09PSBzZW50aW1lbnQpXHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGZsYWdnZWQgPT09ICd0cnVlJykge1xyXG4gICAgICBmaWx0ZXJlZEZlZWRiYWNrcyA9IGZpbHRlcmVkRmVlZGJhY2tzLmZpbHRlcihmID0+IGYuZmxhZ2dlZClcclxuICAgIH1cclxuXHJcbiAgICAvLyBTb3J0IGJ5IHRpbWVzdGFtcCAobmV3ZXN0IGZpcnN0KVxyXG4gICAgZmlsdGVyZWRGZWVkYmFja3Muc29ydCgoYSwgYikgPT4gbmV3IERhdGUoYi50aW1lc3RhbXApLmdldFRpbWUoKSAtIG5ldyBEYXRlKGEudGltZXN0YW1wKS5nZXRUaW1lKCkpXHJcblxyXG4gICAgY29uc3QgcGFnaW5hdGVkRmVlZGJhY2tzID0gZmlsdGVyZWRGZWVkYmFja3Muc2xpY2Uob2Zmc2V0LCBvZmZzZXQgKyBsaW1pdClcclxuXHJcbiAgICAvLyBDYWxjdWxhdGUgc2VudGltZW50IHN0YXRpc3RpY3MgKHNpbXBsaWZpZWQgLSBubyB1cmdlbmN5IGxldmVscylcclxuICAgIGNvbnN0IHNlbnRpbWVudFN0YXRzID0ge1xyXG4gICAgICBwb3NpdGl2ZTogZmlsdGVyZWRGZWVkYmFja3MuZmlsdGVyKGYgPT4gZi5haUFuYWx5c2lzLnNlbnRpbWVudCA9PT0gJ3Bvc2l0aXZlJykubGVuZ3RoLFxyXG4gICAgICBuZWdhdGl2ZTogZmlsdGVyZWRGZWVkYmFja3MuZmlsdGVyKGYgPT4gZi5haUFuYWx5c2lzLnNlbnRpbWVudCA9PT0gJ25lZ2F0aXZlJykubGVuZ3RoLFxyXG4gICAgICBuZXV0cmFsOiBmaWx0ZXJlZEZlZWRiYWNrcy5maWx0ZXIoZiA9PiBmLmFpQW5hbHlzaXMuc2VudGltZW50ID09PSAnbmV1dHJhbCcpLmxlbmd0aCxcclxuICAgICAgdG90YWw6IGZpbHRlcmVkRmVlZGJhY2tzLmxlbmd0aFxyXG4gICAgfVxyXG5cclxuICAgIC8vIEdldCBzZW50aW1lbnQgdHJlbmRzXHJcbiAgICBjb25zdCBzZW50aW1lbnRUcmVuZHMgPSBTZW50aW1lbnRNb25pdG9yLmdldFNlbnRpbWVudFRyZW5kcyhsb2NhdGlvbiB8fCB1bmRlZmluZWQsIGNhdGVnb3J5IHx8IHVuZGVmaW5lZClcclxuXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xyXG4gICAgICBmZWVkYmFja3M6IHBhZ2luYXRlZEZlZWRiYWNrcyxcclxuICAgICAgdG90YWw6IGZpbHRlcmVkRmVlZGJhY2tzLmxlbmd0aCxcclxuICAgICAgc2VudGltZW50U3RhdHMsXHJcbiAgICAgIHNlbnRpbWVudFRyZW5kcyxcclxuICAgICAgaGFzTW9yZTogb2Zmc2V0ICsgbGltaXQgPCBmaWx0ZXJlZEZlZWRiYWNrcy5sZW5ndGhcclxuICAgIH0pXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnRmFpbGVkIHRvIGZldGNoIGZlZWRiYWNrJyB9LCB7IHN0YXR1czogNTAwIH0pXHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKClcclxuICAgIGNvbnN0IHsgdXNlcklkLCB1c2VyTmFtZSwgbG9jYXRpb24sIGNhdGVnb3J5LCByYXRpbmcsIHRleHRGZWVkYmFjaywgbGFuZ3VhZ2UgPSAnYXV0bycsIHZvaWNlRGF0YSwgaW1hZ2VEYXRhLCBlbW9qaVJhdGluZyB9ID0gYm9keVxyXG5cclxuICAgIC8vIEVuaGFuY2VkIEFJIGFuYWx5c2lzIHdpdGggc3RhciByYXRpbmcgYW5kIGVtb2ppIGludGVncmF0aW9uXHJcbiAgICBsZXQgYWlBbmFseXNpczogQUlBbmFseXNpc1Jlc3VsdFxyXG4gICAgbGV0IHZvaWNlQW5hbHlzaXM6IFZvaWNlQW5hbHlzaXNSZXN1bHQgfCB1bmRlZmluZWRcclxuICAgIGxldCBpbWFnZUFuYWx5c2lzOiBJbWFnZUFuYWx5c2lzUmVzdWx0IHwgdW5kZWZpbmVkXHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gQ29udmVydCBiYXNlNjQgZGF0YSB0byBibG9icyBpZiBwcm92aWRlZFxyXG4gICAgICBjb25zdCB2b2ljZUJsb2IgPSB2b2ljZURhdGEgPyBuZXcgQmxvYihbQnVmZmVyLmZyb20odm9pY2VEYXRhLCAnYmFzZTY0JyldLCB7IHR5cGU6ICdhdWRpby93YXYnIH0pIDogdW5kZWZpbmVkXHJcbiAgICAgIGNvbnN0IGltYWdlQmxvYiA9IGltYWdlRGF0YSA/IG5ldyBCbG9iKFtCdWZmZXIuZnJvbShpbWFnZURhdGEsICdiYXNlNjQnKV0sIHsgdHlwZTogJ2ltYWdlL2pwZWcnIH0pIDogdW5kZWZpbmVkXHJcblxyXG4gICAgICBjb25zdCBhbmFseXNpc1Jlc3VsdHMgPSBhd2FpdCBhbmFseXplQWR2YW5jZWRGZWVkYmFjayh0ZXh0RmVlZGJhY2ssIHZvaWNlQmxvYiwgaW1hZ2VCbG9iLCBsYW5ndWFnZSlcclxuICAgICAgYWlBbmFseXNpcyA9IGFuYWx5c2lzUmVzdWx0cy5haUFuYWx5c2lzIVxyXG4gICAgICB2b2ljZUFuYWx5c2lzID0gYW5hbHlzaXNSZXN1bHRzLnZvaWNlQW5hbHlzaXNcclxuICAgICAgaW1hZ2VBbmFseXNpcyA9IGFuYWx5c2lzUmVzdWx0cy5pbWFnZUFuYWx5c2lzXHJcblxyXG4gICAgICAvLyBFbmhhbmNlIGFuYWx5c2lzIHdpdGggc3RhciByYXRpbmcgYW5kIGVtb2ppIGRhdGFcclxuICAgICAgYWlBbmFseXNpcyA9IGVuaGFuY2VBbmFseXNpc1dpdGhSYXRpbmdzKGFpQW5hbHlzaXMsIHJhdGluZywgZW1vamlSYXRpbmcpXHJcbiAgICAgIFxyXG4gICAgICBjb25zb2xlLmxvZygn4pyFIEVuaGFuY2VkIEFJIGFuYWx5c2lzIGNvbXBsZXRlOicsIHtcclxuICAgICAgICBzZW50aW1lbnQ6IGFpQW5hbHlzaXMuc2VudGltZW50LFxyXG4gICAgICAgIGNvbmZpZGVuY2U6IGFpQW5hbHlzaXMuY29uZmlkZW5jZSxcclxuICAgICAgICB1cmdlbmN5OiBhaUFuYWx5c2lzLnVyZ2VuY3ksXHJcbiAgICAgICAgc3RhclJhdGluZzogcmF0aW5nLFxyXG4gICAgICAgIGVtb2ppOiBlbW9qaVJhdGluZ1xyXG4gICAgICB9KVxyXG4gICAgICBcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0FJIGFuYWx5c2lzIGZhaWxlZCwgdXNpbmcgZW5oYW5jZWQgZmFsbGJhY2s6JywgZXJyb3IpXHJcbiAgICAgIC8vIEVuaGFuY2VkIGZhbGxiYWNrIGFuYWx5c2lzIHdpdGggc3RhciByYXRpbmcgYW5kIGVtb2ppXHJcbiAgICAgIGFpQW5hbHlzaXMgPSBjcmVhdGVGYWxsYmFja0FuYWx5c2lzKHRleHRGZWVkYmFjayB8fCAnJywgcmF0aW5nLCBlbW9qaVJhdGluZywgbGFuZ3VhZ2UpXHJcbiAgICB9XHJcblxyXG4gICAgLy8gRGV0ZXJtaW5lIHVyZ2VuY3kgbGV2ZWxcclxuICAgIGNvbnN0IHVyZ2VuY3lMZXZlbCA9IGFpQW5hbHlzaXMudXJnZW5jeSB8fCAnbG93J1xyXG5cclxuICAgIC8vIENoZWNrIGZvciBmbGFnZ2luZyBjb25kaXRpb25zXHJcbiAgICBjb25zdCBmbGFnZ2VkID0gKGFpQW5hbHlzaXMuc2VudGltZW50ID09PSAnbmVnYXRpdmUnICYmIGFpQW5hbHlzaXMuY29uZmlkZW5jZSA+IDAuNykgfHxcclxuICAgICAgICAgICAgICAgICAgIChhaUFuYWx5c2lzLnRveGljaXR5ICYmIGFpQW5hbHlzaXMudG94aWNpdHkgPiAwLjUpIHx8XHJcbiAgICAgICAgICAgICAgICAgICB1cmdlbmN5TGV2ZWwgPT09ICdjcml0aWNhbCcgfHwgdXJnZW5jeUxldmVsID09PSAnaGlnaCdcclxuXHJcbiAgICBjb25zdCBuZXdGZWVkYmFjazogRW5oYW5jZWRGZWVkYmFjayA9IHtcclxuICAgICAgaWQ6IGZlZWRiYWNrcy5sZW5ndGggKyAxLFxyXG4gICAgICB1c2VySWQsXHJcbiAgICAgIHVzZXJOYW1lLFxyXG4gICAgICBsb2NhdGlvbixcclxuICAgICAgY2F0ZWdvcnksXHJcbiAgICAgIHJhdGluZyxcclxuICAgICAgdGV4dEZlZWRiYWNrLFxyXG4gICAgICBsYW5ndWFnZTogYWlBbmFseXNpcy5sYW5ndWFnZSxcclxuICAgICAgdm9pY2VEYXRhLFxyXG4gICAgICBpbWFnZURhdGEsXHJcbiAgICAgIGVtb2ppUmF0aW5nLFxyXG4gICAgICBhaUFuYWx5c2lzLFxyXG4gICAgICB2b2ljZUFuYWx5c2lzLFxyXG4gICAgICBpbWFnZUFuYWx5c2lzLFxyXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgaXNWZXJpZmllZDogZmFsc2UsXHJcbiAgICAgIHJlc3BvbnNlRnJvbVZlbmRvcjogdW5kZWZpbmVkLFxyXG4gICAgICBmbGFnZ2VkLFxyXG4gICAgICB1cmdlbmN5TGV2ZWxcclxuICAgIH1cclxuXHJcbiAgICAvLyBHZW5lcmF0ZSBhdXRvLXJlc3BvbnNlIHVzaW5nIEFJIGNoYXRib3RcclxuICAgIHRyeSB7XHJcbiAgICAgIG5ld0ZlZWRiYWNrLmF1dG9SZXNwb25zZUdlbmVyYXRlZCA9IGF3YWl0IEZlZWRiYWNrQ2hhdGJvdC5nZW5lcmF0ZVJlc3BvbnNlKG5ld0ZlZWRiYWNrKVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignQXV0by1yZXNwb25zZSBnZW5lcmF0aW9uIGZhaWxlZDonLCBlcnJvcilcclxuICAgIH1cclxuXHJcbiAgICBmZWVkYmFja3MucHVzaChuZXdGZWVkYmFjaylcclxuXHJcbiAgICAvLyBBZGQgdG8gc2VudGltZW50IG1vbml0b3JpbmdcclxuICAgIFNlbnRpbWVudE1vbml0b3IuYWRkU2VudGltZW50KG5ld0ZlZWRiYWNrKVxyXG5cclxuICAgIC8vIFRyaWdnZXIgYWxlcnRzIGZvciBjcml0aWNhbCBpc3N1ZXNcclxuICAgIGF3YWl0IEFsZXJ0U3lzdGVtLnRyaWdnZXJBbGVydChuZXdGZWVkYmFjaylcclxuXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xyXG4gICAgICAuLi5uZXdGZWVkYmFjayxcclxuICAgICAgZm9sbG93VXBRdWVzdGlvbnM6IGF3YWl0IEZlZWRiYWNrQ2hhdGJvdC5nZW5lcmF0ZUZvbGxvd1VwUXVlc3Rpb25zKG5ld0ZlZWRiYWNrKVxyXG4gICAgfSwgeyBzdGF0dXM6IDIwMSB9KVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc3VibWl0IGZlZWRiYWNrOicsIGVycm9yKVxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdGYWlsZWQgdG8gc3VibWl0IGZlZWRiYWNrJyB9LCB7IHN0YXR1czogNTAwIH0pXHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUFVUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKVxyXG4gICAgY29uc3QgeyBmZWVkYmFja0lkLCByZXNwb25zZUZyb21WZW5kb3IsIGZsYWdnZWQgfSA9IGJvZHlcclxuXHJcbiAgICBjb25zdCBmZWVkYmFja0luZGV4ID0gZmVlZGJhY2tzLmZpbmRJbmRleChmID0+IGYuaWQgPT09IGZlZWRiYWNrSWQpXHJcbiAgICBpZiAoZmVlZGJhY2tJbmRleCA9PT0gLTEpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdGZWVkYmFjayBub3QgZm91bmQnIH0sIHsgc3RhdHVzOiA0MDQgfSlcclxuICAgIH1cclxuXHJcbiAgICBmZWVkYmFja3NbZmVlZGJhY2tJbmRleF0gPSB7XHJcbiAgICAgIC4uLmZlZWRiYWNrc1tmZWVkYmFja0luZGV4XSxcclxuICAgICAgLi4uKHJlc3BvbnNlRnJvbVZlbmRvciAmJiB7IHJlc3BvbnNlRnJvbVZlbmRvciB9KSxcclxuICAgICAgLi4uKHR5cGVvZiBmbGFnZ2VkID09PSAnYm9vbGVhbicgJiYgeyBmbGFnZ2VkIH0pLFxyXG4gICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihmZWVkYmFja3NbZmVlZGJhY2tJbmRleF0pXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnRmFpbGVkIHRvIHVwZGF0ZSBmZWVkYmFjaycgfSwgeyBzdGF0dXM6IDUwMCB9KVxyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiYWlTZXJ2aWNlIiwiQWxlcnRTeXN0ZW0iLCJ0cmlnZ2VyQWxlcnQiLCJmZWVkYmFjayIsInVyZ2VuY3lMZXZlbCIsImNvbnNvbGUiLCJsb2ciLCJsb2NhdGlvbiIsImNhdGVnb3J5IiwiYWlBbmFseXNpcyIsImFjdGlvbmFibGVJbnNpZ2h0cyIsImpvaW4iLCJhdXRvUmVzcG9uc2VHZW5lcmF0ZWQiLCJnZW5lcmF0ZUF1dG9SZXNwb25zZSIsImVzY2FsYXRlZCIsImluc2lnaHRzIiwic29tZSIsImkiLCJpbmNsdWRlcyIsInNlbnRpbWVudCIsImNvbmZpZGVuY2UiLCJhbmFseXplQWR2YW5jZWRGZWVkYmFjayIsInRleHRGZWVkYmFjayIsInZvaWNlQmxvYiIsImltYWdlQmxvYiIsImxhbmd1YWdlIiwicmVzdWx0cyIsImFuYWx5emVUZXh0Iiwidm9pY2VBbmFseXNpcyIsImFuYWx5emVWb2ljZSIsInRyYW5zY3JpcHRpb24iLCJpbWFnZUFuYWx5c2lzIiwiYW5hbHl6ZUltYWdlIiwiZXJyb3IiLCJTZW50aW1lbnRNb25pdG9yIiwic2VudGltZW50SGlzdG9yeSIsImFkZFNlbnRpbWVudCIsInB1c2giLCJ0aW1lc3RhbXAiLCJsZW5ndGgiLCJzbGljZSIsImNoZWNrU2VudGltZW50VHJlbmRzIiwicmVjZW50RmVlZGJhY2tzIiwiZmlsdGVyIiwicyIsIm5lZ2F0aXZlRmVlZGJhY2tzIiwiZ2V0U2VudGltZW50VHJlbmRzIiwiZmlsdGVyZWQiLCJGZWVkYmFja0NoYXRib3QiLCJnZW5lcmF0ZVJlc3BvbnNlIiwidXJnZW5jeSIsImNhdGVnb3JpZXMiLCJrZXl3b3JkcyIsImlzc3VlcyIsInRvTG93ZXJDYXNlIiwiZ2VuZXJhdGVGb2xsb3dVcFF1ZXN0aW9ucyIsInF1ZXN0aW9ucyIsImZhbGxiYWNrU2VudGltZW50QW5hbHlzaXMiLCJ0ZXh0IiwicG9zaXRpdmVXb3JkcyIsIm5lZ2F0aXZlV29yZHMiLCJoaW5kaVBvc2l0aXZlIiwiaGluZGlOZWdhdGl2ZSIsIndvcmRzIiwic3BsaXQiLCJwb3NpdGl2ZUNvdW50IiwibmVnYXRpdmVDb3VudCIsImZvckVhY2giLCJ3b3JkIiwiTWF0aCIsIm1pbiIsImVtb3Rpb25zIiwiam95IiwiYW5nZXIiLCJzYWRuZXNzIiwic3VycHJpc2UiLCJmZWFyIiwiZGlzZ3VzdCIsImVuaGFuY2VBbmFseXNpc1dpdGhSYXRpbmdzIiwic3RhclJhdGluZyIsImVtb2ppUmF0aW5nIiwiZW5oYW5jZWRTZW50aW1lbnQiLCJlbmhhbmNlZENvbmZpZGVuY2UiLCJlbmhhbmNlZFVyZ2VuY3kiLCJlbW9qaVNlbnRpbWVudE1hcCIsImVtb2ppRGF0YSIsIm1heCIsInRleHRXZWlnaHQiLCJzdGFyV2VpZ2h0IiwiZW1vamlXZWlnaHQiLCJ0b3RhbFdlaWdodCIsInBvc2l0aXZlU2NvcmUiLCJuZWdhdGl2ZVNjb3JlIiwibmV1dHJhbFNjb3JlIiwiY3JlYXRlRmFsbGJhY2tBbmFseXNpcyIsInN1YnN0cmluZyIsInRleHRTZW50aW1lbnQiLCJ0ZXh0Q29uZmlkZW5jZSIsInRyaW0iLCJmaW5hbFNlbnRpbWVudCIsImZpbmFsQ29uZmlkZW5jZSIsImxvd2VyY2FzZVRleHQiLCJ0b0ZpeGVkIiwidG94aWNpdHkiLCJmZWVkYmFja3MiLCJHRVQiLCJyZXF1ZXN0Iiwic2VhcmNoUGFyYW1zIiwiVVJMIiwidXJsIiwiZ2V0IiwiZmxhZ2dlZCIsImxpbWl0IiwicGFyc2VJbnQiLCJvZmZzZXQiLCJmaWx0ZXJlZEZlZWRiYWNrcyIsImYiLCJzb3J0IiwiYSIsImIiLCJEYXRlIiwiZ2V0VGltZSIsInBhZ2luYXRlZEZlZWRiYWNrcyIsInNlbnRpbWVudFN0YXRzIiwicG9zaXRpdmUiLCJuZWdhdGl2ZSIsIm5ldXRyYWwiLCJ0b3RhbCIsInNlbnRpbWVudFRyZW5kcyIsInVuZGVmaW5lZCIsImpzb24iLCJoYXNNb3JlIiwic3RhdHVzIiwiUE9TVCIsImJvZHkiLCJ1c2VySWQiLCJ1c2VyTmFtZSIsInJhdGluZyIsInZvaWNlRGF0YSIsImltYWdlRGF0YSIsIkJsb2IiLCJCdWZmZXIiLCJmcm9tIiwidHlwZSIsImFuYWx5c2lzUmVzdWx0cyIsImVtb2ppIiwibmV3RmVlZGJhY2siLCJpZCIsInRvSVNPU3RyaW5nIiwiaXNWZXJpZmllZCIsInJlc3BvbnNlRnJvbVZlbmRvciIsImZvbGxvd1VwUXVlc3Rpb25zIiwiUFVUIiwiZmVlZGJhY2tJZCIsImZlZWRiYWNrSW5kZXgiLCJmaW5kSW5kZXgiLCJ1cGRhdGVkQXQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/feedback/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/ai-services.ts":
/*!****************************!*\
  !*** ./lib/ai-services.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AdvancedAIService: () => (/* binding */ AdvancedAIService),\n/* harmony export */   aiService: () => (/* binding */ aiService)\n/* harmony export */ });\n// Advanced AI Services for Tourism Jharkhand\n// Integrates multiple AI APIs for comprehensive analysis\n// Advanced multilingual sentiment analysis with multiple AI models\nclass AdvancedAIService {\n    constructor(){\n        this.huggingFaceKey = process.env.HUGGINGFACE_API_KEY || \"\";\n        this.openAIKey = process.env.OPENAI_API_KEY;\n        this.googleCloudKey = process.env.GOOGLE_CLOUD_API_KEY;\n        this.groqApiKey = process.env.GROQ_API_KEY || \"\";\n        this.isGroqAvailable = this.validateGroqKey();\n        if (this.isGroqAvailable) {\n            console.log(\"âœ… Groq API available for sentiment analysis\");\n        } else {\n            console.warn(\"âš ï¸ Groq API key not found. Using enhanced fallback analysis.\");\n        }\n    }\n    validateGroqKey() {\n        return !!(this.groqApiKey && this.groqApiKey.length > 10 && this.groqApiKey !== \"your_groq_api_key_here\");\n    }\n    // Enhanced text analysis with Groq API first, then fallback\n    async analyzeText(text, language = \"auto\") {\n        // Try Groq API first if available\n        if (this.isGroqAvailable) {\n            try {\n                console.log(\"\\uD83E\\uDD16 Using Groq API for sentiment analysis\");\n                return await this.analyzeWithGroq(text, language);\n            } catch (error) {\n                console.error(\"âŒ Groq analysis failed, using enhanced fallback:\", error);\n                return await this.fallbackAnalysis(text, language);\n            }\n        }\n        // If Groq is not available, use enhanced fallback immediately\n        console.log(\"\\uD83D\\uDD04 Using enhanced fallback analysis (Groq unavailable)\");\n        return await this.fallbackAnalysis(text, language);\n    }\n    // Analyze text using Groq API with Llama model\n    async analyzeWithGroq(text, language) {\n        const prompt = `Analyze the following text for sentiment analysis and provide a JSON response with the following structure:\n{\n  \"sentiment\": \"positive\" | \"negative\" | \"neutral\",\n  \"confidence\": 0.0-1.0,\n  \"emotions\": {\n    \"joy\": 0.0-1.0,\n    \"anger\": 0.0-1.0,\n    \"sadness\": 0.0-1.0,\n    \"fear\": 0.0-1.0,\n    \"surprise\": 0.0-1.0,\n    \"disgust\": 0.0-1.0\n  },\n  \"keywords\": [\"word1\", \"word2\", \"word3\"],\n  \"urgency\": \"low\" | \"medium\" | \"high\" | \"critical\",\n  \"categories\": [\"category1\", \"category2\"],\n  \"actionableInsights\": [\"insight1\", \"insight2\"]\n}\n\nText to analyze: \"${text}\"\n\nLanguage: ${language}\n\nProvide only the JSON response, no additional text.`;\n        try {\n            const response = await fetch(\"https://api.groq.com/openai/v1/chat/completions\", {\n                method: \"POST\",\n                headers: {\n                    \"Authorization\": `Bearer ${this.groqApiKey}`,\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify({\n                    model: \"llama-3.1-8b-instant\",\n                    messages: [\n                        {\n                            role: \"system\",\n                            content: \"You are an expert sentiment analysis AI. Respond only with valid JSON.\"\n                        },\n                        {\n                            role: \"user\",\n                            content: prompt\n                        }\n                    ],\n                    temperature: 0.3,\n                    max_tokens: 1000\n                })\n            });\n            if (!response.ok) {\n                throw new Error(`Groq API error: ${response.status} ${response.statusText}`);\n            }\n            const data = await response.json();\n            const content = data.choices?.[0]?.message?.content;\n            if (!content) {\n                throw new Error(\"No content in Groq response\");\n            }\n            // Parse the JSON response\n            const analysis = JSON.parse(content);\n            console.log(\"âœ… Groq sentiment analysis successful:\", analysis.sentiment, analysis.confidence);\n            return {\n                sentiment: analysis.sentiment || \"neutral\",\n                confidence: analysis.confidence || 0.5,\n                emotions: analysis.emotions || {},\n                keywords: analysis.keywords || [],\n                language: language,\n                toxicity: 0,\n                urgency: analysis.urgency || \"low\",\n                categories: analysis.categories || [],\n                actionableInsights: analysis.actionableInsights || []\n            };\n        } catch (error) {\n            console.error(\"Groq API error:\", error);\n            throw error;\n        }\n    }\n    // Voice analysis with speech-to-text and emotion detection\n    async analyzeVoice(audioBlob) {\n        try {\n            // Convert audio to text using Hugging Face Whisper\n            const transcription = await this.speechToText(audioBlob);\n            // Analyze the transcribed text\n            const textAnalysis = await this.analyzeText(transcription);\n            // Analyze voice tone and emotions from audio\n            const voiceEmotions = await this.analyzeVoiceEmotions(audioBlob);\n            return {\n                transcription,\n                sentiment: textAnalysis.sentiment,\n                confidence: textAnalysis.confidence,\n                emotions: {\n                    ...textAnalysis.emotions,\n                    ...voiceEmotions\n                },\n                speakerTone: this.determineSpeakerTone(voiceEmotions),\n                language: textAnalysis.language\n            };\n        } catch (error) {\n            console.error(\"Voice analysis failed:\", error);\n            throw new Error(\"Voice analysis service unavailable\");\n        }\n    }\n    // Image analysis for visual feedback\n    async analyzeImage(imageBlob) {\n        try {\n            // Convert image to base64\n            const base64Image = await this.blobToBase64(imageBlob);\n            // Analyze image content using Hugging Face Vision models\n            const [description, objects, sentiment] = await Promise.all([\n                this.generateImageDescription(base64Image),\n                this.detectObjects(base64Image),\n                this.analyzeImageSentiment(base64Image)\n            ]);\n            // Assess image quality\n            const quality = await this.assessImageQuality(base64Image);\n            // Detect potential issues\n            const issues = await this.detectImageIssues(base64Image, objects);\n            return {\n                description,\n                objects,\n                sentiment,\n                quality,\n                issues,\n                location: await this.extractLocationFromImage(base64Image)\n            };\n        } catch (error) {\n            console.error(\"Image analysis failed:\", error);\n            throw new Error(\"Image analysis service unavailable\");\n        }\n    }\n    // Language detection using AI\n    async detectLanguage(text) {\n        try {\n            const response = await fetch(\"https://api-inference.huggingface.co/models/facebook/fasttext-language-identification\", {\n                headers: {\n                    \"Authorization\": `Bearer ${this.huggingFaceKey}`,\n                    \"Content-Type\": \"application/json\"\n                },\n                method: \"POST\",\n                body: JSON.stringify({\n                    inputs: text\n                })\n            });\n            if (response.ok) {\n                const result = await response.json();\n                return result[0]?.label?.replace(\"__label__\", \"\") || \"en\";\n            }\n        } catch (error) {\n            console.error(\"Language detection failed:\", error);\n        }\n        return \"en\";\n    }\n    // Enhanced sentiment analysis with multiple models\n    async analyzeSentiment(text, language) {\n        const models = [\n            \"cardiffnlp/twitter-roberta-base-sentiment-latest\",\n            \"nlptown/bert-base-multilingual-uncased-sentiment\"\n        ];\n        for (const model of models){\n            try {\n                const response = await fetch(`https://api-inference.huggingface.co/models/${model}`, {\n                    headers: {\n                        \"Authorization\": `Bearer ${this.huggingFaceKey}`,\n                        \"Content-Type\": \"application/json\"\n                    },\n                    method: \"POST\",\n                    body: JSON.stringify({\n                        inputs: text\n                    })\n                });\n                if (response.ok) {\n                    const result = await response.json();\n                    if (Array.isArray(result) && result.length > 0) {\n                        const topResult = result[0];\n                        return {\n                            sentiment: this.normalizeSentiment(topResult.label),\n                            confidence: topResult.score\n                        };\n                    }\n                }\n            } catch (error) {\n                console.error(`Sentiment analysis with ${model} failed:`, error);\n            }\n        }\n        throw new Error(\"All sentiment analysis models failed\");\n    }\n    // Advanced emotion analysis\n    async analyzeEmotions(text) {\n        try {\n            const response = await fetch(\"https://api-inference.huggingface.co/models/j-hartmann/emotion-english-distilroberta-base\", {\n                headers: {\n                    \"Authorization\": `Bearer ${this.huggingFaceKey}`,\n                    \"Content-Type\": \"application/json\"\n                },\n                method: \"POST\",\n                body: JSON.stringify({\n                    inputs: text\n                })\n            });\n            if (response.ok) {\n                const emotions = await response.json();\n                if (Array.isArray(emotions) && emotions.length > 0) {\n                    const emotionScores = {};\n                    emotions[0].forEach((emotion)=>{\n                        emotionScores[emotion.label.toLowerCase()] = emotion.score;\n                    });\n                    return emotionScores;\n                }\n            }\n        } catch (error) {\n            console.error(\"Emotion analysis failed:\", error);\n        }\n        return {};\n    }\n    // Toxicity detection\n    async analyzeToxicity(text) {\n        try {\n            const response = await fetch(\"https://api-inference.huggingface.co/models/unitary/toxic-bert\", {\n                headers: {\n                    \"Authorization\": `Bearer ${this.huggingFaceKey}`,\n                    \"Content-Type\": \"application/json\"\n                },\n                method: \"POST\",\n                body: JSON.stringify({\n                    inputs: text\n                })\n            });\n            if (response.ok) {\n                const result = await response.json();\n                if (Array.isArray(result) && result.length > 0) {\n                    const toxicResult = result[0].find((r)=>r.label === \"TOXIC\");\n                    return toxicResult ? toxicResult.score : 0;\n                }\n            }\n        } catch (error) {\n            console.error(\"Toxicity analysis failed:\", error);\n        }\n        return 0;\n    }\n    // Text categorization\n    async categorizeText(text) {\n        try {\n            const response = await fetch(\"https://api-inference.huggingface.co/models/facebook/bart-large-mnli\", {\n                headers: {\n                    \"Authorization\": `Bearer ${this.huggingFaceKey}`,\n                    \"Content-Type\": \"application/json\"\n                },\n                method: \"POST\",\n                body: JSON.stringify({\n                    inputs: text,\n                    parameters: {\n                        candidate_labels: [\n                            \"accommodation\",\n                            \"food\",\n                            \"transportation\",\n                            \"attractions\",\n                            \"service quality\",\n                            \"cleanliness\",\n                            \"safety\",\n                            \"pricing\",\n                            \"accessibility\",\n                            \"cultural experience\"\n                        ]\n                    }\n                })\n            });\n            if (response.ok) {\n                const result = await response.json();\n                return result.labels?.slice(0, 3) || [];\n            }\n        } catch (error) {\n            console.error(\"Text categorization failed:\", error);\n        }\n        return [];\n    }\n    // Advanced keyword extraction using TF-IDF and NER\n    async extractAdvancedKeywords(text, language) {\n        try {\n            // Named Entity Recognition\n            const response = await fetch(\"https://api-inference.huggingface.co/models/dbmdz/bert-large-cased-finetuned-conll03-english\", {\n                headers: {\n                    \"Authorization\": `Bearer ${this.huggingFaceKey}`,\n                    \"Content-Type\": \"application/json\"\n                },\n                method: \"POST\",\n                body: JSON.stringify({\n                    inputs: text\n                })\n            });\n            const entities = [];\n            if (response.ok) {\n                const result = await response.json();\n                if (Array.isArray(result)) {\n                    result.forEach((entity)=>{\n                        if (entity.entity_group && entity.word) {\n                            entities.push(entity.word.replace(\"##\", \"\"));\n                        }\n                    });\n                }\n            }\n            // Combine with TF-IDF keywords\n            const tfidfKeywords = this.extractTFIDFKeywords(text);\n            return [\n                ...new Set([\n                    ...entities,\n                    ...tfidfKeywords\n                ])\n            ].slice(0, 10);\n        } catch (error) {\n            console.error(\"Advanced keyword extraction failed:\", error);\n            return this.extractTFIDFKeywords(text);\n        }\n    }\n    // Generate actionable insights using AI\n    async generateActionableInsights(text, language) {\n        const insights = [];\n        // Rule-based insights for now (can be enhanced with GPT-4 later)\n        const lowercaseText = text.toLowerCase();\n        if (lowercaseText.includes(\"dirty\") || lowercaseText.includes(\"unclean\")) {\n            insights.push(\"Immediate cleaning and hygiene improvement required\");\n        }\n        if (lowercaseText.includes(\"expensive\") || lowercaseText.includes(\"overpriced\")) {\n            insights.push(\"Review pricing strategy and provide value justification\");\n        }\n        if (lowercaseText.includes(\"rude\") || lowercaseText.includes(\"unprofessional\")) {\n            insights.push(\"Staff training and customer service improvement needed\");\n        }\n        if (lowercaseText.includes(\"unsafe\") || lowercaseText.includes(\"dangerous\")) {\n            insights.push(\"URGENT: Safety assessment and security measures required\");\n        }\n        if (lowercaseText.includes(\"beautiful\") || lowercaseText.includes(\"amazing\")) {\n            insights.push(\"Leverage positive aspects in marketing and promotion\");\n        }\n        return insights;\n    }\n    // Calculate urgency level\n    calculateUrgency(sentiment, toxicity) {\n        if (toxicity > 0.8 || sentiment?.sentiment === \"negative\" && sentiment?.confidence > 0.9) {\n            return \"critical\";\n        }\n        if (toxicity > 0.6 || sentiment?.sentiment === \"negative\" && sentiment?.confidence > 0.7) {\n            return \"high\";\n        }\n        if (toxicity > 0.3 || sentiment?.sentiment === \"negative\" && sentiment?.confidence > 0.5) {\n            return \"medium\";\n        }\n        return \"low\";\n    }\n    // Speech to text conversion\n    async speechToText(audioBlob) {\n        try {\n            const formData = new FormData();\n            formData.append(\"file\", audioBlob, \"audio.wav\");\n            const response = await fetch(\"https://api-inference.huggingface.co/models/openai/whisper-large-v3\", {\n                headers: {\n                    \"Authorization\": `Bearer ${this.huggingFaceKey}`\n                },\n                method: \"POST\",\n                body: formData\n            });\n            if (response.ok) {\n                const result = await response.json();\n                return result.text || \"\";\n            }\n        } catch (error) {\n            console.error(\"Speech to text failed:\", error);\n        }\n        return \"\";\n    }\n    // Voice emotion analysis\n    async analyzeVoiceEmotions(audioBlob) {\n        // Placeholder for voice emotion analysis\n        // In production, this would use specialized audio emotion recognition models\n        return {\n            calm: 0.3,\n            excited: 0.2,\n            frustrated: 0.1,\n            happy: 0.4\n        };\n    }\n    // Determine speaker tone from voice emotions\n    determineSpeakerTone(emotions) {\n        const maxEmotion = Object.entries(emotions).reduce((a, b)=>a[1] > b[1] ? a : b);\n        return maxEmotion[0] || \"calm\";\n    }\n    // Image description generation\n    async generateImageDescription(base64Image) {\n        try {\n            const response = await fetch(\"https://api-inference.huggingface.co/models/Salesforce/blip-image-captioning-large\", {\n                headers: {\n                    \"Authorization\": `Bearer ${this.huggingFaceKey}`,\n                    \"Content-Type\": \"application/json\"\n                },\n                method: \"POST\",\n                body: JSON.stringify({\n                    inputs: base64Image\n                })\n            });\n            if (response.ok) {\n                const result = await response.json();\n                return result[0]?.generated_text || \"Unable to generate description\";\n            }\n        } catch (error) {\n            console.error(\"Image description failed:\", error);\n        }\n        return \"Image analysis unavailable\";\n    }\n    // Object detection in images\n    async detectObjects(base64Image) {\n        try {\n            const response = await fetch(\"https://api-inference.huggingface.co/models/facebook/detr-resnet-50\", {\n                headers: {\n                    \"Authorization\": `Bearer ${this.huggingFaceKey}`,\n                    \"Content-Type\": \"application/json\"\n                },\n                method: \"POST\",\n                body: JSON.stringify({\n                    inputs: base64Image\n                })\n            });\n            if (response.ok) {\n                const result = await response.json();\n                return result.map((obj)=>obj.label).slice(0, 10);\n            }\n        } catch (error) {\n            console.error(\"Object detection failed:\", error);\n        }\n        return [];\n    }\n    // Image sentiment analysis\n    async analyzeImageSentiment(base64Image) {\n        // Placeholder - would use specialized image sentiment models\n        return \"neutral\";\n    }\n    // Assess image quality\n    async assessImageQuality(base64Image) {\n        // Placeholder - would use image quality assessment models\n        return Math.random() * 0.3 + 0.7 // Random quality between 0.7-1.0\n        ;\n    }\n    // Detect issues in images\n    async detectImageIssues(base64Image, objects) {\n        const issues = [];\n        // Rule-based issue detection\n        if (objects.includes(\"trash\") || objects.includes(\"garbage\")) {\n            issues.push(\"Cleanliness issue detected\");\n        }\n        if (objects.includes(\"damage\") || objects.includes(\"broken\")) {\n            issues.push(\"Infrastructure damage detected\");\n        }\n        return issues;\n    }\n    // Extract location from image metadata\n    async extractLocationFromImage(base64Image) {\n        // Placeholder - would extract GPS data from EXIF or use image recognition\n        return undefined;\n    }\n    // Utility functions\n    async blobToBase64(blob) {\n        return new Promise((resolve, reject)=>{\n            const reader = new FileReader();\n            reader.onloadend = ()=>resolve(reader.result);\n            reader.onerror = reject;\n            reader.readAsDataURL(blob);\n        });\n    }\n    normalizeSentiment(label) {\n        const normalized = label.toLowerCase();\n        if (normalized.includes(\"positive\") || normalized.includes(\"pos\")) return \"positive\";\n        if (normalized.includes(\"negative\") || normalized.includes(\"neg\")) return \"negative\";\n        return \"neutral\";\n    }\n    extractTFIDFKeywords(text) {\n        const stopWords = new Set([\n            \"the\",\n            \"a\",\n            \"an\",\n            \"and\",\n            \"or\",\n            \"but\",\n            \"in\",\n            \"on\",\n            \"at\",\n            \"to\",\n            \"for\",\n            \"of\",\n            \"with\",\n            \"by\",\n            \"is\",\n            \"was\",\n            \"are\",\n            \"were\",\n            \"be\",\n            \"been\",\n            \"have\",\n            \"has\",\n            \"had\",\n            \"do\",\n            \"does\",\n            \"did\",\n            \"will\",\n            \"would\",\n            \"could\",\n            \"should\",\n            \"may\",\n            \"might\",\n            \"must\",\n            \"can\",\n            \"this\",\n            \"that\",\n            \"these\",\n            \"those\",\n            \"i\",\n            \"you\",\n            \"he\",\n            \"she\",\n            \"it\",\n            \"we\",\n            \"they\",\n            \"me\",\n            \"him\",\n            \"her\",\n            \"us\",\n            \"them\"\n        ]);\n        const words = text.toLowerCase().replace(/[^\\w\\s]/g, \"\").split(/\\s+/).filter((word)=>word.length > 2 && !stopWords.has(word));\n        const wordCount = {};\n        words.forEach((word)=>{\n            wordCount[word] = (wordCount[word] || 0) + 1;\n        });\n        return Object.entries(wordCount).sort(([, a], [, b])=>b - a).slice(0, 5).map(([word])=>word);\n    }\n    fallbackAnalysis(text, language) {\n        // Simple rule-based fallback\n        const positiveWords = [\n            \"good\",\n            \"great\",\n            \"excellent\",\n            \"amazing\",\n            \"wonderful\",\n            \"beautiful\",\n            \"love\",\n            \"perfect\"\n        ];\n        const negativeWords = [\n            \"bad\",\n            \"terrible\",\n            \"awful\",\n            \"horrible\",\n            \"hate\",\n            \"worst\",\n            \"disappointing\",\n            \"poor\"\n        ];\n        const words = text.toLowerCase().split(/\\s+/);\n        const positiveCount = words.filter((word)=>positiveWords.includes(word)).length;\n        const negativeCount = words.filter((word)=>negativeWords.includes(word)).length;\n        let sentiment = \"neutral\";\n        let confidence = 0.5;\n        if (positiveCount > negativeCount) {\n            sentiment = \"positive\";\n            confidence = Math.min(0.8, 0.5 + (positiveCount - negativeCount) * 0.1);\n        } else if (negativeCount > positiveCount) {\n            sentiment = \"negative\";\n            confidence = Math.min(0.8, 0.5 + (negativeCount - positiveCount) * 0.1);\n        }\n        return {\n            sentiment,\n            confidence,\n            emotions: {\n                joy: sentiment === \"positive\" ? confidence * 0.8 : 0.1,\n                anger: sentiment === \"negative\" ? confidence * 0.6 : 0.1,\n                sadness: sentiment === \"negative\" ? confidence * 0.4 : 0.1\n            },\n            keywords: this.extractTFIDFKeywords(text),\n            language: language || \"en\",\n            toxicity: 0,\n            urgency: \"low\",\n            categories: [],\n            actionableInsights: []\n        };\n    }\n}\n// Singleton instance\nconst aiService = new AdvancedAIService();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LE1BQU0sQ0FBQ0YsZ0JBQWdCQyxhQUFZLElBQUs7UUFDckUsT0FBTyxJQUFJQSxnQkFBZ0JELGVBQWU7WUFDeEMvRyxZQUFZO1lBQ1pDLGFBQWF5RixLQUFLdUIsR0FBRyxDQUFDLEtBQUssTUFBTSxDQUFDRCxnQkFBZ0JELGFBQVksSUFBSztRQUNyRTtRQUVBLE9BQU87WUFDTC9HO1lBQ0FDO1lBQ0FDLFVBQVU7Z0JBQ1JnSCxLQUFLbEgsY0FBYyxhQUFhQyxhQUFhLE1BQU07Z0JBQ25Ea0gsT0FBT25ILGNBQWMsYUFBYUMsYUFBYSxNQUFNO2dCQUNyRG1ILFNBQVNwSCxjQUFjLGFBQWFDLGFBQWEsTUFBTTtZQUN6RDtZQUNBRSxVQUFVLElBQUksQ0FBQ2dFLG9CQUFvQixDQUFDaEc7WUFDcENDLFVBQVVBLFlBQVk7WUFDdEJnQyxVQUFVO1lBQ1ZDLFNBQVM7WUFDVEMsWUFBWSxFQUFFO1lBQ2RDLG9CQUFvQixFQUFFO1FBQ3hCO0lBQ0Y7QUFDRjtBQUVBLHFCQUFxQjtBQUNkLE1BQU04RyxZQUFZLElBQUlySyxvQkFBbUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9teS12MC1wcm9qZWN0Ly4vbGliL2FpLXNlcnZpY2VzLnRzPzkxOGIiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQWR2YW5jZWQgQUkgU2VydmljZXMgZm9yIFRvdXJpc20gSmhhcmtoYW5kXG4vLyBJbnRlZ3JhdGVzIG11bHRpcGxlIEFJIEFQSXMgZm9yIGNvbXByZWhlbnNpdmUgYW5hbHlzaXNcblxuZXhwb3J0IGludGVyZmFjZSBBSUFuYWx5c2lzUmVzdWx0IHtcbiAgc2VudGltZW50OiAncG9zaXRpdmUnIHwgJ25lZ2F0aXZlJyB8ICduZXV0cmFsJ1xuICBjb25maWRlbmNlOiBudW1iZXJcbiAgZW1vdGlvbnM6IHsgW2tleTogc3RyaW5nXTogbnVtYmVyIH1cbiAga2V5d29yZHM6IHN0cmluZ1tdXG4gIGxhbmd1YWdlOiBzdHJpbmdcbiAgdG94aWNpdHk/OiBudW1iZXJcbiAgdXJnZW5jeT86ICdsb3cnIHwgJ21lZGl1bScgfCAnaGlnaCcgfCAnY3JpdGljYWwnXG4gIGNhdGVnb3JpZXM/OiBzdHJpbmdbXVxuICBhY3Rpb25hYmxlSW5zaWdodHM/OiBzdHJpbmdbXVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFZvaWNlQW5hbHlzaXNSZXN1bHQge1xuICB0cmFuc2NyaXB0aW9uOiBzdHJpbmdcbiAgc2VudGltZW50OiAncG9zaXRpdmUnIHwgJ25lZ2F0aXZlJyB8ICduZXV0cmFsJ1xuICBjb25maWRlbmNlOiBudW1iZXJcbiAgZW1vdGlvbnM6IHsgW2tleTogc3RyaW5nXTogbnVtYmVyIH1cbiAgc3BlYWtlclRvbmU6ICdjYWxtJyB8ICdleGNpdGVkJyB8ICdmcnVzdHJhdGVkJyB8ICdhbmdyeScgfCAnaGFwcHknXG4gIGxhbmd1YWdlOiBzdHJpbmdcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJbWFnZUFuYWx5c2lzUmVzdWx0IHtcbiAgZGVzY3JpcHRpb246IHN0cmluZ1xuICBvYmplY3RzOiBzdHJpbmdbXVxuICBzZW50aW1lbnQ6ICdwb3NpdGl2ZScgfCAnbmVnYXRpdmUnIHwgJ25ldXRyYWwnXG4gIHF1YWxpdHk6IG51bWJlclxuICBpc3N1ZXM/OiBzdHJpbmdbXVxuICBsb2NhdGlvbj86IHN0cmluZ1xufVxuXG4vLyBBZHZhbmNlZCBtdWx0aWxpbmd1YWwgc2VudGltZW50IGFuYWx5c2lzIHdpdGggbXVsdGlwbGUgQUkgbW9kZWxzXG5leHBvcnQgY2xhc3MgQWR2YW5jZWRBSVNlcnZpY2Uge1xuICBwcml2YXRlIGh1Z2dpbmdGYWNlS2V5OiBzdHJpbmdcbiAgcHJpdmF0ZSBvcGVuQUlLZXk/OiBzdHJpbmdcbiAgcHJpdmF0ZSBnb29nbGVDbG91ZEtleT86IHN0cmluZ1xuICBwcml2YXRlIGdyb3FBcGlLZXk6IHN0cmluZ1xuICBwcml2YXRlIGlzR3JvcUF2YWlsYWJsZTogYm9vbGVhblxuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuaHVnZ2luZ0ZhY2VLZXkgPSBwcm9jZXNzLmVudi5IVUdHSU5HRkFDRV9BUElfS0VZIHx8ICcnXG4gICAgdGhpcy5vcGVuQUlLZXkgPSBwcm9jZXNzLmVudi5PUEVOQUlfQVBJX0tFWVxuICAgIHRoaXMuZ29vZ2xlQ2xvdWRLZXkgPSBwcm9jZXNzLmVudi5HT09HTEVfQ0xPVURfQVBJX0tFWVxuICAgIHRoaXMuZ3JvcUFwaUtleSA9IHByb2Nlc3MuZW52LkdST1FfQVBJX0tFWSB8fCAnJ1xuICAgIHRoaXMuaXNHcm9xQXZhaWxhYmxlID0gdGhpcy52YWxpZGF0ZUdyb3FLZXkoKVxuICAgIFxuICAgIGlmICh0aGlzLmlzR3JvcUF2YWlsYWJsZSkge1xuICAgICAgY29uc29sZS5sb2coJ+KchSBHcm9xIEFQSSBhdmFpbGFibGUgZm9yIHNlbnRpbWVudCBhbmFseXNpcycpXG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUud2Fybign4pqg77iPIEdyb3EgQVBJIGtleSBub3QgZm91bmQuIFVzaW5nIGVuaGFuY2VkIGZhbGxiYWNrIGFuYWx5c2lzLicpXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSB2YWxpZGF0ZUdyb3FLZXkoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuICEhKHRoaXMuZ3JvcUFwaUtleSAmJiB0aGlzLmdyb3FBcGlLZXkubGVuZ3RoID4gMTAgJiYgdGhpcy5ncm9xQXBpS2V5ICE9PSAneW91cl9ncm9xX2FwaV9rZXlfaGVyZScpXG4gIH1cblxuICAvLyBFbmhhbmNlZCB0ZXh0IGFuYWx5c2lzIHdpdGggR3JvcSBBUEkgZmlyc3QsIHRoZW4gZmFsbGJhY2tcbiAgYXN5bmMgYW5hbHl6ZVRleHQodGV4dDogc3RyaW5nLCBsYW5ndWFnZTogc3RyaW5nID0gJ2F1dG8nKTogUHJvbWlzZTxBSUFuYWx5c2lzUmVzdWx0PiB7XG4gICAgLy8gVHJ5IEdyb3EgQVBJIGZpcnN0IGlmIGF2YWlsYWJsZVxuICAgIGlmICh0aGlzLmlzR3JvcUF2YWlsYWJsZSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc29sZS5sb2coJ/CfpJYgVXNpbmcgR3JvcSBBUEkgZm9yIHNlbnRpbWVudCBhbmFseXNpcycpXG4gICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmFuYWx5emVXaXRoR3JvcSh0ZXh0LCBsYW5ndWFnZSlcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBHcm9xIGFuYWx5c2lzIGZhaWxlZCwgdXNpbmcgZW5oYW5jZWQgZmFsbGJhY2s6JywgZXJyb3IpXG4gICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmZhbGxiYWNrQW5hbHlzaXModGV4dCwgbGFuZ3VhZ2UpXG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gSWYgR3JvcSBpcyBub3QgYXZhaWxhYmxlLCB1c2UgZW5oYW5jZWQgZmFsbGJhY2sgaW1tZWRpYXRlbHlcbiAgICBjb25zb2xlLmxvZygn8J+UhCBVc2luZyBlbmhhbmNlZCBmYWxsYmFjayBhbmFseXNpcyAoR3JvcSB1bmF2YWlsYWJsZSknKVxuICAgIHJldHVybiBhd2FpdCB0aGlzLmZhbGxiYWNrQW5hbHlzaXModGV4dCwgbGFuZ3VhZ2UpXG4gIH1cblxuICAvLyBBbmFseXplIHRleHQgdXNpbmcgR3JvcSBBUEkgd2l0aCBMbGFtYSBtb2RlbFxuICBwcml2YXRlIGFzeW5jIGFuYWx5emVXaXRoR3JvcSh0ZXh0OiBzdHJpbmcsIGxhbmd1YWdlOiBzdHJpbmcpOiBQcm9taXNlPEFJQW5hbHlzaXNSZXN1bHQ+IHtcbiAgICBjb25zdCBwcm9tcHQgPSBgQW5hbHl6ZSB0aGUgZm9sbG93aW5nIHRleHQgZm9yIHNlbnRpbWVudCBhbmFseXNpcyBhbmQgcHJvdmlkZSBhIEpTT04gcmVzcG9uc2Ugd2l0aCB0aGUgZm9sbG93aW5nIHN0cnVjdHVyZTpcbntcbiAgXCJzZW50aW1lbnRcIjogXCJwb3NpdGl2ZVwiIHwgXCJuZWdhdGl2ZVwiIHwgXCJuZXV0cmFsXCIsXG4gIFwiY29uZmlkZW5jZVwiOiAwLjAtMS4wLFxuICBcImVtb3Rpb25zXCI6IHtcbiAgICBcImpveVwiOiAwLjAtMS4wLFxuICAgIFwiYW5nZXJcIjogMC4wLTEuMCxcbiAgICBcInNhZG5lc3NcIjogMC4wLTEuMCxcbiAgICBcImZlYXJcIjogMC4wLTEuMCxcbiAgICBcInN1cnByaXNlXCI6IDAuMC0xLjAsXG4gICAgXCJkaXNndXN0XCI6IDAuMC0xLjBcbiAgfSxcbiAgXCJrZXl3b3Jkc1wiOiBbXCJ3b3JkMVwiLCBcIndvcmQyXCIsIFwid29yZDNcIl0sXG4gIFwidXJnZW5jeVwiOiBcImxvd1wiIHwgXCJtZWRpdW1cIiB8IFwiaGlnaFwiIHwgXCJjcml0aWNhbFwiLFxuICBcImNhdGVnb3JpZXNcIjogW1wiY2F0ZWdvcnkxXCIsIFwiY2F0ZWdvcnkyXCJdLFxuICBcImFjdGlvbmFibGVJbnNpZ2h0c1wiOiBbXCJpbnNpZ2h0MVwiLCBcImluc2lnaHQyXCJdXG59XG5cblRleHQgdG8gYW5hbHl6ZTogXCIke3RleHR9XCJcblxuTGFuZ3VhZ2U6ICR7bGFuZ3VhZ2V9XG5cblByb3ZpZGUgb25seSB0aGUgSlNPTiByZXNwb25zZSwgbm8gYWRkaXRpb25hbCB0ZXh0LmBcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCdodHRwczovL2FwaS5ncm9xLmNvbS9vcGVuYWkvdjEvY2hhdC9jb21wbGV0aW9ucycsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHt0aGlzLmdyb3FBcGlLZXl9YCxcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgbW9kZWw6ICdsbGFtYS0zLjEtOGItaW5zdGFudCcsXG4gICAgICAgICAgbWVzc2FnZXM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgcm9sZTogJ3N5c3RlbScsXG4gICAgICAgICAgICAgIGNvbnRlbnQ6ICdZb3UgYXJlIGFuIGV4cGVydCBzZW50aW1lbnQgYW5hbHlzaXMgQUkuIFJlc3BvbmQgb25seSB3aXRoIHZhbGlkIEpTT04uJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICAgICAgICBjb250ZW50OiBwcm9tcHRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBdLFxuICAgICAgICAgIHRlbXBlcmF0dXJlOiAwLjMsXG4gICAgICAgICAgbWF4X3Rva2VuczogMTAwMCxcbiAgICAgICAgfSksXG4gICAgICB9KVxuXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgR3JvcSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfSAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YClcbiAgICAgIH1cblxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKVxuICAgICAgY29uc3QgY29udGVudCA9IGRhdGEuY2hvaWNlcz8uWzBdPy5tZXNzYWdlPy5jb250ZW50XG5cbiAgICAgIGlmICghY29udGVudCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGNvbnRlbnQgaW4gR3JvcSByZXNwb25zZScpXG4gICAgICB9XG5cbiAgICAgIC8vIFBhcnNlIHRoZSBKU09OIHJlc3BvbnNlXG4gICAgICBjb25zdCBhbmFseXNpcyA9IEpTT04ucGFyc2UoY29udGVudClcbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coJ+KchSBHcm9xIHNlbnRpbWVudCBhbmFseXNpcyBzdWNjZXNzZnVsOicsIGFuYWx5c2lzLnNlbnRpbWVudCwgYW5hbHlzaXMuY29uZmlkZW5jZSlcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc2VudGltZW50OiBhbmFseXNpcy5zZW50aW1lbnQgfHwgJ25ldXRyYWwnLFxuICAgICAgICBjb25maWRlbmNlOiBhbmFseXNpcy5jb25maWRlbmNlIHx8IDAuNSxcbiAgICAgICAgZW1vdGlvbnM6IGFuYWx5c2lzLmVtb3Rpb25zIHx8IHt9LFxuICAgICAgICBrZXl3b3JkczogYW5hbHlzaXMua2V5d29yZHMgfHwgW10sXG4gICAgICAgIGxhbmd1YWdlOiBsYW5ndWFnZSxcbiAgICAgICAgdG94aWNpdHk6IDAsIC8vIEdyb3EgZG9lc24ndCBwcm92aWRlIHRveGljaXR5LCBzZXQgdG8gMFxuICAgICAgICB1cmdlbmN5OiBhbmFseXNpcy51cmdlbmN5IHx8ICdsb3cnLFxuICAgICAgICBjYXRlZ29yaWVzOiBhbmFseXNpcy5jYXRlZ29yaWVzIHx8IFtdLFxuICAgICAgICBhY3Rpb25hYmxlSW5zaWdodHM6IGFuYWx5c2lzLmFjdGlvbmFibGVJbnNpZ2h0cyB8fCBbXVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdHcm9xIEFQSSBlcnJvcjonLCBlcnJvcilcbiAgICAgIHRocm93IGVycm9yXG4gICAgfVxuICB9XG5cbiAgLy8gVm9pY2UgYW5hbHlzaXMgd2l0aCBzcGVlY2gtdG8tdGV4dCBhbmQgZW1vdGlvbiBkZXRlY3Rpb25cbiAgYXN5bmMgYW5hbHl6ZVZvaWNlKGF1ZGlvQmxvYjogQmxvYik6IFByb21pc2U8Vm9pY2VBbmFseXNpc1Jlc3VsdD4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBDb252ZXJ0IGF1ZGlvIHRvIHRleHQgdXNpbmcgSHVnZ2luZyBGYWNlIFdoaXNwZXJcbiAgICAgIGNvbnN0IHRyYW5zY3JpcHRpb24gPSBhd2FpdCB0aGlzLnNwZWVjaFRvVGV4dChhdWRpb0Jsb2IpXG4gICAgICBcbiAgICAgIC8vIEFuYWx5emUgdGhlIHRyYW5zY3JpYmVkIHRleHRcbiAgICAgIGNvbnN0IHRleHRBbmFseXNpcyA9IGF3YWl0IHRoaXMuYW5hbHl6ZVRleHQodHJhbnNjcmlwdGlvbilcbiAgICAgIFxuICAgICAgLy8gQW5hbHl6ZSB2b2ljZSB0b25lIGFuZCBlbW90aW9ucyBmcm9tIGF1ZGlvXG4gICAgICBjb25zdCB2b2ljZUVtb3Rpb25zID0gYXdhaXQgdGhpcy5hbmFseXplVm9pY2VFbW90aW9ucyhhdWRpb0Jsb2IpXG4gICAgICBcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRyYW5zY3JpcHRpb24sXG4gICAgICAgIHNlbnRpbWVudDogdGV4dEFuYWx5c2lzLnNlbnRpbWVudCxcbiAgICAgICAgY29uZmlkZW5jZTogdGV4dEFuYWx5c2lzLmNvbmZpZGVuY2UsXG4gICAgICAgIGVtb3Rpb25zOiB7IC4uLnRleHRBbmFseXNpcy5lbW90aW9ucywgLi4udm9pY2VFbW90aW9ucyB9LFxuICAgICAgICBzcGVha2VyVG9uZTogdGhpcy5kZXRlcm1pbmVTcGVha2VyVG9uZSh2b2ljZUVtb3Rpb25zKSxcbiAgICAgICAgbGFuZ3VhZ2U6IHRleHRBbmFseXNpcy5sYW5ndWFnZVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdWb2ljZSBhbmFseXNpcyBmYWlsZWQ6JywgZXJyb3IpXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1ZvaWNlIGFuYWx5c2lzIHNlcnZpY2UgdW5hdmFpbGFibGUnKVxuICAgIH1cbiAgfVxuXG4gIC8vIEltYWdlIGFuYWx5c2lzIGZvciB2aXN1YWwgZmVlZGJhY2tcbiAgYXN5bmMgYW5hbHl6ZUltYWdlKGltYWdlQmxvYjogQmxvYik6IFByb21pc2U8SW1hZ2VBbmFseXNpc1Jlc3VsdD4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBDb252ZXJ0IGltYWdlIHRvIGJhc2U2NFxuICAgICAgY29uc3QgYmFzZTY0SW1hZ2UgPSBhd2FpdCB0aGlzLmJsb2JUb0Jhc2U2NChpbWFnZUJsb2IpXG4gICAgICBcbiAgICAgIC8vIEFuYWx5emUgaW1hZ2UgY29udGVudCB1c2luZyBIdWdnaW5nIEZhY2UgVmlzaW9uIG1vZGVsc1xuICAgICAgY29uc3QgW2Rlc2NyaXB0aW9uLCBvYmplY3RzLCBzZW50aW1lbnRdID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgICB0aGlzLmdlbmVyYXRlSW1hZ2VEZXNjcmlwdGlvbihiYXNlNjRJbWFnZSksXG4gICAgICAgIHRoaXMuZGV0ZWN0T2JqZWN0cyhiYXNlNjRJbWFnZSksXG4gICAgICAgIHRoaXMuYW5hbHl6ZUltYWdlU2VudGltZW50KGJhc2U2NEltYWdlKVxuICAgICAgXSlcblxuICAgICAgLy8gQXNzZXNzIGltYWdlIHF1YWxpdHlcbiAgICAgIGNvbnN0IHF1YWxpdHkgPSBhd2FpdCB0aGlzLmFzc2Vzc0ltYWdlUXVhbGl0eShiYXNlNjRJbWFnZSlcbiAgICAgIFxuICAgICAgLy8gRGV0ZWN0IHBvdGVudGlhbCBpc3N1ZXNcbiAgICAgIGNvbnN0IGlzc3VlcyA9IGF3YWl0IHRoaXMuZGV0ZWN0SW1hZ2VJc3N1ZXMoYmFzZTY0SW1hZ2UsIG9iamVjdHMpXG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGRlc2NyaXB0aW9uLFxuICAgICAgICBvYmplY3RzLFxuICAgICAgICBzZW50aW1lbnQsXG4gICAgICAgIHF1YWxpdHksXG4gICAgICAgIGlzc3VlcyxcbiAgICAgICAgbG9jYXRpb246IGF3YWl0IHRoaXMuZXh0cmFjdExvY2F0aW9uRnJvbUltYWdlKGJhc2U2NEltYWdlKVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdJbWFnZSBhbmFseXNpcyBmYWlsZWQ6JywgZXJyb3IpXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ltYWdlIGFuYWx5c2lzIHNlcnZpY2UgdW5hdmFpbGFibGUnKVxuICAgIH1cbiAgfVxuXG4gIC8vIExhbmd1YWdlIGRldGVjdGlvbiB1c2luZyBBSVxuICBwcml2YXRlIGFzeW5jIGRldGVjdExhbmd1YWdlKHRleHQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXG4gICAgICAgICdodHRwczovL2FwaS1pbmZlcmVuY2UuaHVnZ2luZ2ZhY2UuY28vbW9kZWxzL2ZhY2Vib29rL2Zhc3R0ZXh0LWxhbmd1YWdlLWlkZW50aWZpY2F0aW9uJyxcbiAgICAgICAge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3RoaXMuaHVnZ2luZ0ZhY2VLZXl9YCxcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGlucHV0czogdGV4dCB9KSxcbiAgICAgICAgfVxuICAgICAgKVxuXG4gICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpXG4gICAgICAgIHJldHVybiByZXN1bHRbMF0/LmxhYmVsPy5yZXBsYWNlKCdfX2xhYmVsX18nLCAnJykgfHwgJ2VuJ1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdMYW5ndWFnZSBkZXRlY3Rpb24gZmFpbGVkOicsIGVycm9yKVxuICAgIH1cbiAgICByZXR1cm4gJ2VuJ1xuICB9XG5cbiAgLy8gRW5oYW5jZWQgc2VudGltZW50IGFuYWx5c2lzIHdpdGggbXVsdGlwbGUgbW9kZWxzXG4gIHByaXZhdGUgYXN5bmMgYW5hbHl6ZVNlbnRpbWVudCh0ZXh0OiBzdHJpbmcsIGxhbmd1YWdlOiBzdHJpbmcpOiBQcm9taXNlPHtzZW50aW1lbnQ6IHN0cmluZywgY29uZmlkZW5jZTogbnVtYmVyfT4ge1xuICAgIGNvbnN0IG1vZGVscyA9IFtcbiAgICAgICdjYXJkaWZmbmxwL3R3aXR0ZXItcm9iZXJ0YS1iYXNlLXNlbnRpbWVudC1sYXRlc3QnLFxuICAgICAgJ25scHRvd24vYmVydC1iYXNlLW11bHRpbGluZ3VhbC11bmNhc2VkLXNlbnRpbWVudCdcbiAgICBdXG5cbiAgICBmb3IgKGNvbnN0IG1vZGVsIG9mIG1vZGVscykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcbiAgICAgICAgICBgaHR0cHM6Ly9hcGktaW5mZXJlbmNlLmh1Z2dpbmdmYWNlLmNvL21vZGVscy8ke21vZGVsfWAsXG4gICAgICAgICAge1xuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHt0aGlzLmh1Z2dpbmdGYWNlS2V5fWAsXG4gICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGlucHV0czogdGV4dCB9KSxcbiAgICAgICAgICB9XG4gICAgICAgIClcblxuICAgICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXNwb25zZS5qc29uKClcbiAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShyZXN1bHQpICYmIHJlc3VsdC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb25zdCB0b3BSZXN1bHQgPSByZXN1bHRbMF1cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIHNlbnRpbWVudDogdGhpcy5ub3JtYWxpemVTZW50aW1lbnQodG9wUmVzdWx0LmxhYmVsKSxcbiAgICAgICAgICAgICAgY29uZmlkZW5jZTogdG9wUmVzdWx0LnNjb3JlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKGBTZW50aW1lbnQgYW5hbHlzaXMgd2l0aCAke21vZGVsfSBmYWlsZWQ6YCwgZXJyb3IpXG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhyb3cgbmV3IEVycm9yKCdBbGwgc2VudGltZW50IGFuYWx5c2lzIG1vZGVscyBmYWlsZWQnKVxuICB9XG5cbiAgLy8gQWR2YW5jZWQgZW1vdGlvbiBhbmFseXNpc1xuICBwcml2YXRlIGFzeW5jIGFuYWx5emVFbW90aW9ucyh0ZXh0OiBzdHJpbmcpOiBQcm9taXNlPHsgW2tleTogc3RyaW5nXTogbnVtYmVyIH0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcbiAgICAgICAgJ2h0dHBzOi8vYXBpLWluZmVyZW5jZS5odWdnaW5nZmFjZS5jby9tb2RlbHMvai1oYXJ0bWFubi9lbW90aW9uLWVuZ2xpc2gtZGlzdGlscm9iZXJ0YS1iYXNlJyxcbiAgICAgICAge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3RoaXMuaHVnZ2luZ0ZhY2VLZXl9YCxcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGlucHV0czogdGV4dCB9KSxcbiAgICAgICAgfVxuICAgICAgKVxuXG4gICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgY29uc3QgZW1vdGlvbnMgPSBhd2FpdCByZXNwb25zZS5qc29uKClcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZW1vdGlvbnMpICYmIGVtb3Rpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBjb25zdCBlbW90aW9uU2NvcmVzOiB7IFtrZXk6IHN0cmluZ106IG51bWJlciB9ID0ge31cbiAgICAgICAgICBlbW90aW9uc1swXS5mb3JFYWNoKChlbW90aW9uOiBhbnkpID0+IHtcbiAgICAgICAgICAgIGVtb3Rpb25TY29yZXNbZW1vdGlvbi5sYWJlbC50b0xvd2VyQ2FzZSgpXSA9IGVtb3Rpb24uc2NvcmVcbiAgICAgICAgICB9KVxuICAgICAgICAgIHJldHVybiBlbW90aW9uU2NvcmVzXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRW1vdGlvbiBhbmFseXNpcyBmYWlsZWQ6JywgZXJyb3IpXG4gICAgfVxuICAgIHJldHVybiB7fVxuICB9XG5cbiAgLy8gVG94aWNpdHkgZGV0ZWN0aW9uXG4gIHByaXZhdGUgYXN5bmMgYW5hbHl6ZVRveGljaXR5KHRleHQ6IHN0cmluZyk6IFByb21pc2U8bnVtYmVyPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXG4gICAgICAgICdodHRwczovL2FwaS1pbmZlcmVuY2UuaHVnZ2luZ2ZhY2UuY28vbW9kZWxzL3VuaXRhcnkvdG94aWMtYmVydCcsXG4gICAgICAgIHtcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHt0aGlzLmh1Z2dpbmdGYWNlS2V5fWAsXG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBpbnB1dHM6IHRleHQgfSksXG4gICAgICAgIH1cbiAgICAgIClcblxuICAgICAgaWYgKHJlc3BvbnNlLm9rKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKVxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShyZXN1bHQpICYmIHJlc3VsdC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgY29uc3QgdG94aWNSZXN1bHQgPSByZXN1bHRbMF0uZmluZCgocjogYW55KSA9PiByLmxhYmVsID09PSAnVE9YSUMnKVxuICAgICAgICAgIHJldHVybiB0b3hpY1Jlc3VsdCA/IHRveGljUmVzdWx0LnNjb3JlIDogMFxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1RveGljaXR5IGFuYWx5c2lzIGZhaWxlZDonLCBlcnJvcilcbiAgICB9XG4gICAgcmV0dXJuIDBcbiAgfVxuXG4gIC8vIFRleHQgY2F0ZWdvcml6YXRpb25cbiAgcHJpdmF0ZSBhc3luYyBjYXRlZ29yaXplVGV4dCh0ZXh0OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXG4gICAgICAgICdodHRwczovL2FwaS1pbmZlcmVuY2UuaHVnZ2luZ2ZhY2UuY28vbW9kZWxzL2ZhY2Vib29rL2JhcnQtbGFyZ2UtbW5saScsXG4gICAgICAgIHtcclxuICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7dGhpcy5odWdnaW5nRmFjZUtleX1gLFxyXG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICBpbnB1dHM6IHRleHQsXHJcbiAgICAgICAgICAgIHBhcmFtZXRlcnM6IHtcclxuICAgICAgICAgICAgICBjYW5kaWRhdGVfbGFiZWxzOiBbXHJcbiAgICAgICAgICAgICAgICAnYWNjb21tb2RhdGlvbicsICdmb29kJywgJ3RyYW5zcG9ydGF0aW9uJywgJ2F0dHJhY3Rpb25zJywgXHJcbiAgICAgICAgICAgICAgICAnc2VydmljZSBxdWFsaXR5JywgJ2NsZWFubGluZXNzJywgJ3NhZmV0eScsICdwcmljaW5nJywgXHJcbiAgICAgICAgICAgICAgICAnYWNjZXNzaWJpbGl0eScsICdjdWx0dXJhbCBleHBlcmllbmNlJ1xyXG4gICAgICAgICAgICAgIF1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSksXHJcbiAgICAgICAgfVxyXG4gICAgICApXHJcblxyXG4gICAgICBpZiAocmVzcG9uc2Uub2spIHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXNwb25zZS5qc29uKClcclxuICAgICAgICByZXR1cm4gcmVzdWx0LmxhYmVscz8uc2xpY2UoMCwgMykgfHwgW11cclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignVGV4dCBjYXRlZ29yaXphdGlvbiBmYWlsZWQ6JywgZXJyb3IpXHJcbiAgICB9XHJcbiAgICByZXR1cm4gW11cclxuICB9XHJcblxyXG4gIC8vIEFkdmFuY2VkIGtleXdvcmQgZXh0cmFjdGlvbiB1c2luZyBURi1JREYgYW5kIE5FUlxyXG4gIHByaXZhdGUgYXN5bmMgZXh0cmFjdEFkdmFuY2VkS2V5d29yZHModGV4dDogc3RyaW5nLCBsYW5ndWFnZTogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gTmFtZWQgRW50aXR5IFJlY29nbml0aW9uXHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXHJcbiAgICAgICAgJ2h0dHBzOi8vYXBpLWluZmVyZW5jZS5odWdnaW5nZmFjZS5jby9tb2RlbHMvZGJtZHovYmVydC1sYXJnZS1jYXNlZC1maW5ldHVuZWQtY29ubGwwMy1lbmdsaXNoJyxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3RoaXMuaHVnZ2luZ0ZhY2VLZXl9YCxcclxuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgaW5wdXRzOiB0ZXh0IH0pLFxyXG4gICAgICAgIH1cclxuICAgICAgKVxyXG5cclxuICAgICAgY29uc3QgZW50aXRpZXM6IHN0cmluZ1tdID0gW11cclxuICAgICAgaWYgKHJlc3BvbnNlLm9rKSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpXHJcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkocmVzdWx0KSkge1xyXG4gICAgICAgICAgcmVzdWx0LmZvckVhY2goKGVudGl0eTogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChlbnRpdHkuZW50aXR5X2dyb3VwICYmIGVudGl0eS53b3JkKSB7XHJcbiAgICAgICAgICAgICAgZW50aXRpZXMucHVzaChlbnRpdHkud29yZC5yZXBsYWNlKCcjIycsICcnKSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIENvbWJpbmUgd2l0aCBURi1JREYga2V5d29yZHNcclxuICAgICAgY29uc3QgdGZpZGZLZXl3b3JkcyA9IHRoaXMuZXh0cmFjdFRGSURGS2V5d29yZHModGV4dClcclxuICAgICAgXHJcbiAgICAgIHJldHVybiBbLi4ubmV3IFNldChbLi4uZW50aXRpZXMsIC4uLnRmaWRmS2V5d29yZHNdKV0uc2xpY2UoMCwgMTApXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdBZHZhbmNlZCBrZXl3b3JkIGV4dHJhY3Rpb24gZmFpbGVkOicsIGVycm9yKVxyXG4gICAgICByZXR1cm4gdGhpcy5leHRyYWN0VEZJREZLZXl3b3Jkcyh0ZXh0KVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gR2VuZXJhdGUgYWN0aW9uYWJsZSBpbnNpZ2h0cyB1c2luZyBBSVxyXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVBY3Rpb25hYmxlSW5zaWdodHModGV4dDogc3RyaW5nLCBsYW5ndWFnZTogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xyXG4gICAgY29uc3QgaW5zaWdodHM6IHN0cmluZ1tdID0gW11cclxuICAgIFxyXG4gICAgLy8gUnVsZS1iYXNlZCBpbnNpZ2h0cyBmb3Igbm93IChjYW4gYmUgZW5oYW5jZWQgd2l0aCBHUFQtNCBsYXRlcilcclxuICAgIGNvbnN0IGxvd2VyY2FzZVRleHQgPSB0ZXh0LnRvTG93ZXJDYXNlKClcclxuICAgIFxyXG4gICAgaWYgKGxvd2VyY2FzZVRleHQuaW5jbHVkZXMoJ2RpcnR5JykgfHwgbG93ZXJjYXNlVGV4dC5pbmNsdWRlcygndW5jbGVhbicpKSB7XHJcbiAgICAgIGluc2lnaHRzLnB1c2goJ0ltbWVkaWF0ZSBjbGVhbmluZyBhbmQgaHlnaWVuZSBpbXByb3ZlbWVudCByZXF1aXJlZCcpXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmIChsb3dlcmNhc2VUZXh0LmluY2x1ZGVzKCdleHBlbnNpdmUnKSB8fCBsb3dlcmNhc2VUZXh0LmluY2x1ZGVzKCdvdmVycHJpY2VkJykpIHtcclxuICAgICAgaW5zaWdodHMucHVzaCgnUmV2aWV3IHByaWNpbmcgc3RyYXRlZ3kgYW5kIHByb3ZpZGUgdmFsdWUganVzdGlmaWNhdGlvbicpXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmIChsb3dlcmNhc2VUZXh0LmluY2x1ZGVzKCdydWRlJykgfHwgbG93ZXJjYXNlVGV4dC5pbmNsdWRlcygndW5wcm9mZXNzaW9uYWwnKSkge1xyXG4gICAgICBpbnNpZ2h0cy5wdXNoKCdTdGFmZiB0cmFpbmluZyBhbmQgY3VzdG9tZXIgc2VydmljZSBpbXByb3ZlbWVudCBuZWVkZWQnKVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZiAobG93ZXJjYXNlVGV4dC5pbmNsdWRlcygndW5zYWZlJykgfHwgbG93ZXJjYXNlVGV4dC5pbmNsdWRlcygnZGFuZ2Vyb3VzJykpIHtcclxuICAgICAgaW5zaWdodHMucHVzaCgnVVJHRU5UOiBTYWZldHkgYXNzZXNzbWVudCBhbmQgc2VjdXJpdHkgbWVhc3VyZXMgcmVxdWlyZWQnKVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZiAobG93ZXJjYXNlVGV4dC5pbmNsdWRlcygnYmVhdXRpZnVsJykgfHwgbG93ZXJjYXNlVGV4dC5pbmNsdWRlcygnYW1hemluZycpKSB7XHJcbiAgICAgIGluc2lnaHRzLnB1c2goJ0xldmVyYWdlIHBvc2l0aXZlIGFzcGVjdHMgaW4gbWFya2V0aW5nIGFuZCBwcm9tb3Rpb24nKVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBpbnNpZ2h0c1xyXG4gIH1cclxuXHJcbiAgLy8gQ2FsY3VsYXRlIHVyZ2VuY3kgbGV2ZWxcclxuICBwcml2YXRlIGNhbGN1bGF0ZVVyZ2VuY3koc2VudGltZW50OiBhbnksIHRveGljaXR5OiBudW1iZXIpOiAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnIHwgJ2NyaXRpY2FsJyB7XHJcbiAgICBpZiAodG94aWNpdHkgPiAwLjggfHwgKHNlbnRpbWVudD8uc2VudGltZW50ID09PSAnbmVnYXRpdmUnICYmIHNlbnRpbWVudD8uY29uZmlkZW5jZSA+IDAuOSkpIHtcclxuICAgICAgcmV0dXJuICdjcml0aWNhbCdcclxuICAgIH1cclxuICAgIGlmICh0b3hpY2l0eSA+IDAuNiB8fCAoc2VudGltZW50Py5zZW50aW1lbnQgPT09ICduZWdhdGl2ZScgJiYgc2VudGltZW50Py5jb25maWRlbmNlID4gMC43KSkge1xyXG4gICAgICByZXR1cm4gJ2hpZ2gnXHJcbiAgICB9XHJcbiAgICBpZiAodG94aWNpdHkgPiAwLjMgfHwgKHNlbnRpbWVudD8uc2VudGltZW50ID09PSAnbmVnYXRpdmUnICYmIHNlbnRpbWVudD8uY29uZmlkZW5jZSA+IDAuNSkpIHtcclxuICAgICAgcmV0dXJuICdtZWRpdW0nXHJcbiAgICB9XHJcbiAgICByZXR1cm4gJ2xvdydcclxuICB9XHJcblxyXG4gIC8vIFNwZWVjaCB0byB0ZXh0IGNvbnZlcnNpb25cclxuICBwcml2YXRlIGFzeW5jIHNwZWVjaFRvVGV4dChhdWRpb0Jsb2I6IEJsb2IpOiBQcm9taXNlPHN0cmluZz4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKVxyXG4gICAgICBmb3JtRGF0YS5hcHBlbmQoJ2ZpbGUnLCBhdWRpb0Jsb2IsICdhdWRpby53YXYnKVxyXG5cclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcclxuICAgICAgICAnaHR0cHM6Ly9hcGktaW5mZXJlbmNlLmh1Z2dpbmdmYWNlLmNvL21vZGVscy9vcGVuYWkvd2hpc3Blci1sYXJnZS12MycsXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHt0aGlzLmh1Z2dpbmdGYWNlS2V5fWAsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgICAgICBib2R5OiBmb3JtRGF0YSxcclxuICAgICAgICB9XHJcbiAgICAgIClcclxuXHJcbiAgICAgIGlmIChyZXNwb25zZS5vaykge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKVxyXG4gICAgICAgIHJldHVybiByZXN1bHQudGV4dCB8fCAnJ1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdTcGVlY2ggdG8gdGV4dCBmYWlsZWQ6JywgZXJyb3IpXHJcbiAgICB9XHJcbiAgICByZXR1cm4gJydcclxuICB9XHJcblxyXG4gIC8vIFZvaWNlIGVtb3Rpb24gYW5hbHlzaXNcclxuICBwcml2YXRlIGFzeW5jIGFuYWx5emVWb2ljZUVtb3Rpb25zKGF1ZGlvQmxvYjogQmxvYik6IFByb21pc2U8eyBba2V5OiBzdHJpbmddOiBudW1iZXIgfT4ge1xyXG4gICAgLy8gUGxhY2Vob2xkZXIgZm9yIHZvaWNlIGVtb3Rpb24gYW5hbHlzaXNcclxuICAgIC8vIEluIHByb2R1Y3Rpb24sIHRoaXMgd291bGQgdXNlIHNwZWNpYWxpemVkIGF1ZGlvIGVtb3Rpb24gcmVjb2duaXRpb24gbW9kZWxzXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBjYWxtOiAwLjMsXHJcbiAgICAgIGV4Y2l0ZWQ6IDAuMixcclxuICAgICAgZnJ1c3RyYXRlZDogMC4xLFxyXG4gICAgICBoYXBweTogMC40XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBEZXRlcm1pbmUgc3BlYWtlciB0b25lIGZyb20gdm9pY2UgZW1vdGlvbnNcclxuICBwcml2YXRlIGRldGVybWluZVNwZWFrZXJUb25lKGVtb3Rpb25zOiB7IFtrZXk6IHN0cmluZ106IG51bWJlciB9KTogJ2NhbG0nIHwgJ2V4Y2l0ZWQnIHwgJ2ZydXN0cmF0ZWQnIHwgJ2FuZ3J5JyB8ICdoYXBweScge1xyXG4gICAgY29uc3QgbWF4RW1vdGlvbiA9IE9iamVjdC5lbnRyaWVzKGVtb3Rpb25zKS5yZWR1Y2UoKGEsIGIpID0+IGFbMV0gPiBiWzFdID8gYSA6IGIpXHJcbiAgICByZXR1cm4gbWF4RW1vdGlvblswXSBhcyBhbnkgfHwgJ2NhbG0nXHJcbiAgfVxyXG5cclxuICAvLyBJbWFnZSBkZXNjcmlwdGlvbiBnZW5lcmF0aW9uXHJcbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZUltYWdlRGVzY3JpcHRpb24oYmFzZTY0SW1hZ2U6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxyXG4gICAgICAgICdodHRwczovL2FwaS1pbmZlcmVuY2UuaHVnZ2luZ2ZhY2UuY28vbW9kZWxzL1NhbGVzZm9yY2UvYmxpcC1pbWFnZS1jYXB0aW9uaW5nLWxhcmdlJyxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3RoaXMuaHVnZ2luZ0ZhY2VLZXl9YCxcclxuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgaW5wdXRzOiBiYXNlNjRJbWFnZSB9KSxcclxuICAgICAgICB9XHJcbiAgICAgIClcclxuXHJcbiAgICAgIGlmIChyZXNwb25zZS5vaykge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKVxyXG4gICAgICAgIHJldHVybiByZXN1bHRbMF0/LmdlbmVyYXRlZF90ZXh0IHx8ICdVbmFibGUgdG8gZ2VuZXJhdGUgZGVzY3JpcHRpb24nXHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ltYWdlIGRlc2NyaXB0aW9uIGZhaWxlZDonLCBlcnJvcilcclxuICAgIH1cclxuICAgIHJldHVybiAnSW1hZ2UgYW5hbHlzaXMgdW5hdmFpbGFibGUnXHJcbiAgfVxyXG5cclxuICAvLyBPYmplY3QgZGV0ZWN0aW9uIGluIGltYWdlc1xyXG4gIHByaXZhdGUgYXN5bmMgZGV0ZWN0T2JqZWN0cyhiYXNlNjRJbWFnZTogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcclxuICAgICAgICAnaHR0cHM6Ly9hcGktaW5mZXJlbmNlLmh1Z2dpbmdmYWNlLmNvL21vZGVscy9mYWNlYm9vay9kZXRyLXJlc25ldC01MCcsXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHt0aGlzLmh1Z2dpbmdGYWNlS2V5fWAsXHJcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGlucHV0czogYmFzZTY0SW1hZ2UgfSksXHJcbiAgICAgICAgfVxyXG4gICAgICApXHJcblxyXG4gICAgICBpZiAocmVzcG9uc2Uub2spIHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXNwb25zZS5qc29uKClcclxuICAgICAgICByZXR1cm4gcmVzdWx0Lm1hcCgob2JqOiBhbnkpID0+IG9iai5sYWJlbCkuc2xpY2UoMCwgMTApXHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ09iamVjdCBkZXRlY3Rpb24gZmFpbGVkOicsIGVycm9yKVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIFtdXHJcbiAgfVxyXG5cclxuICAvLyBJbWFnZSBzZW50aW1lbnQgYW5hbHlzaXNcclxuICBwcml2YXRlIGFzeW5jIGFuYWx5emVJbWFnZVNlbnRpbWVudChiYXNlNjRJbWFnZTogc3RyaW5nKTogUHJvbWlzZTwncG9zaXRpdmUnIHwgJ25lZ2F0aXZlJyB8ICduZXV0cmFsJz4ge1xyXG4gICAgLy8gUGxhY2Vob2xkZXIgLSB3b3VsZCB1c2Ugc3BlY2lhbGl6ZWQgaW1hZ2Ugc2VudGltZW50IG1vZGVsc1xyXG4gICAgcmV0dXJuICduZXV0cmFsJ1xyXG4gIH1cclxuXHJcbiAgLy8gQXNzZXNzIGltYWdlIHF1YWxpdHlcclxuICBwcml2YXRlIGFzeW5jIGFzc2Vzc0ltYWdlUXVhbGl0eShiYXNlNjRJbWFnZTogc3RyaW5nKTogUHJvbWlzZTxudW1iZXI+IHtcclxuICAgIC8vIFBsYWNlaG9sZGVyIC0gd291bGQgdXNlIGltYWdlIHF1YWxpdHkgYXNzZXNzbWVudCBtb2RlbHNcclxuICAgIHJldHVybiBNYXRoLnJhbmRvbSgpICogMC4zICsgMC43IC8vIFJhbmRvbSBxdWFsaXR5IGJldHdlZW4gMC43LTEuMFxyXG4gIH1cclxuXHJcbiAgLy8gRGV0ZWN0IGlzc3VlcyBpbiBpbWFnZXNcclxuICBwcml2YXRlIGFzeW5jIGRldGVjdEltYWdlSXNzdWVzKGJhc2U2NEltYWdlOiBzdHJpbmcsIG9iamVjdHM6IHN0cmluZ1tdKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xyXG4gICAgY29uc3QgaXNzdWVzOiBzdHJpbmdbXSA9IFtdXHJcbiAgICBcclxuICAgIC8vIFJ1bGUtYmFzZWQgaXNzdWUgZGV0ZWN0aW9uXHJcbiAgICBpZiAob2JqZWN0cy5pbmNsdWRlcygndHJhc2gnKSB8fCBvYmplY3RzLmluY2x1ZGVzKCdnYXJiYWdlJykpIHtcclxuICAgICAgaXNzdWVzLnB1c2goJ0NsZWFubGluZXNzIGlzc3VlIGRldGVjdGVkJylcclxuICAgIH1cclxuICAgIFxyXG4gICAgaWYgKG9iamVjdHMuaW5jbHVkZXMoJ2RhbWFnZScpIHx8IG9iamVjdHMuaW5jbHVkZXMoJ2Jyb2tlbicpKSB7XHJcbiAgICAgIGlzc3Vlcy5wdXNoKCdJbmZyYXN0cnVjdHVyZSBkYW1hZ2UgZGV0ZWN0ZWQnKVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gaXNzdWVzXHJcbiAgfVxyXG5cclxuICAvLyBFeHRyYWN0IGxvY2F0aW9uIGZyb20gaW1hZ2UgbWV0YWRhdGFcclxuICBwcml2YXRlIGFzeW5jIGV4dHJhY3RMb2NhdGlvbkZyb21JbWFnZShiYXNlNjRJbWFnZTogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmcgfCB1bmRlZmluZWQ+IHtcclxuICAgIC8vIFBsYWNlaG9sZGVyIC0gd291bGQgZXh0cmFjdCBHUFMgZGF0YSBmcm9tIEVYSUYgb3IgdXNlIGltYWdlIHJlY29nbml0aW9uXHJcbiAgICByZXR1cm4gdW5kZWZpbmVkXHJcbiAgfVxyXG5cclxuICAvLyBVdGlsaXR5IGZ1bmN0aW9uc1xyXG4gIHByaXZhdGUgYXN5bmMgYmxvYlRvQmFzZTY0KGJsb2I6IEJsb2IpOiBQcm9taXNlPHN0cmluZz4ge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKVxyXG4gICAgICByZWFkZXIub25sb2FkZW5kID0gKCkgPT4gcmVzb2x2ZShyZWFkZXIucmVzdWx0IGFzIHN0cmluZylcclxuICAgICAgcmVhZGVyLm9uZXJyb3IgPSByZWplY3RcclxuICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoYmxvYilcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIG5vcm1hbGl6ZVNlbnRpbWVudChsYWJlbDogc3RyaW5nKTogJ3Bvc2l0aXZlJyB8ICduZWdhdGl2ZScgfCAnbmV1dHJhbCcge1xyXG4gICAgY29uc3Qgbm9ybWFsaXplZCA9IGxhYmVsLnRvTG93ZXJDYXNlKClcclxuICAgIGlmIChub3JtYWxpemVkLmluY2x1ZGVzKCdwb3NpdGl2ZScpIHx8IG5vcm1hbGl6ZWQuaW5jbHVkZXMoJ3BvcycpKSByZXR1cm4gJ3Bvc2l0aXZlJ1xyXG4gICAgaWYgKG5vcm1hbGl6ZWQuaW5jbHVkZXMoJ25lZ2F0aXZlJykgfHwgbm9ybWFsaXplZC5pbmNsdWRlcygnbmVnJykpIHJldHVybiAnbmVnYXRpdmUnXHJcbiAgICByZXR1cm4gJ25ldXRyYWwnXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGV4dHJhY3RURklERktleXdvcmRzKHRleHQ6IHN0cmluZyk6IHN0cmluZ1tdIHtcclxuICAgIGNvbnN0IHN0b3BXb3JkcyA9IG5ldyBTZXQoW1xyXG4gICAgICAndGhlJywgJ2EnLCAnYW4nLCAnYW5kJywgJ29yJywgJ2J1dCcsICdpbicsICdvbicsICdhdCcsICd0bycsICdmb3InLCAnb2YnLCAnd2l0aCcsICdieScsXHJcbiAgICAgICdpcycsICd3YXMnLCAnYXJlJywgJ3dlcmUnLCAnYmUnLCAnYmVlbicsICdoYXZlJywgJ2hhcycsICdoYWQnLCAnZG8nLCAnZG9lcycsICdkaWQnLFxyXG4gICAgICAnd2lsbCcsICd3b3VsZCcsICdjb3VsZCcsICdzaG91bGQnLCAnbWF5JywgJ21pZ2h0JywgJ211c3QnLCAnY2FuJywgJ3RoaXMnLCAndGhhdCcsXHJcbiAgICAgICd0aGVzZScsICd0aG9zZScsICdpJywgJ3lvdScsICdoZScsICdzaGUnLCAnaXQnLCAnd2UnLCAndGhleScsICdtZScsICdoaW0nLCAnaGVyJywgJ3VzJywgJ3RoZW0nXHJcbiAgICBdKVxyXG4gICAgXHJcbiAgICBjb25zdCB3b3JkcyA9IHRleHQudG9Mb3dlckNhc2UoKVxyXG4gICAgICAucmVwbGFjZSgvW15cXHdcXHNdL2csICcnKVxyXG4gICAgICAuc3BsaXQoL1xccysvKVxyXG4gICAgICAuZmlsdGVyKHdvcmQgPT4gd29yZC5sZW5ndGggPiAyICYmICFzdG9wV29yZHMuaGFzKHdvcmQpKVxyXG4gICAgXHJcbiAgICBjb25zdCB3b3JkQ291bnQ6IHsgW2tleTogc3RyaW5nXTogbnVtYmVyIH0gPSB7fVxyXG4gICAgd29yZHMuZm9yRWFjaCh3b3JkID0+IHtcclxuICAgICAgd29yZENvdW50W3dvcmRdID0gKHdvcmRDb3VudFt3b3JkXSB8fCAwKSArIDFcclxuICAgIH0pXHJcbiAgICBcclxuICAgIHJldHVybiBPYmplY3QuZW50cmllcyh3b3JkQ291bnQpXHJcbiAgICAgIC5zb3J0KChbLGFdLCBbLGJdKSA9PiBiIC0gYSlcclxuICAgICAgLnNsaWNlKDAsIDUpXHJcbiAgICAgIC5tYXAoKFt3b3JkXSkgPT4gd29yZClcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZmFsbGJhY2tBbmFseXNpcyh0ZXh0OiBzdHJpbmcsIGxhbmd1YWdlOiBzdHJpbmcpOiBBSUFuYWx5c2lzUmVzdWx0IHtcclxuICAgIC8vIFNpbXBsZSBydWxlLWJhc2VkIGZhbGxiYWNrXHJcbiAgICBjb25zdCBwb3NpdGl2ZVdvcmRzID0gWydnb29kJywgJ2dyZWF0JywgJ2V4Y2VsbGVudCcsICdhbWF6aW5nJywgJ3dvbmRlcmZ1bCcsICdiZWF1dGlmdWwnLCAnbG92ZScsICdwZXJmZWN0J11cclxuICAgIGNvbnN0IG5lZ2F0aXZlV29yZHMgPSBbJ2JhZCcsICd0ZXJyaWJsZScsICdhd2Z1bCcsICdob3JyaWJsZScsICdoYXRlJywgJ3dvcnN0JywgJ2Rpc2FwcG9pbnRpbmcnLCAncG9vciddXHJcbiAgICBcclxuICAgIGNvbnN0IHdvcmRzID0gdGV4dC50b0xvd2VyQ2FzZSgpLnNwbGl0KC9cXHMrLylcclxuICAgIGNvbnN0IHBvc2l0aXZlQ291bnQgPSB3b3Jkcy5maWx0ZXIod29yZCA9PiBwb3NpdGl2ZVdvcmRzLmluY2x1ZGVzKHdvcmQpKS5sZW5ndGhcclxuICAgIGNvbnN0IG5lZ2F0aXZlQ291bnQgPSB3b3Jkcy5maWx0ZXIod29yZCA9PiBuZWdhdGl2ZVdvcmRzLmluY2x1ZGVzKHdvcmQpKS5sZW5ndGhcclxuICAgIFxyXG4gICAgbGV0IHNlbnRpbWVudDogJ3Bvc2l0aXZlJyB8ICduZWdhdGl2ZScgfCAnbmV1dHJhbCcgPSAnbmV1dHJhbCdcclxuICAgIGxldCBjb25maWRlbmNlID0gMC41XHJcbiAgICBcclxuICAgIGlmIChwb3NpdGl2ZUNvdW50ID4gbmVnYXRpdmVDb3VudCkge1xyXG4gICAgICBzZW50aW1lbnQgPSAncG9zaXRpdmUnXHJcbiAgICAgIGNvbmZpZGVuY2UgPSBNYXRoLm1pbigwLjgsIDAuNSArIChwb3NpdGl2ZUNvdW50IC0gbmVnYXRpdmVDb3VudCkgKiAwLjEpXHJcbiAgICB9IGVsc2UgaWYgKG5lZ2F0aXZlQ291bnQgPiBwb3NpdGl2ZUNvdW50KSB7XHJcbiAgICAgIHNlbnRpbWVudCA9ICduZWdhdGl2ZSdcclxuICAgICAgY29uZmlkZW5jZSA9IE1hdGgubWluKDAuOCwgMC41ICsgKG5lZ2F0aXZlQ291bnQgLSBwb3NpdGl2ZUNvdW50KSAqIDAuMSlcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc2VudGltZW50LFxyXG4gICAgICBjb25maWRlbmNlLFxyXG4gICAgICBlbW90aW9uczoge1xyXG4gICAgICAgIGpveTogc2VudGltZW50ID09PSAncG9zaXRpdmUnID8gY29uZmlkZW5jZSAqIDAuOCA6IDAuMSxcclxuICAgICAgICBhbmdlcjogc2VudGltZW50ID09PSAnbmVnYXRpdmUnID8gY29uZmlkZW5jZSAqIDAuNiA6IDAuMSxcclxuICAgICAgICBzYWRuZXNzOiBzZW50aW1lbnQgPT09ICduZWdhdGl2ZScgPyBjb25maWRlbmNlICogMC40IDogMC4xLFxyXG4gICAgICB9LFxyXG4gICAgICBrZXl3b3JkczogdGhpcy5leHRyYWN0VEZJREZLZXl3b3Jkcyh0ZXh0KSxcclxuICAgICAgbGFuZ3VhZ2U6IGxhbmd1YWdlIHx8ICdlbicsXHJcbiAgICAgIHRveGljaXR5OiAwLFxyXG4gICAgICB1cmdlbmN5OiAnbG93JyxcclxuICAgICAgY2F0ZWdvcmllczogW10sXHJcbiAgICAgIGFjdGlvbmFibGVJbnNpZ2h0czogW11cclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbi8vIFNpbmdsZXRvbiBpbnN0YW5jZVxyXG5leHBvcnQgY29uc3QgYWlTZXJ2aWNlID0gbmV3IEFkdmFuY2VkQUlTZXJ2aWNlKClcclxuIl0sIm5hbWVzIjpbIkFkdmFuY2VkQUlTZXJ2aWNlIiwiY29uc3RydWN0b3IiLCJodWdnaW5nRmFjZUtleSIsInByb2Nlc3MiLCJlbnYiLCJIVUdHSU5HRkFDRV9BUElfS0VZIiwib3BlbkFJS2V5IiwiT1BFTkFJX0FQSV9LRVkiLCJnb29nbGVDbG91ZEtleSIsIkdPT0dMRV9DTE9VRF9BUElfS0VZIiwiZ3JvcUFwaUtleSIsIkdST1FfQVBJX0tFWSIsImlzR3JvcUF2YWlsYWJsZSIsInZhbGlkYXRlR3JvcUtleSIsImNvbnNvbGUiLCJsb2ciLCJ3YXJuIiwibGVuZ3RoIiwiYW5hbHl6ZVRleHQiLCJ0ZXh0IiwibGFuZ3VhZ2UiLCJhbmFseXplV2l0aEdyb3EiLCJlcnJvciIsImZhbGxiYWNrQW5hbHlzaXMiLCJwcm9tcHQiLCJyZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwibW9kZWwiLCJtZXNzYWdlcyIsInJvbGUiLCJjb250ZW50IiwidGVtcGVyYXR1cmUiLCJtYXhfdG9rZW5zIiwib2siLCJFcnJvciIsInN0YXR1cyIsInN0YXR1c1RleHQiLCJkYXRhIiwianNvbiIsImNob2ljZXMiLCJtZXNzYWdlIiwiYW5hbHlzaXMiLCJwYXJzZSIsInNlbnRpbWVudCIsImNvbmZpZGVuY2UiLCJlbW90aW9ucyIsImtleXdvcmRzIiwidG94aWNpdHkiLCJ1cmdlbmN5IiwiY2F0ZWdvcmllcyIsImFjdGlvbmFibGVJbnNpZ2h0cyIsImFuYWx5emVWb2ljZSIsImF1ZGlvQmxvYiIsInRyYW5zY3JpcHRpb24iLCJzcGVlY2hUb1RleHQiLCJ0ZXh0QW5hbHlzaXMiLCJ2b2ljZUVtb3Rpb25zIiwiYW5hbHl6ZVZvaWNlRW1vdGlvbnMiLCJzcGVha2VyVG9uZSIsImRldGVybWluZVNwZWFrZXJUb25lIiwiYW5hbHl6ZUltYWdlIiwiaW1hZ2VCbG9iIiwiYmFzZTY0SW1hZ2UiLCJibG9iVG9CYXNlNjQiLCJkZXNjcmlwdGlvbiIsIm9iamVjdHMiLCJQcm9taXNlIiwiYWxsIiwiZ2VuZXJhdGVJbWFnZURlc2NyaXB0aW9uIiwiZGV0ZWN0T2JqZWN0cyIsImFuYWx5emVJbWFnZVNlbnRpbWVudCIsInF1YWxpdHkiLCJhc3Nlc3NJbWFnZVF1YWxpdHkiLCJpc3N1ZXMiLCJkZXRlY3RJbWFnZUlzc3VlcyIsImxvY2F0aW9uIiwiZXh0cmFjdExvY2F0aW9uRnJvbUltYWdlIiwiZGV0ZWN0TGFuZ3VhZ2UiLCJpbnB1dHMiLCJyZXN1bHQiLCJsYWJlbCIsInJlcGxhY2UiLCJhbmFseXplU2VudGltZW50IiwibW9kZWxzIiwiQXJyYXkiLCJpc0FycmF5IiwidG9wUmVzdWx0Iiwibm9ybWFsaXplU2VudGltZW50Iiwic2NvcmUiLCJhbmFseXplRW1vdGlvbnMiLCJlbW90aW9uU2NvcmVzIiwiZm9yRWFjaCIsImVtb3Rpb24iLCJ0b0xvd2VyQ2FzZSIsImFuYWx5emVUb3hpY2l0eSIsInRveGljUmVzdWx0IiwiZmluZCIsInIiLCJjYXRlZ29yaXplVGV4dCIsInBhcmFtZXRlcnMiLCJjYW5kaWRhdGVfbGFiZWxzIiwibGFiZWxzIiwic2xpY2UiLCJleHRyYWN0QWR2YW5jZWRLZXl3b3JkcyIsImVudGl0aWVzIiwiZW50aXR5IiwiZW50aXR5X2dyb3VwIiwid29yZCIsInB1c2giLCJ0ZmlkZktleXdvcmRzIiwiZXh0cmFjdFRGSURGS2V5d29yZHMiLCJTZXQiLCJnZW5lcmF0ZUFjdGlvbmFibGVJbnNpZ2h0cyIsImluc2lnaHRzIiwibG93ZXJjYXNlVGV4dCIsImluY2x1ZGVzIiwiY2FsY3VsYXRlVXJnZW5jeSIsImZvcm1EYXRhIiwiRm9ybURhdGEiLCJhcHBlbmQiLCJjYWxtIiwiZXhjaXRlZCIsImZydXN0cmF0ZWQiLCJoYXBweSIsIm1heEVtb3Rpb24iLCJPYmplY3QiLCJlbnRyaWVzIiwicmVkdWNlIiwiYSIsImIiLCJnZW5lcmF0ZWRfdGV4dCIsIm1hcCIsIm9iaiIsIk1hdGgiLCJyYW5kb20iLCJ1bmRlZmluZWQiLCJibG9iIiwicmVzb2x2ZSIsInJlamVjdCIsInJlYWRlciIsIkZpbGVSZWFkZXIiLCJvbmxvYWRlbmQiLCJvbmVycm9yIiwicmVhZEFzRGF0YVVSTCIsIm5vcm1hbGl6ZWQiLCJzdG9wV29yZHMiLCJ3b3JkcyIsInNwbGl0IiwiZmlsdGVyIiwiaGFzIiwid29yZENvdW50Iiwic29ydCIsInBvc2l0aXZlV29yZHMiLCJuZWdhdGl2ZVdvcmRzIiwicG9zaXRpdmVDb3VudCIsIm5lZ2F0aXZlQ291bnQiLCJtaW4iLCJqb3kiLCJhbmdlciIsInNhZG5lc3MiLCJhaVNlcnZpY2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/ai-services.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ffeedback%2Froute&page=%2Fapi%2Ffeedback%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ffeedback%2Froute.ts&appDir=C%3A%5CUsers%5Cpriya%5COneDrive%5CDesktop%5CTourism-Jharkhand%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cpriya%5COneDrive%5CDesktop%5CTourism-Jharkhand&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();